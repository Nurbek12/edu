import{r,u as k,a as n,o as D,c as T,w as t,h as m,b as e,f as U,d as A}from"./index-439559a6.js";const B=A("div",{class:"d-flex justify-center"},"DAVOMAT",-1),P={__name:"Attendance",setup(C){const _=[l=>!!l||"Required"],u=r([]),f=r([]),y=k(),b=r([]),a=r({group:null,subject:null}),w=[{title:"Talaba ism-familiyasi",align:"start",sortable:!1,key:"name"}],v=r([]),V=async()=>{const l=await Promise.all([m.get("/group/access"),m.get("/subject/access")]);f.value=l[0].data,b.value=l[1].data},g=async()=>{if(!a.value.group||!a.value.subject)return;const{data:l}=await m.get(`/attendence/id/${a.value.group}?subject=${a.value.subject}`);v.value=l},j=async()=>{if(u.value.length===0||!a.value.subject)return;const l=new Date,c=[l.getFullYear().toString().substring(0),(l.getMonth()+1).toString().padStart(2,"0"),l.getDate().toString().padStart(2,"0")].join("-"),s=u.value.map(d=>(Object.assign(v.value.find(p=>p._id===d),{att:!1}),{...a.value,student:d,date:c,time:new Date().toLocaleTimeString(),teacher:y.getters.userid}));u.value=[],await m.post("/attendence",s)};return V(),(l,o)=>{const c=n("v-sheet"),s=n("v-col"),d=n("v-select"),p=n("v-btn"),h=n("v-row"),x=n("v-data-table"),S=n("v-container");return D(),T(S,{fluid:""},{default:t(()=>[e(h,null,{default:t(()=>[e(s,{cols:"12"},{default:t(()=>[e(c,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[B]),_:1})]),_:1}),e(s,{cols:"12",md:"4"},{default:t(()=>[e(c,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[e(h,null,{default:t(()=>[e(s,{cols:"12"},{default:t(()=>[e(d,{modelValue:a.value.subject,"onUpdate:modelValue":[o[0]||(o[0]=i=>a.value.subject=i),g],label:"Fan",density:"comfortable",rules:_,"hide-details":"",items:b.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(s,{cols:"12",class:"py-0"},{default:t(()=>[e(d,{modelValue:a.value.group,"onUpdate:modelValue":[o[1]||(o[1]=i=>a.value.group=i),g],label:"Guruh",rules:_,disabled:!a.value.subject,"hide-details":"",density:"comfortable",items:f.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","disabled","items"])]),_:1}),e(s,{cols:"12"},{default:t(()=>[e(p,{color:"primary",onClick:j,block:"",elevation:"0",disabled:u.value.length===0,height:"40px"},{default:t(()=>[U(" Kiritish ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{cols:"12",md:"8"},{default:t(()=>[e(c,{elevation:"1",color:"surface",width:"100%",class:"py-2 px-0",rounded:""},{default:t(()=>[e(x,{modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=i=>u.value=i),headers:w,items:v.value,"items-per-page-text":"","item-value":"_id","items-per-page":"-1","item-selectable":"att","no-data-text":"Hech narsa topilmadi","show-select":"",density:"compact"},{bottom:t(()=>[]),_:1},8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{P as default};
