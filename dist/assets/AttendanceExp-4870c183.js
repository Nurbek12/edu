import{a as f}from"./index-7376b9a9.js";import{r as u,m as R,a as s,o as J,c as L,w as t,b as e,f as V,d as i,t as _,n as M}from"./index-e60ab6e1.js";const W={class:"responsive-datatable"},X={"data-label":"Talaba"},Y={"data-label":"Guruh"},Z={"data-label":"Boshlanish sanasi"},ee={"data-label":"Tugash sanasi"},te={"data-label":"Izoh"},ae={"data-label":"Fayl"},le={class:"d-flex justify-end align-center gap-4"},oe=["href"],se=i("span",{class:"text-h5"},"Fayl Kiritish",-1),ue={__name:"AttendanceExp",setup(ne){const C=[{title:"Talaba",sortable:!1,key:"student"},{title:"Guruh",sortable:!1,key:"group"},{title:"Boshlanish sanasi",sortable:!1,key:"start_date"},{title:"Tugash sanasi",sortable:!1,key:"end_date"},{title:"Izoh",sortable:!1,key:"description"},{title:"Fayl",sortable:!1,key:"file"}],r=[o=>!!o||"Required"],h=u(""),y=u(null),p=u(null),w=u([]),x=u([]),k=u([]),m=u(!1),n=u({student:null,group:null,start_date:"",end_date:"",description:""}),I={student:null,group:null,start_date:"",end_date:"",description:""};R(m,o=>o||T());const j=async()=>{const o=await Promise.all([f.get("/attendence/exp"),await f.get("/group")]);k.value=o[0].data,w.value=o[1].data},G=async()=>{const{valid:o}=await y.value.validate();o&&N()},T=()=>{m.value=!1,M(()=>{var o;n.value=Object.assign({},I),(o=y.value)==null||o.reset()})},N=async()=>{const o=new FormData;console.log(p.value),Object.keys(n.value).map(c=>{o.append(c,n.value[c])}),o.append("file",p.value[0]);const{data:l}=await f.post("/attendence/exp",o,{headers:{"Content-Type":"multipart/form-data"}});console.log(l),T()},$=async()=>{if(!n.value.group)return;const{data:o}=await f.get(`/user/student?group=${n.value.group}&status=aktiv`);x.value=o};return j(),(o,l)=>{const c=s("v-text-field"),d=s("v-col"),b=s("v-btn"),g=s("v-row"),U=s("v-sheet"),q=s("v-spacer"),D=s("v-icon"),O=s("v-data-table"),S=s("v-card-title"),z=s("v-select"),A=s("v-textarea"),E=s("v-file-input"),H=s("v-form"),B=s("v-container"),K=s("v-card-text"),P=s("v-card"),Q=s("v-dialog");return J(),L(B,{fluid:""},{default:t(()=>[e(g,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(U,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:t(()=>[e(g,{justify:"space-between",align:"center"},{default:t(()=>[e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(c,{label:"Qidirish",modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=a=>h.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(b,{block:"",color:"primary",onClick:l[1]||(l[1]=a=>m.value=!0),variant:"flat",height:"42"},{default:t(()=>[V("Fayl yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(U,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[i("div",W,[e(O,{"items-per-page-text":"",headers:C,density:"comfortable",search:h.value,items:k.value,"no-data-text":"Hech narsa topilmadi"},{"item.student":t(({index:a,item:v})=>{var F;return[i("td",X,_(a+1)+". "+_((F=v.raw.student)==null?void 0:F.name),1)]}),"item.group":t(({item:a})=>{var v;return[i("td",Y,_((v=a.raw.group)==null?void 0:v.name),1)]}),"item.start_date":t(({item:a})=>[i("td",Z,_(a.raw.start_date),1)]),"item.end_date":t(({item:a})=>[i("td",ee,_(a.raw.end_date),1)]),"item.description":t(({item:a})=>[i("td",te,_(a.raw.description),1)]),"item.file":t(({item:a})=>[i("td",ae,[e(q),i("div",le,[i("a",{href:`/files/${a.raw.file}`,target:"_blank",download:""},[e(b,{size:"30",elevation:"0",color:"primary"},{default:t(()=>[e(D,{size:"small"},{default:t(()=>[V("mdi-tray-arrow-down")]),_:1})]),_:1})],8,oe)])])]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e(Q,{modelValue:m.value,"onUpdate:modelValue":l[8]||(l[8]=a=>m.value=a),"max-width":"550px"},{default:t(()=>[e(P,null,{default:t(()=>[e(S,{class:"mt-2 ml-2 mb-0"},{default:t(()=>[se]),_:1}),e(K,{class:"px-2 pt-0"},{default:t(()=>[e(B,null,{default:t(()=>[e(H,{ref_key:"form",ref:y},{default:t(()=>[e(g,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(z,{modelValue:n.value.group,"onUpdate:modelValue":[l[2]||(l[2]=a=>n.value.group=a),$],label:"Guruh","hide-details":"",rules:r,items:w.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(z,{modelValue:n.value.student,"onUpdate:modelValue":l[3]||(l[3]=a=>n.value.student=a),label:"Talaba","hide-details":"",items:x.value,color:"primary",rules:r,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:t(()=>[e(c,{modelValue:n.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=a=>n.value.start_date=a),label:"Boshlanish sanasi","hide-details":"",type:"date",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:t(()=>[e(c,{modelValue:n.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=a=>n.value.end_date=a),label:"Tugash sanasi","hide-details":"",type:"date",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(A,{modelValue:n.value.description,"onUpdate:modelValue":l[6]||(l[6]=a=>n.value.description=a),label:"Izoh","no-resize":"","hide-details":"",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(E,{modelValue:p.value,"onUpdate:modelValue":l[7]||(l[7]=a=>p.value=a),"prepend-icon":null,label:"Fayl",rules:r,"hide-details":"","show-size":"",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(b,{variant:"flat",color:"primary",block:"",onClick:G,height:"45"},{default:t(()=>[V(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ue as default};
