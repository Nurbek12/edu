import{a as f}from"./index-7376b9a9.js";import{s as L}from"./semesters-2992cfa7.js";import{r,n as Q,a as s,o as J,c as M,w as t,b as e,e as W,f as w,d as i,t as m,p as X}from"./index-856562a7.js";const Z={class:"responsive-datatable"},ee={"data-label":"Talaba"},te={"data-label":"Guruh"},ae={"data-label":"Boshlanish sanasi"},le={"data-label":"Tugash sanasi"},oe={"data-label":"Izoh"},se={"data-label":"Fayl"},ne={class:"d-flex justify-end align-center gap-4"},de=["href"],ie=i("span",{class:"text-h5"},"Fayl Kiritish",-1),_e={__name:"AttendanceExp",setup(re){const C=[{title:"Talaba",sortable:!1,key:"student"},{title:"Guruh",sortable:!1,key:"group"},{title:"Boshlanish sanasi",sortable:!1,key:"start_date"},{title:"Tugash sanasi",sortable:!1,key:"end_date"},{title:"Izoh",sortable:!1,key:"description"},{title:"Fayl",sortable:!1,key:"file"}],u=[o=>!!o||"Required"],y=r(""),h=r(null),p=r(null),x=r([]),k=r([]),U=r([]),_=r(!1),n=r({student:null,group:null,start_date:"",end_date:"",description:""}),I={student:null,group:null,start_date:"",end_date:"",description:""};Q(_,o=>o||z());const T=async o=>{const l=await Promise.all([f.get(`/attendence/exp?${o||""}`),await f.get("/group")]);U.value=l[0].data,!o&&(x.value=l[1].data)},S=async()=>{const{valid:o}=await h.value.validate();o&&$()},z=()=>{_.value=!1,X(()=>{var o;n.value=Object.assign({},I),(o=h.value)==null||o.reset()})},$=async()=>{const o=new FormData;console.log(p.value),Object.keys(n.value).map(c=>{o.append(c,n.value[c])}),o.append("file",p.value[0]);const{data:l}=await f.post("/attendence/exp",o,{headers:{"Content-Type":"multipart/form-data"}});console.log(l),z()},D=async()=>{if(!n.value.group)return;const{data:o}=await f.get(`/user/student?group=${n.value.group}&status=aktiv`);k.value=o},G=o=>{delete o.title,T(new URLSearchParams(o).toString())};return T(),(o,l)=>{const c=s("v-text-field"),d=s("v-col"),b=s("v-select"),g=s("v-btn"),V=s("v-row"),B=s("v-sheet"),N=s("v-spacer"),q=s("v-icon"),A=s("v-data-table"),O=s("v-card-title"),P=s("v-textarea"),R=s("v-file-input"),Y=s("v-form"),F=s("v-container"),E=s("v-card-text"),H=s("v-card"),K=s("v-dialog");return J(),M(F,{fluid:""},{default:t(()=>[e(V,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:t(()=>[e(V,{justify:"space-between",align:"center"},{default:t(()=>[e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(c,{label:"Qidirish",modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=a=>y.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(b,{label:"Semestr","onUpdate:modelValue":G,"hide-details":"",items:W(L),density:"compact",color:"primary","item-title":"title","return-object":"",variant:"outlined"},null,8,["items"])]),_:1}),e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(g,{block:"",color:"primary",onClick:l[1]||(l[1]=a=>_.value=!0),variant:"flat",height:"42"},{default:t(()=>[w("Fayl yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[i("div",Z,[e(A,{"items-per-page-text":"",headers:C,density:"comfortable",search:y.value,items:U.value,"no-data-text":"Hech narsa topilmadi"},{"item.student":t(({index:a,item:v})=>{var j;return[i("td",ee,m(a+1)+". "+m((j=v.raw.student)==null?void 0:j.name),1)]}),"item.group":t(({item:a})=>{var v;return[i("td",te,m((v=a.raw.group)==null?void 0:v.name),1)]}),"item.start_date":t(({item:a})=>[i("td",ae,m(a.raw.start_date),1)]),"item.end_date":t(({item:a})=>[i("td",le,m(a.raw.end_date),1)]),"item.description":t(({item:a})=>[i("td",oe,m(a.raw.description),1)]),"item.file":t(({item:a})=>[i("td",se,[e(N),i("div",ne,[i("a",{href:`/files/${a.raw.file}`,target:"_blank",download:""},[e(g,{size:"30",elevation:"0",color:"primary"},{default:t(()=>[e(q,{size:"small"},{default:t(()=>[w("mdi-tray-arrow-down")]),_:1})]),_:1})],8,de)])])]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e(K,{modelValue:_.value,"onUpdate:modelValue":l[8]||(l[8]=a=>_.value=a),"max-width":"550px"},{default:t(()=>[e(H,null,{default:t(()=>[e(O,{class:"mt-2 ml-2 mb-0"},{default:t(()=>[ie]),_:1}),e(E,{class:"px-2 pt-0"},{default:t(()=>[e(F,null,{default:t(()=>[e(Y,{ref_key:"form",ref:h},{default:t(()=>[e(V,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(b,{modelValue:n.value.group,"onUpdate:modelValue":[l[2]||(l[2]=a=>n.value.group=a),D],label:"Guruh","hide-details":"",rules:u,items:x.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(b,{modelValue:n.value.student,"onUpdate:modelValue":l[3]||(l[3]=a=>n.value.student=a),label:"Talaba","hide-details":"",items:k.value,color:"primary",rules:u,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:t(()=>[e(c,{modelValue:n.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=a=>n.value.start_date=a),label:"Boshlanish sanasi","hide-details":"",type:"date",rules:u,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:t(()=>[e(c,{modelValue:n.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=a=>n.value.end_date=a),label:"Tugash sanasi","hide-details":"",type:"date",rules:u,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(P,{modelValue:n.value.description,"onUpdate:modelValue":l[6]||(l[6]=a=>n.value.description=a),label:"Izoh","no-resize":"","hide-details":"",rules:u,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(R,{modelValue:p.value,"onUpdate:modelValue":l[7]||(l[7]=a=>p.value=a),"prepend-icon":null,label:"Fayl",rules:u,"hide-details":"","show-size":"",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(g,{variant:"flat",color:"primary",block:"",onClick:S,height:"45"},{default:t(()=>[w(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{_e as default};
