import{u as Q,r,m as J,a as s,o as M,c as W,w as t,h as v,b as e,e as X,f as x,d as i,t as c,n as Z}from"./index-eee0caed.js";import{s as ee}from"./semesters-2992cfa7.js";const te={class:"responsive-datatable"},ae={"data-label":"Talaba"},le={"data-label":"Guruh"},oe={"data-label":"Hodim"},se={"data-label":"Boshlanish sanasi"},ne={"data-label":"Tugash sanasi"},de={"data-label":"Izoh"},ie={"data-label":"Fayl"},re={class:"d-flex justify-end align-center gap-4"},ue=["href"],ce=i("span",{class:"text-h5"},"Fayl Kiritish",-1),ve={__name:"AttendanceExp",setup(me){const j=[{title:"Talaba",sortable:!1,key:"student"},{title:"Guruh",sortable:!1,key:"group"},{title:"Hodim",sortable:!1,key:"inspector"},{title:"Boshlanish sanasi",sortable:!1,key:"start_date"},{title:"Tugash sanasi",sortable:!1,key:"end_date"},{title:"Izoh",sortable:!1,key:"description"},{title:"Fayl",sortable:!1,key:"file"}],C=Q(),m=[o=>!!o||"Required"],f=r(""),h=r(null),y=r(null),k=r([]),U=r([]),b=r([]),p=r(!1),n=r({student:null,group:null,start_date:"",end_date:"",description:""}),I={student:null,group:null,start_date:"",end_date:"",description:""};J(p,o=>o||z());const T=async o=>{const l=await Promise.all([v.get(`/attendence/exp?${o||""}`),await v.get("/group")]);b.value=l[0].data,!o&&(k.value=l[1].data)},$=async()=>{const{valid:o}=await h.value.validate();o&&D()},z=()=>{p.value=!1,Z(()=>{var o;n.value=Object.assign({},I),(o=h.value)==null||o.reset()})},D=async()=>{const o=new FormData;Object.keys(n.value).map(_=>{o.append(_,n.value[_])}),o.append("inspector",C.getters.userid),o.append("file",y.value[0]);const{data:l}=await v.post("/attendence/exp",o,{headers:{"Content-Type":"multipart/form-data"}});b.value.push(l),z()},G=async()=>{if(!n.value.group)return;const{data:o}=await v.get(`/user/student?group=${n.value.group}&status=aktiv`);U.value=o},H=o=>{delete o.title,T(new URLSearchParams(o).toString())};return T(),(o,l)=>{const _=s("v-text-field"),d=s("v-col"),g=s("v-select"),V=s("v-btn"),w=s("v-row"),B=s("v-sheet"),N=s("v-spacer"),q=s("v-icon"),A=s("v-data-table"),O=s("v-card-title"),P=s("v-textarea"),R=s("v-file-input"),Y=s("v-form"),F=s("v-container"),E=s("v-card-text"),K=s("v-card"),L=s("v-dialog");return M(),W(F,{fluid:""},{default:t(()=>[e(w,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:t(()=>[e(w,{justify:"space-between",align:"center"},{default:t(()=>[e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(_,{label:"Qidirish",modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=a=>f.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(g,{label:"Semestr","onUpdate:modelValue":H,"hide-details":"",items:X(ee),density:"compact",color:"primary","item-title":"title","return-object":"",variant:"outlined"},null,8,["items"])]),_:1}),e(d,{cols:"12",class:"py-1",sm:"4"},{default:t(()=>[e(V,{block:"",color:"primary",onClick:l[1]||(l[1]=a=>p.value=!0),variant:"flat",height:"42"},{default:t(()=>[x("Fayl yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[i("div",te,[e(A,{"items-per-page-text":"",headers:j,density:"comfortable",search:f.value,items:b.value,"no-data-text":"Hech narsa topilmadi"},{"item.student":t(({index:a,item:u})=>{var S;return[i("td",ae,c(a+1)+". "+c((S=u.raw.student)==null?void 0:S.name),1)]}),"item.group":t(({item:a})=>{var u;return[i("td",le,c((u=a.raw.group)==null?void 0:u.name),1)]}),"item.inspector":t(({item:a})=>{var u;return[i("td",oe,c((u=a.raw.inspector)==null?void 0:u.name),1)]}),"item.start_date":t(({item:a})=>[i("td",se,c(a.raw.start_date),1)]),"item.end_date":t(({item:a})=>[i("td",ne,c(a.raw.end_date),1)]),"item.description":t(({item:a})=>[i("td",de,c(a.raw.description),1)]),"item.file":t(({item:a})=>[i("td",ie,[e(N),i("div",re,[i("a",{href:`/files/${a.raw.file}`,target:"_blank",download:""},[e(V,{size:"30",elevation:"0",color:"primary"},{default:t(()=>[e(q,{size:"small"},{default:t(()=>[x("mdi-tray-arrow-down")]),_:1})]),_:1})],8,ue)])])]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e(L,{modelValue:p.value,"onUpdate:modelValue":l[8]||(l[8]=a=>p.value=a),"max-width":"550px"},{default:t(()=>[e(K,null,{default:t(()=>[e(O,{class:"mt-2 ml-2 mb-0"},{default:t(()=>[ce]),_:1}),e(E,{class:"px-2 pt-0"},{default:t(()=>[e(F,null,{default:t(()=>[e(Y,{ref_key:"form",ref:h},{default:t(()=>[e(w,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(g,{modelValue:n.value.group,"onUpdate:modelValue":[l[2]||(l[2]=a=>n.value.group=a),G],label:"Guruh","hide-details":"",rules:m,items:k.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(g,{modelValue:n.value.student,"onUpdate:modelValue":l[3]||(l[3]=a=>n.value.student=a),label:"Talaba","hide-details":"",items:U.value,color:"primary",rules:m,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:t(()=>[e(_,{modelValue:n.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=a=>n.value.start_date=a),label:"Boshlanish sanasi","hide-details":"",type:"date",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:t(()=>[e(_,{modelValue:n.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=a=>n.value.end_date=a),label:"Tugash sanasi","hide-details":"",type:"date",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(P,{modelValue:n.value.description,"onUpdate:modelValue":l[6]||(l[6]=a=>n.value.description=a),label:"Izoh","no-resize":"","hide-details":"",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(R,{modelValue:y.value,"onUpdate:modelValue":l[7]||(l[7]=a=>y.value=a),"prepend-icon":null,label:"Fayl",rules:m,"hide-details":"","show-size":"",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(V,{variant:"flat",color:"primary",block:"",onClick:$,height:"45"},{default:t(()=>[x(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ve as default};
