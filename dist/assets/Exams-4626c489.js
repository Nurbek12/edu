import{r as d,l as J,m as K,a as n,o as L,c as W,w as e,h as f,b as t,f as x,d as i,t as v,e as X,n as Z}from"./index-439559a6.js";const ee={class:"responsive-datatable"},te={"data-label":"T/r"},ae={"data-label":"Test baza"},le={"data-label":"Fan"},oe={"data-label":"Sanasi"},se={"data-label":"Berilgan vaqt"},ne={"data-label":"Guruh"},ie={"data-label":"Savollar soni"},de={"data-label":"Boshqarish"},ue={class:"d-flex justify-end align-center"},re=i("div",null,"Hech narsa topilmadi",-1),ce={class:"text-h5"},_e={__name:"Exams",setup(me){const O=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test baza",key:"name"},{title:"Fan",key:"subject",sortable:!1},{title:"Guruhlar",key:"group",sortable:!1},{title:"Sanasi",key:"date",sortable:!1},{title:"Muhlati",key:"time",sortable:!1},{title:"Savollar soni",key:"count",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],b=[l=>!!l||"Required"],w=d(null);d(null);const k=d(""),c=d([]),_=d(!1),m=d(-1),h=d(-1),q=d([]),U=d([]),S=d([]),s=d({groups:[],test:null,count:0,time:0,date:""}),B={test:null,groups:[],count:0,time:0,date:""},$=J(()=>m.value===-1?"Imtihon Yaratish":"Imtihonni O'zgartirish");K(_,l=>l||g());const G=async()=>{const[l,o,p]=await Promise.all([f.get("/group"),f.get("/test"),f.get("/exam")]);c.value=p.data,U.value=o.data,q.value=l.data},N=async()=>{const{valid:l}=await w.value.validate();l&&H()},F=l=>{m.value=c.value.indexOf(l),h.value=l._id,s.value=Object.assign({},l),_.value=!0},D=l=>{m.value=c.value.indexOf(l),s.value=Object.assign({},l),h.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?E():g()},E=async()=>{const{data:l}=await f.delete(`/exam/${h.value}`);l&&(c.value.splice(m.value,1),g())},g=()=>{_.value=!1,Z(()=>{var l;s.value=Object.assign({},B),h.value=-1,m.value=-1,(l=w.value)==null||l.reset()})},H=async()=>{if(m.value>-1){const{data:l}=await f.put(`/exam/${h.value}`,s.value);Object.assign(c.value[m.value],l)}else{const{data:l}=await f.post("/exam",{questions:S.value,...s.value});console.log(l),c.value.push(l)}g()};return G(),(l,o)=>{const p=n("v-text-field"),u=n("v-col"),V=n("v-btn"),I=n("v-row"),j=n("v-sheet"),T=n("v-select"),C=n("v-icon"),M=n("v-data-table"),P=n("v-card-title"),Q=n("v-form"),z=n("v-container"),R=n("v-card-text"),Y=n("v-card"),A=n("v-dialog");return L(),W(z,{fluid:""},{default:e(()=>[t(I,null,{default:e(()=>[t(u,{cols:"12"},{default:e(()=>[t(j,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[t(I,{justify:"space-between",align:"center"},{default:e(()=>[t(u,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[t(p,{label:"Qidirish",modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=a=>k.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(u,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[t(V,{block:"",height:"42",color:"primary",onClick:o[1]||(o[1]=a=>_.value=!0),variant:"flat"},{default:e(()=>[x("Imtihon yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(u,{cols:"12"},{default:e(()=>[t(j,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[i("div",ee,[t(M,{"items-per-page-text":"",headers:O,search:k.value,items:c.value},{"item.no":e(({index:a})=>[i("td",te,v(a+1)+".",1)]),"item.name":e(({item:a})=>{var r,y;return[i("td",ae,v((y=(r=a.raw)==null?void 0:r.test)==null?void 0:y.name),1)]}),"item.subject":e(({item:a})=>{var r,y;return[i("td",le,v((y=(r=a.raw)==null?void 0:r.test)==null?void 0:y.subject),1)]}),"item.date":e(({item:a})=>[i("td",oe,v(a.raw.date),1)]),"item.time":e(({item:a})=>[i("td",se,v(a.raw.time),1)]),"item.group":e(({item:a})=>[i("td",ne,[t(T,{items:q.value,readonly:"",chips:"",multiple:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:a.raw.groups,"onUpdate:modelValue":r=>a.raw.groups=r},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.count":e(({item:a})=>[i("td",ie,v(a.raw.count),1)]),"item.actions":e(({item:a})=>[i("td",de,[i("div",ue,[t(V,{variant:"flat",size:"30",color:"primary",onClick:r=>F(a.raw)},{default:e(()=>[t(C,null,{default:e(()=>[x("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(V,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:r=>D(a.raw)},{default:e(()=>[t(C,null,{default:e(()=>[x("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"no-data":e(()=>[re]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t(A,{modelValue:_.value,"onUpdate:modelValue":o[7]||(o[7]=a=>_.value=a),"max-width":"550px"},{default:e(()=>[t(Y,{class:"test-scroll"},{default:e(()=>[t(P,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[i("span",ce,v(X($)),1)]),_:1}),t(R,{class:"px-2 pt-0"},{default:e(()=>[t(z,null,{default:e(()=>[t(Q,{ref_key:"form",ref:w},{default:e(()=>[t(I,null,{default:e(()=>[t(u,{cols:"12",sm:"6"},{default:e(()=>[t(T,{modelValue:s.value.test,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.test=a),label:"Test bazasi",rules:b,"hide-details":"",items:U.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:e(()=>[t(p,{modelValue:s.value.date,"onUpdate:modelValue":o[3]||(o[3]=a=>s.value.date=a),label:"Test vaqti",type:"date","hide-details":"",rules:b,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:e(()=>[t(p,{modelValue:s.value.time,"onUpdate:modelValue":o[4]||(o[4]=a=>s.value.time=a),label:"Testga beriladigan vaqt (minut)","hide-details":"",rules:b,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:e(()=>[t(p,{modelValue:s.value.count,"onUpdate:modelValue":o[5]||(o[5]=a=>s.value.count=a),label:"Savollar soni","hide-details":"",rules:b,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12"},{default:e(()=>[t(T,{modelValue:s.value.groups,"onUpdate:modelValue":o[6]||(o[6]=a=>s.value.groups=a),label:"Guruhlar","hide-details":"",multiple:"",items:q.value,chips:"",color:"primary",rules:b,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12"},{default:e(()=>[t(V,{variant:"flat",color:"primary",block:"",onClick:N,height:"45"},{default:e(()=>[x(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{_e as default};
