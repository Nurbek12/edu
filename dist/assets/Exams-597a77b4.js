import{a as h}from"./index-7376b9a9.js";import{r as i,l as Z,m as N,a as n,o as ee,c as ae,w as a,b as e,f as x,d as u,t as v,e as te,p as F}from"./index-6f11c559.js";const le={"data-label":"T/r"},oe={"data-label":"Test baza"},se={"data-label":"Fan"},ne={"data-label":"Sanasi"},ie={"data-label":"Berilgan vaqt"},ue={"data-label":"Guruh"},de={"data-label":"Savollar soni"},re={"data-label":"Boshqarish"},ce={class:"d-flex justify-end"},me=u("div",null,"Hech narsa topilmadi",-1),ve={class:"text-h5"},be={__name:"Exams",setup(_e){const H=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test baza",key:"name"},{title:"Fan",key:"science",sortable:!1},{title:"Guruhlar",key:"group",sortable:!1},{title:"Sanasi",key:"date",sortable:!1},{title:"Muhlati",key:"time",sortable:!1},{title:"Savollar soni",key:"count",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],y=[l=>!!l||"Required"],k=i(null);i(null);const w=i(""),m=i([]),_=i(!1),g=i(!1),c=i(-1),p=i(-1),q=i([]),U=i([]),E=i([]),s=i({groups:[],test:null,count:0,time:0,date:""}),z={test:null,groups:[],count:0,time:0,date:""},M=Z(()=>c.value===-1?"Imtihon Yaratish":"Imtihonni O'zgartirish");N(_,l=>l||B()),N(g,l=>l||C());const P=async()=>{const[l,o,f]=await Promise.all([h.get("/group"),h.get("/test"),h.get("/exam")]);m.value=f.data,U.value=o.data,q.value=l.data},Q=async()=>{const{valid:l}=await k.value.validate();l&&J()},R=l=>{c.value=m.value.indexOf(l),p.value=l._id,s.value=Object.assign({},l),_.value=!0},Y=l=>{c.value=m.value.indexOf(l),s.value=Object.assign({},l),p.value=l._id,g.value=!0},A=async()=>{const{data:l}=await h.delete(`/exam/${p.value}`);l&&(m.value.splice(c.value,1),C())},B=()=>{_.value=!1,F(()=>{var l;s.value=Object.assign({},z),p.value=-1,c.value=-1,(l=k.value)==null||l.reset()})},C=()=>{g.value=!1,F(()=>{var l;s.value=Object.assign({},z),p.value=-1,c.value=-1,(l=k.value)==null||l.reset()})},J=async()=>{if(c.value>-1){const{data:l}=await h.put(`/exam/${p.value}`,s.value);Object.assign(m.value[c.value],l)}else{const{data:l}=await h.post("/exam",{questions:E.value,...s.value});console.log(l),m.value.push(l)}B()};return P(),(l,o)=>{const f=n("v-text-field"),d=n("v-col"),b=n("v-btn"),I=n("v-row"),O=n("v-sheet"),T=n("v-select"),K=n("v-data-table"),j=n("v-card-title"),L=n("v-form"),S=n("v-container"),W=n("v-card-text"),$=n("v-card"),D=n("v-dialog"),G=n("v-spacer"),X=n("v-card-actions");return ee(),ae(S,{fluid:""},{default:a(()=>[e(I,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(O,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[e(I,{justify:"space-between"},{default:a(()=>[e(d,{cols:"12",sm:"4"},{default:a(()=>[e(f,{label:"Qidirish",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=t=>w.value=t),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"4",md:"3"},{default:a(()=>[e(b,{block:"",color:"primary",onClick:o[1]||(o[1]=t=>_.value=!0),variant:"tonal"},{default:a(()=>[x("Imtihon yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(O,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[e(K,{headers:H,search:w.value,items:m.value},{"item.no":a(({index:t})=>[u("td",le,v(t+1)+".",1)]),"item.name":a(({item:t})=>{var r,V;return[u("td",oe,v((V=(r=t.raw)==null?void 0:r.test)==null?void 0:V.name),1)]}),"item.science":a(({item:t})=>{var r,V;return[u("td",se,v((V=(r=t.raw)==null?void 0:r.test)==null?void 0:V.science),1)]}),"item.date":a(({item:t})=>[u("td",ne,v(t.raw.date),1)]),"item.time":a(({item:t})=>[u("td",ie,v(t.raw.time),1)]),"item.group":a(({item:t})=>[u("td",ue,[e(T,{items:q.value,readonly:"",chips:"",multiple:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:t.raw.groups,"onUpdate:modelValue":r=>t.raw.groups=r},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.count":a(({item:t})=>[u("td",de,v(t.raw.count),1)]),"item.actions":a(({item:t})=>[u("td",re,[u("div",ce,[e(b,{icon:"mdi-pencil",variant:"text",size:"40",color:"primary",onClick:r=>R(t.raw)},null,8,["onClick"]),e(b,{icon:"mdi-delete",variant:"text",size:"40",color:"primary",onClick:r=>Y(t.raw)},null,8,["onClick"])])])]),"no-data":a(()=>[me]),_:1},8,["search","items"])]),_:1})]),_:1})]),_:1}),e(D,{modelValue:_.value,"onUpdate:modelValue":o[7]||(o[7]=t=>_.value=t),"max-width":"550px"},{default:a(()=>[e($,{class:"test-scroll"},{default:a(()=>[e(j,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[u("span",ve,v(te(M)),1)]),_:1}),e(W,{class:"px-2 pt-0"},{default:a(()=>[e(S,null,{default:a(()=>[e(L,{ref_key:"form",ref:k},{default:a(()=>[e(I,null,{default:a(()=>[e(d,{cols:"12",sm:"6"},{default:a(()=>[e(T,{modelValue:s.value.test,"onUpdate:modelValue":o[2]||(o[2]=t=>s.value.test=t),label:"Test bazasi",rules:y,"hide-details":"",items:U.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.date,"onUpdate:modelValue":o[3]||(o[3]=t=>s.value.date=t),label:"Test vaqti",type:"date","hide-details":"",rules:y,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.time,"onUpdate:modelValue":o[4]||(o[4]=t=>s.value.time=t),label:"Testga beriladigan vaqt (minut)","hide-details":"",rules:y,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.count,"onUpdate:modelValue":o[5]||(o[5]=t=>s.value.count=t),label:"Savollar soni","hide-details":"",rules:y,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(T,{modelValue:s.value.groups,"onUpdate:modelValue":o[6]||(o[6]=t=>s.value.groups=t),label:"Guruhlar","hide-details":"",multiple:"",items:q.value,chips:"",color:"primary",rules:y,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(b,{variant:"tonal",color:"primary",block:"",onClick:Q,height:"45"},{default:a(()=>[x(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(D,{modelValue:g.value,"onUpdate:modelValue":o[8]||(o[8]=t=>g.value=t),"max-width":"500px"},{default:a(()=>[e($,null,{default:a(()=>[e(j,{class:"text-h6"},{default:a(()=>[x(" Bu ma'lumotni uchirmoqchimisiz? ")]),_:1}),e(X,null,{default:a(()=>[e(G),e(b,{color:"blue-darken-1",variant:"text",onClick:C},{default:a(()=>[x(" Bekor qilish ")]),_:1}),e(b,{color:"blue-darken-1",variant:"text",onClick:A},{default:a(()=>[x(" Ha ")]),_:1}),e(G)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{be as default};
