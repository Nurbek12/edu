import{r as d,l as Z,m as ee,a as n,o as I,c as S,w as e,h as b,b as t,f as g,d as i,t as m,i as te,j as ae,F as le,e as oe,n as se}from"./index-eee0caed.js";const ne={class:"responsive-datatable"},ie={"data-label":"Test baza"},de={"data-label":"Fan"},ue={"data-label":"Sanasi"},re={"data-label":"Berilgan vaqt"},ce={"data-label":"Guruhlar"},me={style:{display:"flex",gap:"5px"}},ve={"data-label":"Savollar soni"},_e={"data-label":"Boshqarish"},pe={class:"d-flex justify-end align-center"},fe=i("div",null,"Hech narsa topilmadi",-1),be={class:"text-h5"},ge={__name:"Exams",setup(he){const $=[{title:"Test baza",key:"name"},{title:"Fan",key:"subject",sortable:!1},{title:"Guruhlar",key:"group",sortable:!1},{title:"Sanasi",key:"date",sortable:!1},{title:"Berilgan vaqt",key:"time",sortable:!1},{title:"Savollar soni",key:"count",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],h=[l=>!!l||"Required"],w=d(null);d(null);const k=d(""),v=d([]),f=d(!1),_=d(-1),y=d(-1),q=d([]),z=d([]),F=d([]),s=d({groups:[],test:null,count:0,time:0,date:""}),G={test:null,groups:[],count:0,time:0,date:""},N=Z(()=>_.value===-1?"Imtihon Yaratish":"Imtihonni O'zgartirish");ee(f,l=>l||x());const E=async()=>{const[l,o,r]=await Promise.all([b.get("/group"),b.get("/test"),b.get("/exam")]);v.value=r.data,z.value=o.data,q.value=l.data},D=async()=>{const{valid:l}=await w.value.validate();l&&Q()},H=l=>{_.value=v.value.indexOf(l),y.value=l._id,s.value=Object.assign({},l),f.value=!0},L=l=>{_.value=v.value.indexOf(l),s.value=Object.assign({},l),y.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?P():x()},P=async()=>{const{data:l}=await b.delete(`/exam/${y.value}`);l&&(v.value.splice(_.value,1),x())},x=()=>{f.value=!1,se(()=>{var l;s.value=Object.assign({},G),y.value=-1,_.value=-1,(l=w.value)==null||l.reset()})},Q=async()=>{if(_.value>-1){const{data:l}=await b.put(`/exam/${y.value}`,s.value);Object.assign(v.value[_.value],l)}else{const{data:l}=await b.post("/exam",{questions:F.value,...s.value});v.value.push(l)}x()},R=l=>l.map(o=>q.value.find(({_id:r})=>r===o).name);return E(),(l,o)=>{const r=n("v-text-field"),u=n("v-col"),V=n("v-btn"),j=n("v-row"),C=n("v-sheet"),Y=n("v-chip"),B=n("v-icon"),A=n("v-data-table"),J=n("v-card-title"),T=n("v-select"),K=n("v-form"),U=n("v-container"),M=n("v-card-text"),W=n("v-card"),X=n("v-dialog");return I(),S(U,{fluid:""},{default:e(()=>[t(j,null,{default:e(()=>[t(u,{cols:"12"},{default:e(()=>[t(C,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[t(j,{justify:"space-between",align:"center"},{default:e(()=>[t(u,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[t(r,{label:"Qidirish",modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=a=>k.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(u,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[t(V,{block:"",height:"42",color:"primary",onClick:o[1]||(o[1]=a=>f.value=!0),variant:"flat"},{default:e(()=>[g("Imtihon yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(u,{cols:"12"},{default:e(()=>[t(C,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[i("div",ne,[t(A,{"items-per-page-text":"",headers:$,search:k.value,items:v.value},{"item.name":e(({index:a,item:c})=>{var p,O;return[i("td",ie,m(a+1)+". "+m((O=(p=c.raw)==null?void 0:p.test)==null?void 0:O.name),1)]}),"item.subject":e(({item:a})=>{var c,p;return[i("td",de,m((p=(c=a.raw)==null?void 0:c.test)==null?void 0:p.subject),1)]}),"item.date":e(({item:a})=>[i("td",ue,m(a.raw.date),1)]),"item.time":e(({item:a})=>[i("td",re,m(a.raw.time),1)]),"item.group":e(({item:a})=>[i("td",ce,[i("div",me,[(I(!0),te(le,null,ae(R(a.raw.groups),(c,p)=>(I(),S(Y,{label:"",color:"primary",size:"small",key:p},{default:e(()=>[g(m(c),1)]),_:2},1024))),128))])])]),"item.count":e(({item:a})=>[i("td",ve,m(a.raw.count),1)]),"item.actions":e(({item:a})=>[i("td",_e,[i("div",pe,[t(V,{variant:"flat",size:"30",color:"primary",onClick:c=>H(a.raw)},{default:e(()=>[t(B,null,{default:e(()=>[g("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(V,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:c=>L(a.raw)},{default:e(()=>[t(B,null,{default:e(()=>[g("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"no-data":e(()=>[fe]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t(X,{modelValue:f.value,"onUpdate:modelValue":o[7]||(o[7]=a=>f.value=a),"max-width":"550px"},{default:e(()=>[t(W,{class:"test-scroll"},{default:e(()=>[t(J,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[i("span",be,m(oe(N)),1)]),_:1}),t(M,{class:"px-2 pt-0"},{default:e(()=>[t(U,null,{default:e(()=>[t(K,{ref_key:"form",ref:w},{default:e(()=>[t(j,null,{default:e(()=>[t(u,{cols:"12",sm:"6"},{default:e(()=>[t(T,{modelValue:s.value.test,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.test=a),label:"Test bazasi",rules:h,"hide-details":"",items:z.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:e(()=>[t(r,{modelValue:s.value.date,"onUpdate:modelValue":o[3]||(o[3]=a=>s.value.date=a),label:"Test vaqti",type:"date","hide-details":"",rules:h,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:e(()=>[t(r,{modelValue:s.value.time,"onUpdate:modelValue":o[4]||(o[4]=a=>s.value.time=a),label:"Testga beriladigan vaqt (minut)","hide-details":"",rules:h,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",sm:"6"},{default:e(()=>[t(r,{modelValue:s.value.count,"onUpdate:modelValue":o[5]||(o[5]=a=>s.value.count=a),label:"Savollar soni","hide-details":"",rules:h,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12"},{default:e(()=>[t(T,{modelValue:s.value.groups,"onUpdate:modelValue":o[6]||(o[6]=a=>s.value.groups=a),label:"Guruhlar","hide-details":"",multiple:"",items:q.value,chips:"",color:"primary",rules:h,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12"},{default:e(()=>[t(V,{variant:"flat",color:"primary",block:"",onClick:D,height:"45"},{default:e(()=>[g(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ge as default};
