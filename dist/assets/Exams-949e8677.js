import{a as f}from"./index-7376b9a9.js";import{r as d,l as J,n as K,a as n,o as L,c as W,w as e,b as a,f as x,d as i,t as v,e as X,p as Z}from"./index-856562a7.js";const ee={class:"responsive-datatable"},ae={"data-label":"T/r"},te={"data-label":"Test baza"},le={"data-label":"Fan"},oe={"data-label":"Sanasi"},se={"data-label":"Berilgan vaqt"},ne={"data-label":"Guruh"},ie={"data-label":"Savollar soni"},de={"data-label":"Boshqarish"},ue={class:"d-flex justify-end align-center"},re=i("div",null,"Hech narsa topilmadi",-1),ce={class:"text-h5"},pe={__name:"Exams",setup(me){const S=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test baza",key:"name"},{title:"Fan",key:"science",sortable:!1},{title:"Guruhlar",key:"group",sortable:!1},{title:"Sanasi",key:"date",sortable:!1},{title:"Muhlati",key:"time",sortable:!1},{title:"Savollar soni",key:"count",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],h=[l=>!!l||"Required"],w=d(null);d(null);const k=d(""),c=d([]),_=d(!1),m=d(-1),b=d(-1),q=d([]),U=d([]),j=d([]),s=d({groups:[],test:null,count:0,time:0,date:""}),B={test:null,groups:[],count:0,time:0,date:""},$=J(()=>m.value===-1?"Imtihon Yaratish":"Imtihonni O'zgartirish");K(_,l=>l||g());const G=async()=>{const[l,o,p]=await Promise.all([f.get("/group"),f.get("/test"),f.get("/exam")]);c.value=p.data,U.value=o.data,q.value=l.data},N=async()=>{const{valid:l}=await w.value.validate();l&&H()},F=l=>{m.value=c.value.indexOf(l),b.value=l._id,s.value=Object.assign({},l),_.value=!0},D=l=>{m.value=c.value.indexOf(l),s.value=Object.assign({},l),b.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?E():g()},E=async()=>{const{data:l}=await f.delete(`/exam/${b.value}`);l&&(c.value.splice(m.value,1),g())},g=()=>{_.value=!1,Z(()=>{var l;s.value=Object.assign({},B),b.value=-1,m.value=-1,(l=w.value)==null||l.reset()})},H=async()=>{if(m.value>-1){const{data:l}=await f.put(`/exam/${b.value}`,s.value);Object.assign(c.value[m.value],l)}else{const{data:l}=await f.post("/exam",{questions:j.value,...s.value});console.log(l),c.value.push(l)}g()};return G(),(l,o)=>{const p=n("v-text-field"),u=n("v-col"),V=n("v-btn"),I=n("v-row"),C=n("v-sheet"),T=n("v-select"),z=n("v-icon"),M=n("v-data-table"),P=n("v-card-title"),Q=n("v-form"),O=n("v-container"),R=n("v-card-text"),Y=n("v-card"),A=n("v-dialog");return L(),W(O,{fluid:""},{default:e(()=>[a(I,null,{default:e(()=>[a(u,{cols:"12"},{default:e(()=>[a(C,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(I,{justify:"space-between",align:"center"},{default:e(()=>[a(u,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(p,{label:"Qidirish",modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=t=>k.value=t),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(u,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[a(V,{block:"",height:"42",color:"primary",onClick:o[1]||(o[1]=t=>_.value=!0),variant:"flat"},{default:e(()=>[x("Imtihon yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:e(()=>[a(C,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[i("div",ee,[a(M,{"items-per-page-text":"",headers:S,search:k.value,items:c.value},{"item.no":e(({index:t})=>[i("td",ae,v(t+1)+".",1)]),"item.name":e(({item:t})=>{var r,y;return[i("td",te,v((y=(r=t.raw)==null?void 0:r.test)==null?void 0:y.name),1)]}),"item.science":e(({item:t})=>{var r,y;return[i("td",le,v((y=(r=t.raw)==null?void 0:r.test)==null?void 0:y.science),1)]}),"item.date":e(({item:t})=>[i("td",oe,v(t.raw.date),1)]),"item.time":e(({item:t})=>[i("td",se,v(t.raw.time),1)]),"item.group":e(({item:t})=>[i("td",ne,[a(T,{items:q.value,readonly:"",chips:"",multiple:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:t.raw.groups,"onUpdate:modelValue":r=>t.raw.groups=r},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.count":e(({item:t})=>[i("td",ie,v(t.raw.count),1)]),"item.actions":e(({item:t})=>[i("td",de,[i("div",ue,[a(V,{variant:"flat",size:"30",color:"primary",onClick:r=>F(t.raw)},{default:e(()=>[a(z,null,{default:e(()=>[x("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(V,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:r=>D(t.raw)},{default:e(()=>[a(z,null,{default:e(()=>[x("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"no-data":e(()=>[re]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),a(A,{modelValue:_.value,"onUpdate:modelValue":o[7]||(o[7]=t=>_.value=t),"max-width":"550px"},{default:e(()=>[a(Y,{class:"test-scroll"},{default:e(()=>[a(P,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[i("span",ce,v(X($)),1)]),_:1}),a(R,{class:"px-2 pt-0"},{default:e(()=>[a(O,null,{default:e(()=>[a(Q,{ref_key:"form",ref:w},{default:e(()=>[a(I,null,{default:e(()=>[a(u,{cols:"12",sm:"6"},{default:e(()=>[a(T,{modelValue:s.value.test,"onUpdate:modelValue":o[2]||(o[2]=t=>s.value.test=t),label:"Test bazasi",rules:h,"hide-details":"",items:U.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(u,{cols:"12",sm:"6"},{default:e(()=>[a(p,{modelValue:s.value.date,"onUpdate:modelValue":o[3]||(o[3]=t=>s.value.date=t),label:"Test vaqti",type:"date","hide-details":"",rules:h,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",sm:"6"},{default:e(()=>[a(p,{modelValue:s.value.time,"onUpdate:modelValue":o[4]||(o[4]=t=>s.value.time=t),label:"Testga beriladigan vaqt (minut)","hide-details":"",rules:h,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",sm:"6"},{default:e(()=>[a(p,{modelValue:s.value.count,"onUpdate:modelValue":o[5]||(o[5]=t=>s.value.count=t),label:"Savollar soni","hide-details":"",rules:h,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(u,{cols:"12"},{default:e(()=>[a(T,{modelValue:s.value.groups,"onUpdate:modelValue":o[6]||(o[6]=t=>s.value.groups=t),label:"Guruhlar","hide-details":"",multiple:"",items:q.value,chips:"",color:"primary",rules:h,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(u,{cols:"12"},{default:e(()=>[a(V,{variant:"flat",color:"primary",block:"",onClick:N,height:"45"},{default:e(()=>[x(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{pe as default};
