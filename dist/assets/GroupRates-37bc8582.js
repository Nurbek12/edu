import{u as C,r as s,a as m,o as S,c as Y,w as e,h as v,b as t,e as N,f as O,d as r,t as _}from"./index-2e243627.js";import{s as T}from"./semesters-2992cfa7.js";const q=r("div",{class:"d-flex justify-center"},"Baholar jadvali",-1),E={class:"responsive-datatable mt-2"},L={"data-label":"Fan nomi"},A={"data-label":"Joriy"},D={"data-label":"Oraliq"},G={"data-label":"Yakuniy"},H={"data-label":"Umumiy"},J=r("div",null,"Hech narsa topilmadi",-1),I={__name:"GroupRates",setup(M){C();const g=[{title:"Fan Nomi",key:"subject"},{title:"Joriy",key:"totalRate"},{title:"Oraliq",key:"totalMidmRate"},{title:"Yakuniy",key:"totalExamRate"},{title:"Umumiy",key:"total"}],x=s(""),u=s({}),b=s([]),i=s(null),p=s([]),f=s(null),h=s([]);s(!1),s(!1),s(-1),s(-1);const k=async()=>{const{data:o}=await v.get("/group");p.value=o},y=async o=>{const{data:l}=await v.get(`/rate/student/${f.value}?${o}`);u.value=l,b.value=l.subjects},j=async()=>{if(!i.value)return;const{data:o}=await v.get(`/user/student?group=${i.value}`);h.value=o},F=o=>{delete o.title,y(new URLSearchParams(o).toString())},R=async()=>{var l;const o=(l=p.value.find(c=>c._id===i.value))==null?void 0:l.name;await v({method:"get",url:`/rate/download/${i.value}`,responseType:"blob",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}).then(c=>{const n=window.URL.createObjectURL(new Blob([c.data])),d=document.createElement("a");d.href=n,d.setAttribute("download",`${o}-guruh_baholar_jadvali.xlsx`),document.body.appendChild(d),d.click()})};return k(),(o,l)=>{const c=m("v-sheet"),n=m("v-col"),d=m("v-select"),V=m("v-btn"),w=m("v-row"),U=m("v-data-table"),B=m("v-container");return S(),Y(B,{fluid:""},{default:e(()=>[t(w,null,{default:e(()=>[t(n,{cols:"12"},{default:e(()=>[t(c,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[q]),_:1})]),_:1}),t(n,{cols:"12",md:"4"},{default:e(()=>[t(c,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[t(w,null,{default:e(()=>[t(n,{cols:"12"},{default:e(()=>[t(d,{modelValue:i.value,"onUpdate:modelValue":[l[0]||(l[0]=a=>i.value=a),j],label:"Guruh","hide-details":"",density:"comfortable",items:p.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12",class:"pt-0"},{default:e(()=>[t(d,{modelValue:f.value,"onUpdate:modelValue":[l[1]||(l[1]=a=>f.value=a),l[2]||(l[2]=a=>y(""))],label:"O'quvchi","hide-details":"",density:"comfortable",items:h.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12",class:"pt-0"},{default:e(()=>[t(d,{disabled:!i.value,label:"Semestr","onUpdate:modelValue":F,"hide-details":"",items:N(T),density:"compact",color:"primary","item-title":"title","return-object":"",variant:"outlined"},null,8,["disabled","items"])]),_:1}),t(n,{cols:"12",class:"pt-0"},{default:e(()=>[t(V,{block:"",color:"primary",disabled:!i.value,variant:"flat",height:"42",onClick:R},{default:e(()=>[O("Yuklab olish")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),t(n,{cols:"12",md:"8"},{default:e(()=>[t(c,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[r("div",E,[t(U,{"no-data-text":"Hech narsa topilmadi",density:"compact","items-per-page-text":"","items-per-page":"-1",headers:g,search:x.value,items:b.value},{"item.subject":e(({index:a,item:$})=>[r("td",L,_(a+1)+". "+_($.raw),1)]),"item.totalRate":e(({item:a})=>[r("td",A,_(parseFloat(u.value.jn[a.raw]||0).toFixed(1)),1)]),"item.totalMidmRate":e(({item:a})=>[r("td",D,_(parseFloat(u.value.on[a.raw]||0).toFixed(1)),1)]),"item.totalExamRate":e(({item:a})=>[r("td",G,_(parseFloat(u.value.yn[a.raw]||0).toFixed(1)),1)]),"item.total":e(({item:a})=>[r("td",H,_(parseFloat(((u.value.yn[a.raw]||0)+(u.value.on[a.raw]||0)+(u.value.jn[a.raw]||0))/3).toFixed(1)),1)]),"no-data":e(()=>[J]),bottom:e(()=>[]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{I as default};
