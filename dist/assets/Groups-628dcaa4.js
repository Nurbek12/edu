import{r as i,l as W,m as N,a as s,o as X,c as Z,w as e,h as b,b as a,f as _,d as o,t as d,e as ee,n as U}from"./index-2e243627.js";const ae={class:"responsive-datatable"},te={"data-label":"T/r"},le={"data-label":"Fan nomi"},se={"data-label":"Talabalar soni"},oe={"data-label":"Boshqarish"},ne={class:"d-flex justify-end align-center"},ie=o("div",null,"Hech narsa topilmadi",-1),de={class:"text-h5"},ue={class:"responsive-datatable"},re={"data-label":"Ism familiyasi"},ce={"data-label":"Login"},_e={"data-label":"Telefoni"},me={"data-label":"Tugilgan sanasi"},pe={__name:"Groups",setup(ve){const H=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Guruh Nomi",key:"name"},{title:"Talabalar soni",key:"users"},{title:"Boshqarish",key:"actions",sortable:!1}],L=[{title:"Ism familiyasi",key:"name"},{title:"Login",key:"login"},{title:"Telefoni",key:"phone"},{title:"Tugilgan sanasi",key:"birthdate"}],S=[t=>!!t||"Required"],g=i(""),u=i([]),k=i([]),V=i(null),m=i(!1),p=i(!1),r=i(-1),h=i(-1),c=i({name:""}),D={name:""},F=W(()=>r.value===-1?"Guruh Yaratish":"Guruhni O'zgartirish");N(m,t=>t||y()),N(p,t=>t||T());const Q=async()=>{const{data:t}=await b.get("/group?users=1");u.value=t},R=async()=>{const{valid:t}=await V.value.validate();t&&K()},Y=async t=>{const{data:n}=await b.get(`/user/student?group=${t}`);k.value=n,p.value=!0},A=t=>{r.value=u.value.indexOf(t),h.value=t._id,c.value=Object.assign({},t),m.value=!0},E=t=>{r.value=u.value.indexOf(t),c.value=Object.assign({},t),h.value=t._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?J():y()},J=async()=>{const{data:t}=await b.delete(`/group/${h.value}`);t&&(u.value.splice(r.value,1),y())},y=()=>{m.value=!1,U(()=>{var t;c.value=Object.assign({},D),h.value=-1,r.value=-1,(t=V.value)==null||t.reset()})},T=()=>{p.value=!1,U(()=>{k.value=[]})},K=async()=>{if(r.value>-1){const{data:t}=await b.put(`/group/${h.value}`,c.value);Object.assign(u.value[r.value],t)}else{const{data:t}=await b.post("/group",c.value);u.value.push({...t,users:0})}y()};return Q(),(t,n)=>{const I=s("v-text-field"),v=s("v-col"),f=s("v-btn"),C=s("v-row"),z=s("v-sheet"),w=s("v-icon"),j=s("v-data-table"),G=s("v-card-title"),M=s("v-form"),O=s("v-container"),$=s("v-card-text"),q=s("v-card"),B=s("v-dialog"),P=s("v-spacer");return X(),Z(O,{fluid:""},{default:e(()=>[a(C,null,{default:e(()=>[a(v,{cols:"12"},{default:e(()=>[a(z,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(C,{justify:"space-between"},{default:e(()=>[a(v,{cols:"12",class:"py-1",sm:"4"},{default:e(()=>[a(I,{label:"Qidirish",modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=l=>g.value=l),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(v,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[a(f,{block:"",height:"42",color:"primary",onClick:n[1]||(n[1]=l=>m.value=!0),variant:"flat"},{default:e(()=>[_("Guruh yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(v,{cols:"12"},{default:e(()=>[a(z,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[o("div",ae,[a(j,{"items-per-page-text":"",headers:H,search:g.value,items:u.value},{"item.no":e(({index:l})=>[o("td",te,d(l+1)+".",1)]),"item.name":e(({item:l})=>[o("td",le,d(l.raw.name),1)]),"item.users":e(({item:l})=>[o("td",se,d(l.raw.users),1)]),"item.actions":e(({item:l})=>[o("td",oe,[o("div",ne,[a(f,{variant:"flat",size:"30",color:"primary",onClick:x=>Y(l.raw._id)},{default:e(()=>[a(w,null,{default:e(()=>[_("mdi-list-box")]),_:1})]),_:2},1032,["onClick"]),a(f,{variant:"flat",size:"30",class:"ml-1",color:"primary",onClick:x=>A(l.raw)},{default:e(()=>[a(w,null,{default:e(()=>[_("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(f,{variant:"flat",size:"30",class:"ml-1",color:"primary",onClick:x=>E(l.raw)},{default:e(()=>[a(w,null,{default:e(()=>[_("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"no-data":e(()=>[ie]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),a(B,{modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=l=>m.value=l),"max-width":"550px"},{default:e(()=>[a(q,null,{default:e(()=>[a(G,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[o("span",de,d(ee(F)),1)]),_:1}),a($,{class:"px-2 pt-0"},{default:e(()=>[a(O,null,{default:e(()=>[a(M,{ref_key:"form",ref:V},{default:e(()=>[a(C,null,{default:e(()=>[a(v,{cols:"12"},{default:e(()=>[a(I,{modelValue:c.value.name,"onUpdate:modelValue":n[2]||(n[2]=l=>c.value.name=l),label:"Guruh Nomi","hide-details":"",rules:S,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(v,{cols:"12"},{default:e(()=>[a(f,{variant:"flat",color:"primary",block:"",onClick:R,height:"45"},{default:e(()=>[_(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{"max-width":"850",modelValue:p.value,"onUpdate:modelValue":n[4]||(n[4]=l=>p.value=l)},{default:e(()=>[a(q,null,{default:e(()=>[a(G,{class:"text-h6 d-flex justify-space-between align-center"},{default:e(()=>[_(" Guruhdagi o'quvchilar ruytati "),a(P),a(f,{size:"30",color:"primary",onClick:T},{default:e(()=>[a(w,{size:"small"},{default:e(()=>[_("mdi-close")]),_:1})]),_:1})]),_:1}),a($,{class:"px-2"},{default:e(()=>[o("div",ue,[a(j,{"no-data-text":"Hech narsa topilmadi","items-per-page-text":"","items-per-page":"-1",headers:L,search:g.value,items:k.value},{"item.name":e(({index:l,item:x})=>[o("td",re,d(l+1)+". "+d(x.raw.name),1)]),bottom:e(()=>[]),"item.login":e(({item:l})=>[o("td",ce,d(l.raw.login),1)]),"item.phone":e(({item:l})=>[o("td",_e,d(l.raw.phone),1)]),"item.birthdate":e(({item:l})=>[o("td",me,d(l.raw.birthdate),1)]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{pe as default};
