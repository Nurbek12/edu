import{u as we,r as u,l as ke,m as J,a as o,o as i,i as m,b as t,w as e,F as v,h as V,j as $,d as B,t as d,e as ye,f as n,n as be,c as j,k as S}from"./index-868e85fe.js";import{_ as ge}from"./FooterPage-88fbb968.js";const xe=B("div",{class:"d-flex justify-center"},"FAN TOPSHIRIQLARI",-1),ze=["href"],Ve=["href"],je={class:"text-h5"},Ie={__name:"Homeworks",setup(De){const C=we(),w=u(!1),H=u(""),_=u([]),L=u([]),I=u(null),f=u(-1),k=u(null),y=u({description:""}),O=u(null),T=u([]),K={description:""},M=ke(()=>k.value?"Vazifani O'zgartirish":"Vazifa Yaratish"),W=[l=>!!l||"Required"],X=async()=>{var s;const{data:l}=await V.get(`/subject/group/${(s=C.getters.user)==null?void 0:s.group}`);return L.value=l,!0},Z=async(l,s)=>{if(!s)return;const{data:r}=await V.get(`/homework?${l||""}&subject=${s}`);return _.value=r,!0};J(w,l=>l||N()),J([H,I],([l,s])=>Z(l,s));const ee=l=>{var s;f.value=_.value.indexOf(l),k.value=l.student_homeworks?l.student_homeworks._id:null,y.value=Object.assign({},{description:((s=l.student_homeworks)==null?void 0:s.description)||""}),w.value=!0},te=async()=>{const{valid:l}=await O.value.validate();l&&ae()},ae=async()=>{var s;const l=new FormData;if(l.append("homework",_.value[f.value]._id),l.append("subject",_.value[f.value].subject),l.append("description",y.value.description),l.append("date",new Date().toLocaleString()),l.append("student",C.getters.userid),l.append("group",(s=C.getters.user)==null?void 0:s.group),T.value.map(r=>l.append("files",r)),k.value){const{data:r}=await V.put(`/homework/edit/${k.value}`,l);Object.assign(_.value[f.value],{student_homeworks:r})}else{const{data:r}=await V.post("/homework",l);Object.assign(_.value[f.value],{student_homeworks:r})}N()},N=()=>{w.value=!1,be(()=>{var l;y.value=Object.assign({},K),k.value=null,f.value=-1,(l=O.value)==null||l.reset()})},le=async(l,s,r,q)=>{if(!confirm("Bu faylni o'chirmoqchimisiz?"))return;const{data:h}=await V.put(`/homework/removefile/${l}`,{file:q});h&&_.value[s].student_homeworks.files.splice(r,1)};return X(),(l,s)=>{const r=o("v-col"),q=o("v-select"),h=o("v-row"),oe=o("v-sheet"),b=o("v-icon"),F=o("v-chip"),se=o("v-expansion-panel-title"),p=o("v-card-text"),U=o("v-list-subheader"),Y=o("v-list-item-title"),g=o("v-btn"),A=o("v-list-item"),R=o("v-list"),E=o("v-divider"),ne=o("v-spacer"),re=o("v-card-actions"),G=o("v-card"),de=o("v-expansion-panel-text"),ie=o("v-expansion-panel"),ce=o("v-expansion-panels"),ue=o("v-timeline-item"),_e=o("v-timeline"),P=o("v-container"),pe=o("v-card-title"),me=o("v-file-input"),ve=o("v-textarea"),fe=o("v-form"),he=o("v-dialog");return i(),m(v,null,[t(P,{fluid:""},{default:e(()=>[t(h,null,{default:e(()=>[t(r,{cols:"12"},{default:e(()=>[t(oe,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[t(h,{justify:"space-between",align:"center"},{default:e(()=>[t(r,{cols:"12",sm:"4"},{default:e(()=>[xe]),_:1}),t(r,{cols:"12",sm:"4"},{default:e(()=>[t(q,{label:"Biriktirilgan fanlar Fanlar",modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=a=>I.value=a),"hide-details":"",density:"compact",items:L.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),t(r,{cols:"12"},{default:e(()=>[t(_e,{density:"compact",side:"end"},{default:e(()=>[(i(!0),m(v,null,$(_.value,(a,D)=>(i(),j(ue,{key:a._id,width:"100%","dot-color":a.student_homeworks?"primary":"red",size:"small"},{default:e(()=>[t(h,null,{default:e(()=>[t(r,{cols:"12",class:"py-1"},{default:e(()=>[t(F,{label:"",variant:"elevated",color:new Date<new Date(a.date)?"primary":"red",class:"mb-2 mr-1",size:"large"},{default:e(()=>[t(b,{class:"mr-2",size:"small"},{default:e(()=>[n("mdi-clock-outline")]),_:1}),n(d(a.date),1)]),_:2},1032,["color"]),t(F,{label:"",variant:"elevated",color:"primary",class:"mb-2 mr-1",size:"large"},{default:e(()=>{var x;return[t(b,{class:"mr-2",size:"small"},{default:e(()=>[n("mdi-star-outline")]),_:1}),n(d(((x=a.student_homeworks)==null?void 0:x.rate)||0)+" / 5 ",1)]}),_:2},1024)]),_:2},1024),t(r,{cols:"12",class:"py-1"},{default:e(()=>[t(ce,{variant:"accordion"},{default:e(()=>[t(ie,null,{default:e(()=>[t(se,null,{default:e(()=>[n(d(a.subject)+": "+d(a.name),1)]),_:2},1024),t(de,{class:"resources"},{default:e(()=>[t(G,{color:"transparent",elevation:"0"},{default:e(()=>{var x;return[t(p,{class:"pb-0"},{default:e(()=>[n(" Topshiriq izohi: "+d(a.description),1)]),_:2},1024),t(p,{class:"pb-0"},{default:e(()=>[n(" Topshiriq muddati: "+d(a.date),1)]),_:2},1024),t(p,{class:"py-0"},{default:e(()=>[t(R,{density:"compact"},{default:e(()=>[t(U,null,{default:e(()=>[n("Topshiriq fayllari")]),_:1}),(i(!0),m(v,null,$(a.files,(c,z)=>(i(),j(A,{key:c,class:"px-0"},{append:e(()=>[B("a",{href:`/files/${c}`,target:"_blank",download:"true"},[t(g,{color:"primary",size:"30",variant:"flat",class:"ml-3"},{default:e(()=>[t(b,null,{default:e(()=>[n("mdi-download")]),_:1})]),_:1})],8,ze)]),default:e(()=>[t(Y,{class:"text-body-2"},{default:e(()=>[n(d(z+1)+". "+d(c),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),a.student_homeworks?(i(),m(v,{key:0},[t(E),t(p,{class:"pb-0"},{default:e(()=>[n(" Vazifa izohi: "+d(a.student_homeworks.description)+" ("+d(new Date(a.student_homeworks.createdAt).toLocaleString())+") ",1)]),_:2},1024),t(p,{class:"py-0"},{default:e(()=>[t(R,{density:"compact"},{default:e(()=>[t(U,null,{default:e(()=>[n("Yuborilgan fayllar")]),_:1}),(i(!0),m(v,null,$(a.student_homeworks.files,(c,z)=>(i(),j(A,{key:c,class:"px-0"},{append:e(()=>{var Q;return[B("a",{href:`/files/${c}`,target:"_blank",download:"true"},[t(g,{color:"primary",size:"30",variant:"flat",class:"ml-3"},{default:e(()=>[t(b,null,{default:e(()=>[n("mdi-download")]),_:1})]),_:1})],8,Ve),new Date<new Date(a.date)?(i(),j(g,{key:0,color:"primary",disabled:!!((Q=a.student_homeworks)!=null&&Q.rate_description),size:"30",onClick:$e=>le(a.student_homeworks._id,D,z,c),variant:"flat",class:"ml-1"},{default:e(()=>[t(b,null,{default:e(()=>[n("mdi-delete")]),_:1})]),_:2},1032,["disabled","onClick"])):S("",!0)]}),default:e(()=>[t(Y,{class:"text-body-2"},{default:e(()=>[n(d(z+1)+". "+d(c),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)],64)):S("",!0),(x=a.student_homeworks)!=null&&x.rate_description?(i(),m(v,{key:1},[t(E),t(p,{class:"pb-0"},{default:e(()=>[n(" Baholandi: "+d(a.student_homeworks.rate)+" / 5 ",1)]),_:2},1024),t(p,{class:"py-1 pb-0"},{default:e(()=>[n(" Baho izohi: "+d(a.student_homeworks.rate_description),1)]),_:2},1024)],64)):S("",!0),t(re,null,{default:e(()=>{var c;return[t(ne),t(g,{height:"35",color:"primary",variant:"flat",onClick:z=>ee(a),disabled:!!((c=a.student_homeworks)!=null&&c.rate_description)||new Date>new Date(a.date)},{default:e(()=>[n(d(a.student_homeworks?"O'zgartirish":"Yuborish"),1)]),_:2},1032,["onClick","disabled"])]}),_:2},1024)]}),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["dot-color"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(he,{modelValue:w.value,"onUpdate:modelValue":s[3]||(s[3]=a=>w.value=a),"max-width":"550px"},{default:e(()=>[t(G,null,{default:e(()=>[t(pe,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[B("span",je,d(ye(M)),1)]),_:1}),t(p,{class:"px-2 pt-0"},{default:e(()=>[t(P,null,{default:e(()=>[t(fe,{ref_key:"form",ref:O},{default:e(()=>[t(h,null,{default:e(()=>[t(r,{cols:"12"},{default:e(()=>[t(me,{"hide-details":"",variant:"outlined",color:"primary",modelValue:T.value,"onUpdate:modelValue":s[1]||(s[1]=a=>T.value=a),"prepend-icon":null,label:"Fayllar qo'shish",multiple:"","show-size":!0},{selection:e(({fileNames:a})=>[(i(!0),m(v,null,$(a,D=>(i(),j(F,{key:D,size:"small",label:"",color:"primary",class:"me-2"},{default:e(()=>[n(d(D),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{cols:"12"},{default:e(()=>[t(ve,{modelValue:y.value.description,"onUpdate:modelValue":s[2]||(s[2]=a=>y.value.description=a),label:"Topshiriq izohi","hide-details":"",color:"primary",rules:W,variant:"outlined"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",class:"pt-0"},{default:e(()=>[t(g,{variant:"flat",color:"primary",block:"",onClick:te,height:"45"},{default:e(()=>[n(" Yuborish ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ge,{onGetDate:s[4]||(s[4]=a=>H.value=a)})],64)}}};export{Ie as default};
