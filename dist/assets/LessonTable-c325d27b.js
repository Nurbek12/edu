import{r as d,l as te,m as oe,a as n,o as V,c as se,w as l,h as m,b as e,e as T,f as k,i as C,j as N,F as P,d as u,t as b,n as ne}from"./index-439559a6.js";import{s as ue}from"./semesters-2992cfa7.js";const ie={class:"text-h6"},de=u("thead",null,[u("tr",null,[u("th",{class:"text-left"},"Fan Nomi"),u("th",{class:"text-left"},"O'qituvchi"),u("th",{class:"text-left"},"Auditoriya"),u("th",{class:"text-left"})])],-1),re={class:"d-flex justify-end align-center"},ce={class:"text-h5"},pe={__name:"LessonTable",setup(me){const O=["Dushanba","Seshanba","Chorshanba","Payshanba","Juma","Shanba"],v=[a=>!!a||"Required"];d("");const j=d(null),r=d({Dushanba:[],Seshanba:[],Chorshanba:[],Payshanba:[],Juma:[],Shanba:[]}),U=d([]),S=d([]),z=d([]),_=d(!1),c=d(-1),y=d(-1),t=d({group:null,teacher:null,subject:null,day:null,index:null,room:""}),A={teacher:null,subject:null,day:null,index:null,room:""},J=te(()=>c.value===-1?"Fan Yaratish":"Fanni O'zgartirish");oe(_,a=>a||h());const L=async()=>{const a=await Promise.all([m.get("/user/teacher"),m.get("/group"),m.get("/subject")]);U.value=a[0].data,S.value=a[1].data,z.value=a[2].data},I=async a=>{const{data:o}=await m.get(`/table?group=${t.value.group}&${a}`);r.value=Object.assign({},o)},Y=async()=>{const{valid:a}=await j.value.validate();a&&H()},R=a=>{c.value=r.value[a.day].indexOf(a),y.value=a._id,t.value=Object.assign({},a),_.value=!0},E=a=>{c.value=r.value[a.day].indexOf(a),t.value=Object.assign({},a),y.value=a._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?G():h()},G=async()=>{const{data:a}=await m.delete(`/table/${y.value}`);a&&(r.value[t.value.day].splice(c.value,1),h())},h=()=>{_.value=!1,ne(()=>{var a;t.value=Object.assign({},{...A,group:t.value.group}),y.value=-1,c.value=-1,(a=j.value)==null||a.reset()})},H=async()=>{if(c.value>-1){const{data:a}=await m.put(`/table/${y.value}`,t.value);Object.assign(r.value[t.value.day][c.value],a)}else{const{data:a}=await m.post("/table",t.value);r.value[t.value.day]?r.value[t.value.day].push(a):r.value[t.value.day]=[a]}h()},K=a=>{delete a.title,I(new URLSearchParams(a).toString())};return L(),(a,o)=>{const p=n("v-select"),i=n("v-col"),g=n("v-btn"),x=n("v-row"),$=n("v-sheet"),w=n("v-card-text"),F=n("v-icon"),M=n("v-table"),q=n("v-card"),Q=n("v-card-title"),W=n("v-text-field"),X=n("v-form"),B=n("v-container"),Z=n("v-dialog");return V(),se(B,{fluid:""},{default:l(()=>[e(x,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e($,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:l(()=>[e(x,{justify:"space-between",align:"center"},{default:l(()=>[e(i,{cols:"12",class:"py-1",sm:"4"},{default:l(()=>[e(p,{modelValue:t.value.group,"onUpdate:modelValue":[o[0]||(o[0]=s=>t.value.group=s),I],label:"Guruhni tanlang",rules:v,"hide-details":"",items:S.value,density:"compact",color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12",class:"py-1",sm:"4"},{default:l(()=>[e(p,{label:"Semestr",disabled:!t.value.group,"onUpdate:modelValue":K,"hide-details":"",items:T(ue),density:"compact",color:"primary","item-title":"title","return-object":"",variant:"outlined"},null,8,["disabled","items"])]),_:1}),e(i,{cols:"12",class:"py-1",sm:"4"},{default:l(()=>[e(g,{block:"",color:"primary",disabled:!t.value.group,onClick:o[1]||(o[1]=s=>_.value=!0),variant:"flat",height:"42"},{default:l(()=>[k("Jadval yaratish")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(x,null,{default:l(()=>[(V(),C(P,null,N(O,(s,ee)=>e(i,{key:ee,cols:"12",sm:"6"},{default:l(()=>[e(q,null,{default:l(()=>[e(w,{class:"pa-0"},{default:l(()=>[e($,{color:"surface",class:"px-4 py-2"},{default:l(()=>[u("span",ie,b(s),1)]),_:2},1024)]),_:2},1024),e(w,{class:"px-0 pt-0"},{default:l(()=>[e(M,{density:"compact"},{default:l(()=>[de,u("tbody",null,[(V(!0),C(P,null,N(r.value[s]||[],(f,ae)=>{var D;return V(),C("tr",{key:ae},[u("td",null,b(f.index)+". "+b(f.subject),1),u("td",null,b((D=f.teacher)==null?void 0:D.name),1),u("td",null,b(f.room),1),u("td",null,[u("div",re,[e(g,{size:"30",elevation:"0",color:"primary",onClick:le=>R(f)},{default:l(()=>[e(F,{size:"small"},{default:l(()=>[k("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(g,{size:"30",elevation:"0",color:"primary",class:"ml-1",onClick:le=>E(f)},{default:l(()=>[e(F,{size:"small"},{default:l(()=>[k("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])])}),128))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)),64))]),_:1}),e(Z,{modelValue:_.value,"onUpdate:modelValue":o[7]||(o[7]=s=>_.value=s),"max-width":"550px"},{default:l(()=>[e(q,null,{default:l(()=>[e(Q,{class:"mt-2 ml-2 mb-0"},{default:l(()=>[u("span",ce,b(T(J)),1)]),_:1}),e(w,{class:"px-2 pt-0"},{default:l(()=>[e(B,null,{default:l(()=>[e(X,{ref_key:"form",ref:j},{default:l(()=>[e(x,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:t.value.day,"onUpdate:modelValue":o[2]||(o[2]=s=>t.value.day=s),label:"Hafta kuni",rules:v,"hide-details":"",items:O,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:t.value.index,"onUpdate:modelValue":o[3]||(o[3]=s=>t.value.index=s),label:"Dars soati",rules:v,"hide-details":"",items:[1,2,3,4,5,6,7,8,9,10,11],color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:t.value.subject,"onUpdate:modelValue":o[4]||(o[4]=s=>t.value.subject=s),label:"Fan nomi",rules:v,"hide-details":"",items:z.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:t.value.teacher,"onUpdate:modelValue":o[5]||(o[5]=s=>t.value.teacher=s),label:"O'qituvchi",rules:v,"hide-details":"",items:U.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(W,{modelValue:t.value.room,"onUpdate:modelValue":o[6]||(o[6]=s=>t.value.room=s),label:"Auditoriya",rules:v,"hide-details":"",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(g,{variant:"flat",color:"primary",block:"",onClick:Y,height:"45"},{default:l(()=>[k(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{pe as default};
