import{a as _}from"./index-7376b9a9.js";import{r as u,l as ae,m as G,a as s,o as H,c as le,w as l,b as e,d,f as h,h as te,i as oe,F as ne,t as y,e as se,p as J}from"./index-6f11c559.js";const ue={class:"d-flex justify-center"},ie={class:"responsive-datatable"},de={"data-label":"Dars soati"},re={"data-label":"Fan nomi"},ce={"data-label":"O'qituvchi"},ve={"data-label":"Guruh"},me={"data-label":"Boshqarish"},_e={class:"d-flex justify-end"},pe={class:"text-h5"},ye={__name:"LessonTable",setup(fe){const q=["Dushanba","Seshanba","Chorshanba","Payshanba","Juma","Shanba"],N=[{title:"Dars soati",align:"start",key:"no",sortable:!1},{title:"Fan nomi",key:"subject"},{title:"O'qituvchi",key:"teacher"},{title:"Guruh",key:"group"},{title:"Boshqarish",key:"actions",sortable:!1}],g=[a=>!!a||"Required"],P=[{key:"index",order:"asc"}];u("");const V=u(null),v=u({Dushanba:[],Seshanba:[],Chorshanba:[],Payshanba:[],Juma:[],Shanba:[]}),D=u([]),U=u([]),F=u([]),p=u(!1),x=u(!1),r=u(-1),f=u(-1),o=u({groups:null,teacher:null,subject:null,day:null,index:null}),I={groups:null,teacher:null,subject:null,day:null,index:null},L=ae(()=>r.value===-1?"Fan Yaratish":"Fanni O'zgartirish");G(p,a=>a||B()),G(x,a=>a||w());const Y=async()=>{const a=await Promise.all([_.get("/table"),_.get("/user/teacher"),_.get("/group"),_.get("/science")]);Object.assign(v.value,a[0].data),D.value=a[1].data,U.value=a[2].data,F.value=a[3].data},E=async()=>{const{valid:a}=await V.value.validate();a&&M()},R=a=>{r.value=v.value[a.day].indexOf(a),f.value=a._id,o.value=Object.assign({},a),p.value=!0},A=a=>{r.value=v.value[a.day].indexOf(a),o.value=Object.assign({},a),f.value=a._id,x.value=!0},K=async()=>{const{data:a}=await _.delete(`/table/${f.value}`);a&&(v.value[o.value.day].splice(r.value,1),w())},B=()=>{p.value=!1,J(()=>{var a;o.value=Object.assign({},I),f.value=-1,r.value=-1,(a=V.value)==null||a.reset()})},w=()=>{x.value=!1,J(()=>{var a;o.value=Object.assign({},I),f.value=-1,r.value=-1,(a=V.value)==null||a.reset()})},M=async()=>{var a;if(r.value>-1){const{data:t}=await _.put(`/table/${f.value}`,o.value);Object.assign(v.value[o.value.day][r.value],t)}else{const{data:t}=await _.post("/table",o.value);(a=v.value[o.value.day])==null||a.push(t)}B()};return Y(),(a,t)=>{const b=s("v-btn"),Q=s("v-sheet"),c=s("v-col"),j=s("v-card-title"),C=s("v-spacer"),W=s("v-data-table"),S=s("v-card-text"),O=s("v-card"),z=s("v-row"),k=s("v-select"),X=s("v-form"),$=s("v-container"),T=s("v-dialog"),Z=s("v-card-actions");return H(),le($,{fluid:""},{default:l(()=>[e(z,null,{default:l(()=>[e(c,{cols:"12"},{default:l(()=>[e(Q,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:l(()=>[d("div",ue,[e(b,{onClick:t[0]||(t[0]=n=>p.value=!0)},{default:l(()=>[h("Jadval yaratish")]),_:1})])]),_:1})]),_:1}),(H(),te(ne,null,oe(q,(n,ee)=>e(c,{key:ee,cols:"12"},{default:l(()=>[e(O,null,{default:l(()=>[e(j,null,{default:l(()=>[h(y(n),1)]),_:2},1024),e(S,null,{default:l(()=>[d("div",ie,[e(W,{"group-by":P,"no-data-text":"Hech narsa topilmadi",headers:N,items:v.value[n]},{"item.no":l(({item:i})=>[d("td",de,y(i.raw.index)+".",1)]),"item.subject":l(({item:i})=>[d("td",re,y(i.raw.subject),1)]),"item.teacher":l(({item:i})=>{var m;return[d("td",ce,y((m=i.raw.teacher)==null?void 0:m.name),1)]}),"item.group":l(({item:i})=>{var m;return[d("td",ve,y((m=i.raw.group)==null?void 0:m.name),1)]}),"item.actions":l(({item:i})=>[d("td",me,[e(C),d("div",_e,[e(b,{icon:"mdi-pencil",variant:"text",size:"40",color:"primary",onClick:m=>R(i.raw)},null,8,["onClick"]),e(b,{icon:"mdi-delete",variant:"text",size:"40",color:"primary",onClick:m=>A(i.raw)},null,8,["onClick"])])])]),_:2},1032,["items"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)),64))]),_:1}),e(T,{modelValue:p.value,"onUpdate:modelValue":t[6]||(t[6]=n=>p.value=n),"max-width":"550px"},{default:l(()=>[e(O,null,{default:l(()=>[e(j,{class:"mt-2 ml-2 mb-0"},{default:l(()=>[d("span",pe,y(se(L)),1)]),_:1}),e(S,{class:"px-2 pt-0"},{default:l(()=>[e($,null,{default:l(()=>[e(X,{ref_key:"form",ref:V},{default:l(()=>[e(z,null,{default:l(()=>[e(c,{cols:"12"},{default:l(()=>[e(k,{modelValue:o.value.day,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.day=n),label:"Hafta kuni",rules:g,"hide-details":"",items:q,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(k,{modelValue:o.value.index,"onUpdate:modelValue":t[2]||(t[2]=n=>o.value.index=n),label:"Dars soati",rules:g,"hide-details":"",items:[1,2,3,4,5,6,7,8,9,10,11],color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(k,{modelValue:o.value.subject,"onUpdate:modelValue":t[3]||(t[3]=n=>o.value.subject=n),label:"Fan nomi",rules:g,"hide-details":"",items:F.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(k,{modelValue:o.value.teacher,"onUpdate:modelValue":t[4]||(t[4]=n=>o.value.teacher=n),label:"O'qituvchi",rules:g,"hide-details":"",items:D.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(k,{modelValue:o.value.group,"onUpdate:modelValue":t[5]||(t[5]=n=>o.value.group=n),label:"Guruh",rules:g,"hide-details":"",items:U.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(b,{variant:"tonal",color:"primary",block:"",onClick:E,height:"45"},{default:l(()=>[h(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(T,{modelValue:x.value,"onUpdate:modelValue":t[7]||(t[7]=n=>x.value=n),"max-width":"500px"},{default:l(()=>[e(O,null,{default:l(()=>[e(j,{class:"text-h6"},{default:l(()=>[h(" Ushbu ma'lumotni ochirmoqchimisiz ")]),_:1}),e(Z,null,{default:l(()=>[e(C),e(b,{color:"blue-darken-1",variant:"text",onClick:w},{default:l(()=>[h(" Yo'q ")]),_:1}),e(b,{color:"blue-darken-1",variant:"text",onClick:K},{default:l(()=>[h(" Ha ")]),_:1}),e(C)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ye as default};
