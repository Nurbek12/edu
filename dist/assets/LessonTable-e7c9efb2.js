import{a as v}from"./index-7376b9a9.js";import{r as i,l as ae,m as le,a as s,o as V,c as te,w as a,b as e,f as k,h as C,i as B,F as D,d as u,t as f,e as oe,n as ne}from"./index-e60ab6e1.js";const se={class:"text-h6"},ue=u("thead",null,[u("tr",null,[u("th",{class:"text-left"},"Fan Nomi"),u("th",{class:"text-left"},"O'qituvchi"),u("th",{class:"text-left"},"Auditoriya"),u("th",{class:"text-left"})])],-1),de={class:"d-flex justify-end align-center"},ie={class:"text-h5"},me={__name:"LessonTable",setup(re){const O=["Dushanba","Seshanba","Chorshanba","Payshanba","Juma","Shanba"],m=[l=>!!l||"Required"];i("");const j=i(null),r=i({Dushanba:[],Seshanba:[],Chorshanba:[],Payshanba:[],Juma:[],Shanba:[]}),U=i([]),z=i([]),I=i([]),_=i(!1),c=i(-1),b=i(-1),t=i({group:null,teacher:null,subject:null,day:null,index:null,room:""}),N={teacher:null,subject:null,day:null,index:null,room:""},J=ae(()=>c.value===-1?"Fan Yaratish":"Fanni O'zgartirish");le(_,l=>l||h());const P=async()=>{const l=await Promise.all([v.get("/user/teacher"),v.get("/group"),v.get("/subject")]);U.value=l[0].data,z.value=l[1].data,I.value=l[2].data},A=async()=>{const{data:l}=await v.get(`/table?group=${t.value.group}`);r.value=Object.assign({},l)},L=async()=>{const{valid:l}=await j.value.validate();l&&R()},E=l=>{c.value=r.value[l.day].indexOf(l),b.value=l._id,t.value=Object.assign({},l),_.value=!0},G=l=>{c.value=r.value[l.day].indexOf(l),t.value=Object.assign({},l),b.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?H():h()},H=async()=>{const{data:l}=await v.delete(`/table/${b.value}`);l&&(r.value[t.value.day].splice(c.value,1),h())},h=()=>{_.value=!1,ne(()=>{var l;t.value=Object.assign({},{...N,group:t.value.group}),b.value=-1,c.value=-1,(l=j.value)==null||l.reset()})},R=async()=>{if(c.value>-1){const{data:l}=await v.put(`/table/${b.value}`,t.value);Object.assign(r.value[t.value.day][c.value],l)}else{const{data:l}=await v.post("/table",t.value);r.value[t.value.day]?r.value[t.value.day].push(l):r.value[t.value.day]=[l]}h()};return P(),(l,n)=>{const y=s("v-select"),d=s("v-col"),g=s("v-btn"),x=s("v-row"),F=s("v-sheet"),w=s("v-card-text"),S=s("v-icon"),Y=s("v-table"),$=s("v-card"),K=s("v-card-title"),M=s("v-text-field"),Q=s("v-form"),q=s("v-container"),W=s("v-dialog");return V(),te(q,{fluid:""},{default:a(()=>[e(x,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(F,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:a(()=>[e(x,{justify:"space-between",align:"center"},{default:a(()=>[e(d,{cols:"12",class:"py-1",sm:"4"},{default:a(()=>[e(y,{modelValue:t.value.group,"onUpdate:modelValue":[n[0]||(n[0]=o=>t.value.group=o),A],label:"Guruhni tanlang",rules:m,"hide-details":"",items:z.value,density:"compact",color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",class:"py-1",sm:"4",md:"3"},{default:a(()=>[e(g,{block:"",color:"primary",disabled:!t.value.group,onClick:n[1]||(n[1]=o=>_.value=!0),variant:"flat",height:"42"},{default:a(()=>[k("Jadval yaratish")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(x,null,{default:a(()=>[(V(),C(D,null,B(O,(o,X)=>e(d,{key:X,cols:"12",sm:"6"},{default:a(()=>[e($,null,{default:a(()=>[e(w,{class:"pa-0"},{default:a(()=>[e(F,{color:"surface",class:"px-4 py-2"},{default:a(()=>[u("span",se,f(o),1)]),_:2},1024)]),_:2},1024),e(w,{class:"px-0 pt-0"},{default:a(()=>[e(Y,{density:"compact"},{default:a(()=>[ue,u("tbody",null,[(V(!0),C(D,null,B(r.value[o]||[],(p,Z)=>{var T;return V(),C("tr",{key:Z},[u("td",null,f(p.index)+". "+f(p.subject),1),u("td",null,f((T=p.teacher)==null?void 0:T.name),1),u("td",null,f(p.room),1),u("td",null,[u("div",de,[e(g,{size:"30",elevation:"0",color:"primary",onClick:ee=>E(p)},{default:a(()=>[e(S,{size:"small"},{default:a(()=>[k("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(g,{size:"30",elevation:"0",color:"primary",class:"ml-1",onClick:ee=>G(p)},{default:a(()=>[e(S,{size:"small"},{default:a(()=>[k("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])])}),128))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)),64))]),_:1}),e(W,{modelValue:_.value,"onUpdate:modelValue":n[7]||(n[7]=o=>_.value=o),"max-width":"550px"},{default:a(()=>[e($,null,{default:a(()=>[e(K,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[u("span",ie,f(oe(J)),1)]),_:1}),e(w,{class:"px-2 pt-0"},{default:a(()=>[e(q,null,{default:a(()=>[e(Q,{ref_key:"form",ref:j},{default:a(()=>[e(x,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(y,{modelValue:t.value.day,"onUpdate:modelValue":n[2]||(n[2]=o=>t.value.day=o),label:"Hafta kuni",rules:m,"hide-details":"",items:O,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(y,{modelValue:t.value.index,"onUpdate:modelValue":n[3]||(n[3]=o=>t.value.index=o),label:"Dars soati",rules:m,"hide-details":"",items:[1,2,3,4,5,6,7,8,9,10,11],color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(y,{modelValue:t.value.subject,"onUpdate:modelValue":n[4]||(n[4]=o=>t.value.subject=o),label:"Fan nomi",rules:m,"hide-details":"",items:I.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(y,{modelValue:t.value.teacher,"onUpdate:modelValue":n[5]||(n[5]=o=>t.value.teacher=o),label:"O'qituvchi",rules:m,"hide-details":"",items:U.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(M,{modelValue:t.value.room,"onUpdate:modelValue":n[6]||(n[6]=o=>t.value.room=o),label:"Auditoriya",rules:m,"hide-details":"",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(g,{variant:"flat",color:"primary",block:"",onClick:L,height:"45"},{default:a(()=>[k(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{me as default};
