import{r as d,a as o,o as O,c as S,w as e,b as t,f as p,d as n,t as i,h as g,l as Ve,m as J,e as ge,i as se,j as oe,F as ne,k as ie,n as K}from"./index-439559a6.js";const we={class:"responsive-datatable"},ke={"data-label":"Ism familiyasi"},Ue={"data-label":"Bahosi"},Ce={"data-label":"Boshlangan"},$e={"data-label":"Tugatgan"},je={"data-label":"Boshqarish"},Te={__name:"RePossibleStudents",props:{groups:{type:Array},testid:{type:String},testname:{type:String}},setup(W){const N=W,r=[{title:"Ism familiyasi",key:"name"},{title:"Bahosi",key:"rate"},{title:"Boshlangan",key:"start_time"},{title:"Tugatgan",key:"end_time"},{title:"Boshqarish",key:"actions"}],B=d([]),j=d(null),Q=d(""),U=async()=>{const{data:w}=await g.get(`/user/student/repossible/${j.value}/${N.testid}`);B.value=w},T=async(w,C,$)=>{const{data:b}=await g.delete(`/test/result/${w}?writeaction=${$}&testname=${N.testname}`);b&&(B.value[C].rates=null)};return(w,C)=>{const $=o("v-select"),b=o("v-col"),x=o("v-icon"),I=o("v-btn"),A=o("v-row"),f=o("v-sheet"),z=o("v-card-title"),c=o("v-data-table"),u=o("v-card-text"),H=o("v-card");return O(),S(H,null,{default:e(()=>[t(z,{class:"text-h6 d-flex justify-space-between align-center"},{default:e(()=>[t(f,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[t(A,{justify:"space-between"},{default:e(()=>[t(b,{class:"py-1",cols:"10",sm:"4"},{default:e(()=>[t($,{modelValue:j.value,"onUpdate:modelValue":[C[0]||(C[0]=m=>j.value=m),U],label:"Guruhi",density:"compact","hide-details":"",items:N.groups,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(b,{class:"py-1 d-flex justify-end align-center",cols:"2",sm:"4",md:"3"},{default:e(()=>[t(I,{size:"30",color:"primary",onClick:C[1]||(C[1]=m=>w.$emit("close-view"))},{default:e(()=>[t(x,{size:"small"},{default:e(()=>[p("mdi-close")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(u,{class:"px-2"},{default:e(()=>[n("div",we,[t(c,{"no-data-text":"Hech narsa topilmadi","items-per-page-text":"","items-per-page":"-1",headers:r,search:Q.value,items:B.value},{"item.name":e(({index:m,item:v})=>[n("td",ke,i(m+1)+". "+i(v.raw.name),1)]),bottom:e(()=>[]),"item.rate":e(({item:m})=>{var v,D;return[n("td",Ue,i(((v=m.raw.rates)==null?void 0:v.rate)||0)+"/"+i(((D=m.raw.rates)==null?void 0:D.questions)||0),1)]}),"item.start_time":e(({item:m})=>{var v;return[n("td",Ce,i((v=m.raw.rates)!=null&&v.start_time?new Date(parseInt(m.raw.rates.start_time)).toLocaleString():"00.00.0000, 00:00:00"),1)]}),"item.end_time":e(({item:m})=>{var v;return[n("td",$e,i((v=m.raw.rates)!=null&&v.start_time?new Date(parseInt(m.raw.rates.start_time)).toLocaleString():"00.00.0000, 00:00:00"),1)]}),"item.actions":e(({index:m,item:v})=>[n("td",je,[t(I,{variant:"flat",onClick:D=>T(v.raw.rates._id,m,v.raw.name),color:"primary",disabled:!v.raw.rates},{default:e(()=>[p("Imkoniyat berish")]),_:2},1032,["onClick","disabled"])])]),_:1},8,["search","items"])])]),_:1})]),_:1})}}},ze={class:"responsive-datatable"},Oe={"data-label":"T/r"},Be={"data-label":"Test Nomi"},Ie={"data-label":"Fan"},qe={"data-label":"Sanasi"},Se={"data-label":"Muhlari"},Ne={"data-label":"Guruh"},Qe={"data-label":"Testlar soni"},De={"data-label":"Boshqarish"},Fe={class:"d-flex justify-end"},Ge=n("div",null,"Hech narsa topilmadi",-1),Ae={class:"text-h5"},He={class:"text-h5"},Le={class:"text-subtitle-2"},Re={__name:"Midterm",setup(W){const N=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test Nomi",key:"name"},{title:"Fan",key:"subject",sortable:!1},{title:"Guruh",key:"group",sortable:!1},{title:"Sanasi",key:"date",sortable:!1},{title:"Muhlati",key:"time",sortable:!1},{title:"Testlar soni",key:"count",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],r=[l=>!!l||"Required"],B=d(null),j=d(null),Q=d(""),U=d([]),T=d(!1),w=d(!1),C=d(""),$=d(!1),b=d(-1),x=d(-1),I=d([]),A=d([]),f=d([]),z=d(null),c=d({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),u=d({name:"",groups:[],subject:null,count:0,time:0,date:""}),H={name:"",groups:[],subject:null,count:0,time:0,date:""},m=Ve(()=>b.value===-1?"Oraliq Yaratish":"Oraliq O'zgartirish");J(T,l=>l||L()),J($,l=>l||X()),J(w,l=>l||pe());const v=async()=>{const[l,s,y]=await Promise.all([g.get("/group/access"),g.get("/subject/access"),g.get("/midterm")]);U.value=y.data,I.value=l.data,A.value=s.data},D=async()=>{const{valid:l}=await B.value.validate();l&&fe()},ue=async(l,s)=>{$.value=!0,C.value=s,x.value=l},de=async()=>{const{valid:l}=await j.value.validate();l&&be()},re=l=>{b.value=U.value.indexOf(l),x.value=l._id,u.value=Object.assign({},l),T.value=!0},ce=async l=>{if(!l.questions){const{data:s}=await g.get(`/midterm/id/${l._id}`);l.questions=s.questions}b.value=U.value.indexOf(l),x.value=l._id,f.value=l.questions,w.value=!0},me=(l,s)=>{z.value=s,c.value=Object.assign({},l)},ve=l=>{b.value=U.value.indexOf(l),u.value=Object.assign({},l),x.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?_e():L()},_e=async()=>{const{data:l}=await g.delete(`/midterm/${x.value}`);l&&(U.value.splice(b.value,1),L())},L=()=>{T.value=!1,K(()=>{var l,s;u.value=Object.assign({},H),x.value=-1,b.value=-1,(l=B.value)==null||l.reset(),(s=j.value)==null||s.reset()})},X=()=>{$.value=!1,C.value="",x.value=-1},pe=()=>{w.value=!1,K(()=>{u.value=Object.assign({},H),x.value=-1,f.value=[],b.value=-1,z.value=null,c.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]})})},fe=async()=>{if(b.value>-1){const{data:l}=await g.put(`/midterm/${x.value}`,u.value);Object.assign(U.value[b.value],l)}else{const{data:l}=await g.post("/midterm",{questions:f.value,...u.value});U.value.push(l)}L()},ye=()=>{f.value.push({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),K(()=>{document.querySelector(".test-scroll").scrollTop=document.querySelector(".test-scroll").scrollHeight})},Z=async l=>{confirm("Ushbu malumotni o'chirmoqchimisiz?")&&(f.value[l]._id&&await g.delete(`/test/question/${f.value[l]._id}`),f.value.splice(l,1))},be=async()=>{var l;if(z.value!==null){delete c.value._id;const{data:s}=await g.put(`/test/question/${f.value[z.value]._id}`,c.value);Object.assign(f.value[z.value],s)}else{const{data:s}=await g.post("/test/question",{midterm:x.value,...c.value});f.value.push(s)}z.value=null,c.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),(l=j.value)==null||l.reset()};return v(),(l,s)=>{const y=o("v-text-field"),_=o("v-col"),k=o("v-btn"),F=o("v-row"),ee=o("v-sheet"),P=o("v-select"),q=o("v-icon"),xe=o("v-data-table"),te=o("v-card-title"),ae=o("v-textarea"),M=o("v-card-text"),R=o("v-card"),le=o("v-form"),E=o("v-container"),Y=o("v-dialog"),G=o("v-banner-text"),he=o("v-banner");return O(),S(E,{fluid:""},{default:e(()=>[t(F,null,{default:e(()=>[t(_,{cols:"12"},{default:e(()=>[t(ee,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[t(F,{justify:"space-between"},{default:e(()=>[t(_,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[t(y,{label:"Qidirish",modelValue:Q.value,"onUpdate:modelValue":s[0]||(s[0]=a=>Q.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(_,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[t(k,{block:"",height:"42",color:"primary",onClick:s[1]||(s[1]=a=>T.value=!0),variant:"flat"},{default:e(()=>[p("Test yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{cols:"12"},{default:e(()=>[t(ee,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[n("div",ze,[t(xe,{"items-per-page-text":"",headers:N,search:Q.value,items:U.value},{"item.no":e(({index:a})=>[n("td",Oe,i(a+1)+".",1)]),"item.name":e(({item:a})=>[n("td",Be,i(a.raw.name),1)]),"item.subject":e(({item:a})=>[n("td",Ie,i(a.raw.subject),1)]),"item.date":e(({item:a})=>[n("td",qe,i(a.raw.date),1)]),"item.time":e(({item:a})=>[n("td",Se,i(a.raw.time),1)]),"item.group":e(({item:a})=>[n("td",Ne,[t(P,{items:I.value,readonly:"",chips:"",multiple:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:a.raw.groups,"onUpdate:modelValue":h=>a.raw.groups=h},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.count":e(({item:a})=>[n("td",Qe,i(a.raw.count),1)]),"item.actions":e(({item:a})=>[n("td",De,[n("div",Fe,[t(k,{variant:"flat",size:"30",color:"primary",onClick:h=>re(a.raw)},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",size:"30",onClick:h=>ce(a.raw),color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-sitemap")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:h=>ve(a.raw)},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-delete")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",onClick:h=>ue(a.raw._id,a.raw.name),size:"30",color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-calendar-refresh")]),_:1})]),_:2},1032,["onClick"])])])]),"no-data":e(()=>[Ge]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t(Y,{modelValue:T.value,"onUpdate:modelValue":s[8]||(s[8]=a=>T.value=a),"max-width":"550px"},{default:e(()=>[t(R,{class:"test-scroll"},{default:e(()=>[t(te,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[n("span",Ae,i(ge(m)),1)]),_:1}),t(M,{class:"px-2 pt-0"},{default:e(()=>[t(E,null,{default:e(()=>[t(le,{ref_key:"form",ref:B},{default:e(()=>[t(F,null,{default:e(()=>[t(_,{cols:"12"},{default:e(()=>[t(y,{modelValue:u.value.name,"onUpdate:modelValue":s[2]||(s[2]=a=>u.value.name=a),label:"Test Nomi","hide-details":"",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(_,{cols:"12",sm:"6"},{default:e(()=>[t(y,{modelValue:u.value.time,"onUpdate:modelValue":s[3]||(s[3]=a=>u.value.time=a),label:"Testga beriladigan vaqt","hide-details":"",rules:r,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(_,{cols:"12",sm:"6"},{default:e(()=>[t(y,{modelValue:u.value.count,"onUpdate:modelValue":s[4]||(s[4]=a=>u.value.count=a),label:"Testlar soni","hide-details":"",rules:r,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(_,{cols:"12",sm:"6"},{default:e(()=>[t(y,{modelValue:u.value.date,"onUpdate:modelValue":s[5]||(s[5]=a=>u.value.date=a),label:"Test vaqti",type:"date","hide-details":"",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(_,{cols:"12",sm:"6"},{default:e(()=>[t(P,{modelValue:u.value.subject,"onUpdate:modelValue":s[6]||(s[6]=a=>u.value.subject=a),label:"Fan",rules:r,"hide-details":"",items:A.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(_,{cols:"12"},{default:e(()=>[t(P,{modelValue:u.value.groups,"onUpdate:modelValue":s[7]||(s[7]=a=>u.value.groups=a),label:"Guruhi","hide-details":"",multiple:"",items:I.value,chips:"",color:"primary",rules:r,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(_,{cols:"12",class:"px-3"},{default:e(()=>[t(F,null,{default:e(()=>[(O(!0),se(ne,null,oe(f.value,(a,h)=>(O(),S(_,{cols:"12"},{default:e(()=>[t(R,{variant:"outlined",class:"pa-2"},{default:e(()=>[t(ae,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",variant:"outlined",rows:"3",rules:r,modelValue:a.text,"onUpdate:modelValue":V=>a.text=V},{"prepend-inner":e(()=>[n("div",null,i(h+1)+".",1)]),"append-inner":e(()=>[n("div",null,[t(k,{size:"x-small",variant:"text",icon:"mdi-close",color:"red",onClick:V=>Z(h)},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(M,{class:"pa-0"},{default:e(()=>[t(y,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",density:"compact",rules:r,label:"A variant (to'gri javob)",modelValue:a.variants[0].text,"onUpdate:modelValue":V=>a.variants[0].text=V},null,8,["modelValue","onUpdate:modelValue"]),t(y,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:r,density:"compact",label:"B variant",modelValue:a.variants[1].text,"onUpdate:modelValue":V=>a.variants[1].text=V},null,8,["modelValue","onUpdate:modelValue"]),t(y,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:r,density:"compact",label:"C variant",modelValue:a.variants[2].text,"onUpdate:modelValue":V=>a.variants[2].text=V},null,8,["modelValue","onUpdate:modelValue"]),t(y,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",density:"compact",label:"D variant",modelValue:a.variants[3].text,"onUpdate:modelValue":V=>a.variants[3].text=V},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),x.value===-1?(O(),S(_,{key:0,cols:"12"},{default:e(()=>[t(k,{variant:"flat",color:"primary",block:"",onClick:ye,height:"45"},{default:e(()=>[p(" Savol Qo'shish ")]),_:1})]),_:1})):ie("",!0)]),_:1})]),_:1}),t(_,{cols:"12"},{default:e(()=>[t(k,{variant:"flat",color:"primary",block:"",onClick:D,height:"45"},{default:e(()=>[p(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Y,{modelValue:w.value,"onUpdate:modelValue":s[14]||(s[14]=a=>w.value=a),"max-width":"550px"},{default:e(()=>[t(R,{class:"test-scroll"},{default:e(()=>[t(te,{class:"mt-2 ml-2 mb-0"},{default:e(()=>{var a;return[n("span",He,"Testlar ("+i((a=f.value)==null?void 0:a.length)+")",1)]}),_:1}),t(M,{class:"px-2 pt-0"},{default:e(()=>[t(E,null,{default:e(()=>[t(le,{ref_key:"form1",ref:j},{default:e(()=>[t(F,null,{default:e(()=>[t(_,{cols:"12"},{default:e(()=>[t(R,{variant:"tonal",class:"pa-2"},{default:e(()=>[t(ae,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",rules:r,variant:"outlined",rows:"3",modelValue:c.value.text,"onUpdate:modelValue":s[9]||(s[9]=a=>c.value.text=a)},{"append-inner":e(()=>[t(k,{size:"30",variant:"flat",onClick:de,color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-text-box-plus")]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(M,{class:"pa-0"},{default:e(()=>[t(y,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[0].text,"onUpdate:modelValue":s[10]||(s[10]=a=>c.value.variants[0].text=a),density:"compact",label:"A variant (to'gri javob)"},null,8,["modelValue"]),t(y,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[1].text,"onUpdate:modelValue":s[11]||(s[11]=a=>c.value.variants[1].text=a),density:"compact",label:"B variant"},null,8,["modelValue"]),t(y,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[2].text,"onUpdate:modelValue":s[12]||(s[12]=a=>c.value.variants[2].text=a),density:"compact",label:"C variant"},null,8,["modelValue"]),t(y,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[3].text,"onUpdate:modelValue":s[13]||(s[13]=a=>c.value.variants[3].text=a),density:"compact",label:"D variant"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(_,{cols:"12"},{default:e(()=>[(O(!0),se(ne,null,oe(f.value,(a,h)=>(O(),S(he,{lines:"three",class:"my-1",key:h},{actions:e(()=>[t(k,{variant:"flat",size:"30",onClick:V=>me(a,h),color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",size:"30",onClick:V=>Z(h),color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[p("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),default:e(()=>[t(G,null,{default:e(()=>[n("span",Le,i(h+1)+". "+i(a.text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[p("a) "+i(a.variants[0].text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[p("b) "+i(a.variants[1].text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[p("c) "+i(a.variants[2].text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[p("d) "+i(a.variants[3].text),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Y,{modelValue:$.value,"onUpdate:modelValue":s[15]||(s[15]=a=>$.value=a)},{default:e(()=>[$.value?(O(),S(Te,{key:0,onCloseView:X,groups:I.value,testid:x.value,testname:C.value},null,8,["groups","testid","testname"])):ie("",!0)]),_:1},8,["modelValue"])]),_:1})}}};export{Re as default};
