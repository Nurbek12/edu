import{r as d,a as o,o as j,c as S,w as e,b as t,f as _,d as i,t as n,h as g,l as we,m as Y,i as J,j as K,F as W,e as ke,k as ie,n as X}from"./index-eee0caed.js";const Ce={class:"responsive-datatable"},Ue={"data-label":"Ism familiyasi"},$e={"data-label":"Bahosi"},je={"data-label":"Boshlangan"},Te={"data-label":"Tugatgan"},ze={"data-label":"Boshqarish"},Oe={__name:"RePossibleStudents",props:{groups:{type:Array},testid:{type:String},testname:{type:String}},setup(Z){const N=Z,r=[{title:"Ism familiyasi",key:"name"},{title:"Bahosi",key:"rate"},{title:"Boshlangan",key:"start_time"},{title:"Tugatgan",key:"end_time"},{title:"Boshqarish",key:"actions"}],B=d([]),T=d(null),Q=d(""),C=async()=>{const{data:w}=await g.get(`/user/student/repossible/${T.value}/${N.testid}`);B.value=w},z=async(w,U,$)=>{const{data:x}=await g.delete(`/test/result/${w}?writeaction=${$}&testname=${N.testname}`);x&&(B.value[U].rates=null)};return(w,U)=>{const $=o("v-select"),x=o("v-col"),h=o("v-icon"),I=o("v-btn"),A=o("v-row"),y=o("v-sheet"),O=o("v-card-title"),c=o("v-data-table"),u=o("v-card-text"),H=o("v-card");return j(),S(H,null,{default:e(()=>[t(O,{class:"text-h6 d-flex justify-space-between align-center"},{default:e(()=>[t(y,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[t(A,{justify:"space-between"},{default:e(()=>[t(x,{class:"py-1",cols:"10",sm:"4"},{default:e(()=>[t($,{modelValue:T.value,"onUpdate:modelValue":[U[0]||(U[0]=m=>T.value=m),C],label:"Guruhi",density:"compact","hide-details":"",items:N.groups,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(x,{class:"py-1 d-flex justify-end align-center",cols:"2",sm:"4",md:"3"},{default:e(()=>[t(I,{size:"30",color:"primary",onClick:U[1]||(U[1]=m=>w.$emit("close-view"))},{default:e(()=>[t(h,{size:"small"},{default:e(()=>[_("mdi-close")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(u,{class:"px-2"},{default:e(()=>[i("div",Ce,[t(c,{"no-data-text":"Hech narsa topilmadi","items-per-page-text":"","items-per-page":"-1",headers:r,search:Q.value,items:B.value},{"item.name":e(({index:m,item:p})=>[i("td",Ue,n(m+1)+". "+n(p.raw.name),1)]),bottom:e(()=>[]),"item.rate":e(({item:m})=>{var p,D;return[i("td",$e,n(((p=m.raw.rates)==null?void 0:p.rate)||0)+"/"+n(((D=m.raw.rates)==null?void 0:D.questions)||0),1)]}),"item.start_time":e(({item:m})=>{var p;return[i("td",je,n((p=m.raw.rates)!=null&&p.start_time?new Date(parseInt(m.raw.rates.start_time)).toLocaleString():"00.00.0000, 00:00:00"),1)]}),"item.end_time":e(({item:m})=>{var p;return[i("td",Te,n((p=m.raw.rates)!=null&&p.start_time?new Date(parseInt(m.raw.rates.start_time)).toLocaleString():"00.00.0000, 00:00:00"),1)]}),"item.actions":e(({index:m,item:p})=>[i("td",ze,[t(I,{variant:"flat",onClick:D=>z(p.raw.rates._id,m,p.raw.name),color:"primary",disabled:!p.raw.rates},{default:e(()=>[_("Imkoniyat berish")]),_:2},1032,["onClick","disabled"])])]),_:1},8,["search","items"])])]),_:1})]),_:1})}}},Be={class:"responsive-datatable"},Ie={"data-label":"Test Nomi"},qe={"data-label":"Fan"},Se={"data-label":"Sanasi"},Ne={"data-label":"Muhlari"},Qe={"data-label":"Guruh"},De={style:{display:"flex",gap:"5px"}},Fe={"data-label":"Testlar soni"},Ge={"data-label":"Boshqarish"},Ae={class:"d-flex justify-end"},He={class:"text-h5"},Le={class:"text-h5"},Me={class:"text-subtitle-2"},Pe={__name:"Midterm",setup(Z){const N=[{title:"Test Nomi",key:"name"},{title:"Fan",key:"subject",sortable:!1},{title:"Guruh",key:"group",sortable:!1},{title:"Sanasi",key:"date",sortable:!1},{title:"Muhlati",key:"time",sortable:!1},{title:"Testlar soni",key:"count",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],r=[l=>!!l||"Required"],B=d(null),T=d(null),Q=d(""),C=d([]),z=d(!1),w=d(!1),U=d(""),$=d(!1),x=d(-1),h=d(-1),I=d([]),A=d([]),y=d([]),O=d(null),c=d({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),u=d({name:"",groups:[],subject:null,count:0,time:0,date:""}),H={name:"",groups:[],subject:null,count:0,time:0,date:""},m=we(()=>x.value===-1?"Oraliq Yaratish":"Oraliq O'zgartirish");Y(z,l=>l||L()),Y($,l=>l||ee()),Y(w,l=>l||pe());const p=async()=>{const[l,s,v]=await Promise.all([g.get("/group/access"),g.get("/subject/access"),g.get("/midterm")]);C.value=v.data,I.value=l.data,A.value=s.data},D=async()=>{const{valid:l}=await B.value.validate();l&&fe()},ue=async(l,s)=>{$.value=!0,U.value=s,h.value=l},de=async()=>{const{valid:l}=await T.value.validate();l&&be()},re=l=>{x.value=C.value.indexOf(l),h.value=l._id,u.value=Object.assign({},l),z.value=!0},ce=async l=>{if(!l.questions){const{data:s}=await g.get(`/midterm/id/${l._id}`);l.questions=s.questions}x.value=C.value.indexOf(l),h.value=l._id,y.value=l.questions,w.value=!0},me=(l,s)=>{O.value=s,c.value=Object.assign({},l)},ve=l=>{x.value=C.value.indexOf(l),u.value=Object.assign({},l),h.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?_e():L()},_e=async()=>{const{data:l}=await g.delete(`/midterm/${h.value}`);l&&(C.value.splice(x.value,1),L())},L=()=>{z.value=!1,X(()=>{var l,s;u.value=Object.assign({},H),h.value=-1,x.value=-1,(l=B.value)==null||l.reset(),(s=T.value)==null||s.reset()})},ee=()=>{$.value=!1,U.value="",h.value=-1},pe=()=>{w.value=!1,X(()=>{u.value=Object.assign({},H),h.value=-1,y.value=[],x.value=-1,O.value=null,c.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]})})},fe=async()=>{if(x.value>-1){const{data:l}=await g.put(`/midterm/${h.value}`,u.value);Object.assign(C.value[x.value],l)}else{const{data:l}=await g.post("/midterm",{questions:y.value,...u.value});C.value.push(l)}L()},ye=()=>{y.value.push({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),X(()=>{document.querySelector(".test-scroll").scrollTop=document.querySelector(".test-scroll").scrollHeight})},te=async l=>{confirm("Ushbu malumotni o'chirmoqchimisiz?")&&(y.value[l]._id&&await g.delete(`/test/question/${y.value[l]._id}`),y.value.splice(l,1))},be=async()=>{var l;if(O.value!==null){delete c.value._id;const{data:s}=await g.put(`/test/question/${y.value[O.value]._id}`,c.value);Object.assign(y.value[O.value],s)}else{const{data:s}=await g.post("/test/question",{midterm:h.value,...c.value});y.value.push(s)}O.value=null,c.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),(l=T.value)==null||l.reset()},xe=l=>l.map(s=>I.value.find(({_id:v})=>v===s).name);return p(),(l,s)=>{const v=o("v-text-field"),f=o("v-col"),k=o("v-btn"),F=o("v-row"),ae=o("v-sheet"),he=o("v-chip"),q=o("v-icon"),Ve=o("v-data-table"),le=o("v-card-title"),se=o("v-select"),oe=o("v-textarea"),M=o("v-card-text"),R=o("v-card"),ne=o("v-form"),P=o("v-container"),E=o("v-dialog"),G=o("v-banner-text"),ge=o("v-banner");return j(),S(P,{fluid:""},{default:e(()=>[t(F,null,{default:e(()=>[t(f,{cols:"12"},{default:e(()=>[t(ae,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[t(F,{justify:"space-between"},{default:e(()=>[t(f,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[t(v,{label:"Qidirish",modelValue:Q.value,"onUpdate:modelValue":s[0]||(s[0]=a=>Q.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(f,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[t(k,{block:"",height:"42",color:"primary",onClick:s[1]||(s[1]=a=>z.value=!0),variant:"flat"},{default:e(()=>[_("Test yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(f,{cols:"12"},{default:e(()=>[t(ae,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[i("div",Be,[t(Ve,{"no-data-text":"Hech narsa topilmadi","items-per-page-text":"",headers:N,search:Q.value,items:C.value},{"item.name":e(({index:a,item:b})=>[i("td",Ie,n(a+1)+". "+n(b.raw.name),1)]),"item.subject":e(({item:a})=>[i("td",qe,n(a.raw.subject),1)]),"item.date":e(({item:a})=>[i("td",Se,n(a.raw.date),1)]),"item.time":e(({item:a})=>[i("td",Ne,n(a.raw.time),1)]),"item.group":e(({item:a})=>[i("td",Qe,[i("div",De,[(j(!0),J(W,null,K(xe(a.raw.groups),(b,V)=>(j(),S(he,{label:"",color:"primary",size:"small",key:V},{default:e(()=>[_(n(b),1)]),_:2},1024))),128))])])]),"item.count":e(({item:a})=>[i("td",Fe,n(a.raw.count),1)]),"item.actions":e(({item:a})=>[i("td",Ge,[i("div",Ae,[t(k,{variant:"flat",size:"30",color:"primary",onClick:b=>re(a.raw)},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",size:"30",onClick:b=>ce(a.raw),color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-sitemap")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:b=>ve(a.raw)},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-delete")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",onClick:b=>ue(a.raw._id,a.raw.name),size:"30",color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-calendar-refresh")]),_:1})]),_:2},1032,["onClick"])])])]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t(E,{modelValue:z.value,"onUpdate:modelValue":s[8]||(s[8]=a=>z.value=a),"max-width":"550px"},{default:e(()=>[t(R,{class:"test-scroll"},{default:e(()=>[t(le,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[i("span",He,n(ke(m)),1)]),_:1}),t(M,{class:"px-2 pt-0"},{default:e(()=>[t(P,null,{default:e(()=>[t(ne,{ref_key:"form",ref:B},{default:e(()=>[t(F,null,{default:e(()=>[t(f,{cols:"12"},{default:e(()=>[t(v,{modelValue:u.value.name,"onUpdate:modelValue":s[2]||(s[2]=a=>u.value.name=a),label:"Test Nomi","hide-details":"",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:e(()=>[t(v,{modelValue:u.value.time,"onUpdate:modelValue":s[3]||(s[3]=a=>u.value.time=a),label:"Testga beriladigan vaqt","hide-details":"",rules:r,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:e(()=>[t(v,{modelValue:u.value.count,"onUpdate:modelValue":s[4]||(s[4]=a=>u.value.count=a),label:"Testlar soni","hide-details":"",rules:r,type:"number",min:"0",color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:e(()=>[t(v,{modelValue:u.value.date,"onUpdate:modelValue":s[5]||(s[5]=a=>u.value.date=a),label:"Test vaqti",type:"date","hide-details":"",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:e(()=>[t(se,{modelValue:u.value.subject,"onUpdate:modelValue":s[6]||(s[6]=a=>u.value.subject=a),label:"Fan",rules:r,"hide-details":"",items:A.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(f,{cols:"12"},{default:e(()=>[t(se,{modelValue:u.value.groups,"onUpdate:modelValue":s[7]||(s[7]=a=>u.value.groups=a),label:"Guruhi","hide-details":"",multiple:"",items:I.value,chips:"",color:"primary",rules:r,"item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(f,{cols:"12",class:"px-3"},{default:e(()=>[t(F,null,{default:e(()=>[(j(!0),J(W,null,K(y.value,(a,b)=>(j(),S(f,{cols:"12"},{default:e(()=>[t(R,{variant:"outlined",class:"pa-2"},{default:e(()=>[t(oe,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",variant:"outlined",rows:"3",rules:r,modelValue:a.text,"onUpdate:modelValue":V=>a.text=V},{"prepend-inner":e(()=>[i("div",null,n(b+1)+".",1)]),"append-inner":e(()=>[i("div",null,[t(k,{size:"x-small",variant:"text",icon:"mdi-close",color:"red",onClick:V=>te(b)},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(M,{class:"pa-0"},{default:e(()=>[t(v,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",density:"compact",rules:r,label:"A variant (to'gri javob)",modelValue:a.variants[0].text,"onUpdate:modelValue":V=>a.variants[0].text=V},null,8,["modelValue","onUpdate:modelValue"]),t(v,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:r,density:"compact",label:"B variant",modelValue:a.variants[1].text,"onUpdate:modelValue":V=>a.variants[1].text=V},null,8,["modelValue","onUpdate:modelValue"]),t(v,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:r,density:"compact",label:"C variant",modelValue:a.variants[2].text,"onUpdate:modelValue":V=>a.variants[2].text=V},null,8,["modelValue","onUpdate:modelValue"]),t(v,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",density:"compact",label:"D variant",modelValue:a.variants[3].text,"onUpdate:modelValue":V=>a.variants[3].text=V},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),h.value===-1?(j(),S(f,{key:0,cols:"12"},{default:e(()=>[t(k,{variant:"flat",color:"primary",block:"",onClick:ye,height:"45"},{default:e(()=>[_(" Savol Qo'shish ")]),_:1})]),_:1})):ie("",!0)]),_:1})]),_:1}),t(f,{cols:"12"},{default:e(()=>[t(k,{variant:"flat",color:"primary",block:"",onClick:D,height:"45"},{default:e(()=>[_(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(E,{modelValue:w.value,"onUpdate:modelValue":s[14]||(s[14]=a=>w.value=a),"max-width":"550px"},{default:e(()=>[t(R,{class:"test-scroll"},{default:e(()=>[t(le,{class:"mt-2 ml-2 mb-0"},{default:e(()=>{var a;return[i("span",Le,"Testlar ("+n((a=y.value)==null?void 0:a.length)+")",1)]}),_:1}),t(M,{class:"px-2 pt-0"},{default:e(()=>[t(P,null,{default:e(()=>[t(ne,{ref_key:"form1",ref:T},{default:e(()=>[t(F,null,{default:e(()=>[t(f,{cols:"12"},{default:e(()=>[t(R,{variant:"tonal",class:"pa-2"},{default:e(()=>[t(oe,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",rules:r,variant:"outlined",rows:"3",modelValue:c.value.text,"onUpdate:modelValue":s[9]||(s[9]=a=>c.value.text=a)},{"append-inner":e(()=>[t(k,{size:"30",variant:"flat",onClick:de,color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-text-box-plus")]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(M,{class:"pa-0"},{default:e(()=>[t(v,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[0].text,"onUpdate:modelValue":s[10]||(s[10]=a=>c.value.variants[0].text=a),density:"compact",label:"A variant (to'gri javob)"},null,8,["modelValue"]),t(v,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[1].text,"onUpdate:modelValue":s[11]||(s[11]=a=>c.value.variants[1].text=a),density:"compact",label:"B variant"},null,8,["modelValue"]),t(v,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[2].text,"onUpdate:modelValue":s[12]||(s[12]=a=>c.value.variants[2].text=a),density:"compact",label:"C variant"},null,8,["modelValue"]),t(v,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:c.value.variants[3].text,"onUpdate:modelValue":s[13]||(s[13]=a=>c.value.variants[3].text=a),density:"compact",label:"D variant"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(f,{cols:"12"},{default:e(()=>[(j(!0),J(W,null,K(y.value,(a,b)=>(j(),S(ge,{lines:"three",class:"my-1",key:b},{actions:e(()=>[t(k,{variant:"flat",size:"30",onClick:V=>me(a,b),color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),t(k,{variant:"flat",class:"ml-1",size:"30",onClick:V=>te(b),color:"primary"},{default:e(()=>[t(q,null,{default:e(()=>[_("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),default:e(()=>[t(G,null,{default:e(()=>[i("span",Me,n(b+1)+". "+n(a.text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[_("a) "+n(a.variants[0].text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[_("b) "+n(a.variants[1].text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[_("c) "+n(a.variants[2].text),1)]),_:2},1024),t(G,{class:"text-caption"},{default:e(()=>[_("d) "+n(a.variants[3].text),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(E,{modelValue:$.value,"onUpdate:modelValue":s[15]||(s[15]=a=>$.value=a)},{default:e(()=>[$.value?(j(),S(Oe,{key:0,onCloseView:ee,groups:I.value,testid:h.value,testname:U.value},null,8,["groups","testid","testname"])):ie("",!0)]),_:1},8,["modelValue"])]),_:1})}}};export{Pe as default};
