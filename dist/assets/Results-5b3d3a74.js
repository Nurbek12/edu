import{u as K,r as d,m as O,a as n,o as Y,c as A,w as e,h as p,b as t,f,d as r,t as b,n as D}from"./index-eee0caed.js";const E={class:"responsive-datatable"},H={"data-label":"Talaba"},I={"data-label":"Bahosi"},M={"data-label":"Foizi"},Q={"data-label":"Ko'rish"},J=r("div",null,"Hech narsa topilmadi",-1),Z={__name:"Results",setup(W){K();const C=[{title:"Talaba",key:"student.name"},{title:"Bahosi",key:"rate"},{title:"Foizi",key:"percent"},{title:"Ko'rish",key:"view"}],h=d(""),c=d(!1),x=d([]),y=d([]),V=d([]),m=d(null),v=d(null),s=d({group:null,exam:null}),k=d(!1),R=async()=>{const i=await Promise.all([p.get("/exam/list"),p.get("/group")]);y.value=i[0].data,V.value=i[1].data},U=async()=>{if(!v.value)return;const i=new URLSearchParams({group:v.value,exam:m.value._id}).toString(),{data:l}=await p.get(`/test/result?${i}`);x.value=l};async function S(){for(const l in s.value)(s.value[l]===null||s.value[l]==="")&&delete s.value[l];const i=new URLSearchParams(s.value).toString();k.value=!0,await p({method:"get",url:"/test/download?"+i,responseType:"blob",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}).then(l=>{const u=window.URL.createObjectURL(new Blob([l.data])),o=document.createElement("a");o.href=u,o.setAttribute("download","result.xlsx"),document.body.appendChild(o),o.click()}),k.value=!1}const q=()=>{c.value=!1,D(()=>{Object.assign(s.value,{group:null,test:null})})};return O(c,i=>i||q()),R(),(i,l)=>{const u=n("v-select"),o=n("v-col"),z=n("v-text-field"),w=n("v-btn"),g=n("v-row"),T=n("v-sheet"),F=n("v-icon"),L=n("v-data-table"),j=n("v-card-title"),N=n("v-form"),B=n("v-container"),P=n("v-card-text"),$=n("v-card"),G=n("v-dialog");return Y(),A(B,{fluid:""},{default:e(()=>[t(g,null,{default:e(()=>[t(o,{cols:"12",md:"4"},{default:e(()=>[t(T,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[t(g,null,{default:e(()=>[t(o,{cols:"12",class:"pb-0"},{default:e(()=>[t(u,{modelValue:m.value,"onUpdate:modelValue":[l[0]||(l[0]=a=>m.value=a),U],label:"Imtihon",density:"comfortable","hide-details":"",items:y.value,color:"primary","item-title":"name","return-object":"",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12"},{default:e(()=>{var a;return[t(u,{modelValue:v.value,"onUpdate:modelValue":[l[1]||(l[1]=_=>v.value=_),U],label:"Guruh",disabled:!m.value,"hide-details":"",density:"comfortable",items:((a=m.value)==null?void 0:a.groups)||[],color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","disabled","items"])]}),_:1}),t(o,{cols:"12",class:"py-0"},{default:e(()=>[t(z,{label:"Qidirish",modelValue:h.value,"onUpdate:modelValue":l[2]||(l[2]=a=>h.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(o,null,{default:e(()=>[t(w,{block:"",color:"primary",height:"42",onClick:l[3]||(l[3]=a=>c.value=!0),variant:"flat"},{default:e(()=>[f("Yuklab olish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"8"},{default:e(()=>[t(T,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[r("div",E,[t(L,{"items-per-page-text":"",headers:C,search:h.value,items:x.value},{"item.student.name":e(({item:a})=>{var _;return[r("td",H,b((_=a.raw.student)==null?void 0:_.name),1)]}),"item.rate":e(({item:a})=>[r("td",I,b(a.raw.rate)+" / "+b(a.raw.questions),1)]),"item.percent":e(({item:a})=>[r("td",M,b(parseFloat(a.raw.rate*100/a.raw.questions).toFixed(1))+" % ",1)]),"item.view":e(({item:a})=>[r("td",Q,[t(w,{variant:"flat",size:"30",color:"primary",to:`/test/${a.raw._id}`},{default:e(()=>[t(F,null,{default:e(()=>[f("mdi-eye-arrow-right")]),_:1})]),_:2},1032,["to"])])]),"no-data":e(()=>[J]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t(G,{modelValue:c.value,"onUpdate:modelValue":l[6]||(l[6]=a=>c.value=a),"max-width":"550px"},{default:e(()=>[t($,null,{default:e(()=>[t(P,{class:"px-2 pt-0"},{default:e(()=>[t(B,null,{default:e(()=>[t(N,{ref:"form"},{default:e(()=>[t(g,null,{default:e(()=>[t(j,null,{default:e(()=>[f("Ma'lumotlarni yuklab olish")]),_:1}),t(o,{cols:"12"},{default:e(()=>[t(u,{modelValue:s.value.exam,"onUpdate:modelValue":l[4]||(l[4]=a=>s.value.exam=a),items:y.value,label:"Test bo'yicha",clearable:"","clear-icon":"mdi-close","hide-details":"","item-title":"name",color:"primary","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12"},{default:e(()=>[t(u,{modelValue:s.value.group,"onUpdate:modelValue":l[5]||(l[5]=a=>s.value.group=a),clearable:"","clear-icon":"mdi-close",label:"Guruh bo'yicha",items:V.value,"hide-details":"","item-title":"name",color:"primary","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12"},{default:e(()=>[t(w,{variant:"flat",color:"primary",block:"",onClick:S,height:"45"},{default:e(()=>[f(" Yuklab olish ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{Z as default};
