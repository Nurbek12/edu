import{a as f}from"./index-7376b9a9.js";import{u as L,r,m as K,a as l,o as O,c as P,w as e,b as t,f as v,d as n,t as c,p as Y}from"./index-6f11c559.js";const $=n("span",{class:"text-h5"},"Natijalar",-1),A={class:"responsive-datatable"},D={"data-label":"T/r"},E={"data-label":"Test nomi"},H={"data-label":"Talaba"},M={"data-label":"Guruhi"},I={"data-label":"Bahosi"},J={"data-label":"Foizi"},Q={"data-label":"Ko'rish"},W=n("div",null,"Hech narsa topilmadi",-1),te={__name:"Results",setup(X){L();const V=[{key:"student.group",order:"asc"}],T=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test Nomi",key:"test.name"},{title:"Talaba",key:"student.name"},{title:"Guruhi",key:"student.group"},{title:"Bahosi",key:"rate"},{title:"Foizi",key:"percent"},{title:"Ko'rish",key:"view"}],B=r(""),_=r(!1),h=r([]),b=r([]),w=r([]),s=r({group:"",test:"",student:""}),y=r(!1),C=async()=>{const[u,o]=await Promise.all([f.get("/test/result/"),f.get("/all/names")]);b.value=o.data.tests,w.value=o.data.groups,h.value=u.data};async function U(){for(const o in s.value)(s.value[o]===null||s.value[o]==="")&&delete s.value[o];const u=new URLSearchParams(s.value).toString();y.value=!0,await f({method:"get",url:"/test/download?"+u,responseType:"blob",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}).then(o=>{const d=window.URL.createObjectURL(new Blob([o.data])),i=document.createElement("a");i.href=d,i.setAttribute("download","result.xlsx"),document.body.appendChild(i),i.click()}),y.value=!1}const N=()=>{_.value=!1,Y(()=>{Object.assign(s.value,{group:"",test:"",student:""})})};return K(_,u=>u||N()),C(),(u,o)=>{const d=l("v-col"),i=l("v-btn"),p=l("v-row"),g=l("v-sheet"),j=l("v-icon"),z=l("v-data-table"),F=l("v-card-title"),k=l("v-select"),R=l("v-form"),x=l("v-container"),S=l("v-card-text"),q=l("v-card"),G=l("v-dialog");return O(),P(x,{fluid:""},{default:e(()=>[t(p,null,{default:e(()=>[t(d,{cols:"12"},{default:e(()=>[t(g,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[t(p,{justify:"space-between",align:"center"},{default:e(()=>[t(d,{cols:"12",sm:"4"},{default:e(()=>[$]),_:1}),t(d,{cols:"12",sm:"4",md:"3"},{default:e(()=>[t(i,{block:"",color:"green",onClick:o[0]||(o[0]=a=>_.value=!0),variant:"tonal"},{default:e(()=>[v("Yuklab olish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(g,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[n("div",A,[t(z,{headers:T,search:B.value,items:h.value,"group-by":V},{"item.no":e(({index:a})=>[n("td",D,c(a)+".",1)]),"item.test.name":e(({item:a})=>[n("td",E,c(a.raw.test.name),1)]),"item.student.name":e(({item:a})=>{var m;return[n("td",H,c((m=a.raw.student)==null?void 0:m.name),1)]}),"item.student.group":e(({item:a})=>{var m;return[n("td",M,c((m=a.raw.student)==null?void 0:m.group),1)]}),"item.rate":e(({item:a})=>[n("td",I,c(a.raw.rate),1)]),"item.percent":e(({item:a})=>[n("td",J,c(parseFloat(a.raw.rate*100/a.raw.questions).toFixed(1))+" % ",1)]),"item.view":e(({item:a})=>[n("td",Q,[t(i,{variant:"outlined",size:"small",to:`/test/${a.raw._id}`},{default:e(()=>[t(j,null,{default:e(()=>[v("mdi-eye-arrow-right")]),_:1})]),_:2},1032,["to"])])]),"no-data":e(()=>[W]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t(G,{modelValue:_.value,"onUpdate:modelValue":o[3]||(o[3]=a=>_.value=a),"max-width":"550px"},{default:e(()=>[t(q,null,{default:e(()=>[t(S,{class:"px-2 pt-0"},{default:e(()=>[t(x,null,{default:e(()=>[t(R,{ref:"form"},{default:e(()=>[t(p,null,{default:e(()=>[t(F,null,{default:e(()=>[v("Ma'lumotlarni yuklab olish")]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(k,{modelValue:s.value.test,"onUpdate:modelValue":o[1]||(o[1]=a=>s.value.test=a),items:b.value,label:"Test bo'yicha",clearable:"","clear-icon":"mdi-close","hide-details":"","item-title":"name",color:"primary","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(k,{modelValue:s.value.group,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.group=a),clearable:"","clear-icon":"mdi-close",label:"Guruh bo'yicha",items:w.value,"hide-details":"","item-title":"name",color:"primary","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(i,{variant:"tonal",color:"primary",block:"",onClick:U,height:"45"},{default:e(()=>[v(" Yuklab olish ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{te as default};
