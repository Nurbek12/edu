import{r as u,a as o,o as G,c as O,w as t,h as w,b as e,d as i,f as m,t as c}from"./index-868e85fe.js";const Q={class:"responsive-datatable"},A={"data-label":"Boshqarish"},E={class:"d-flex justify-end"},F={"data-label":"Ism familiyasi"},J={"data-label":"Telefoni"},M={"data-label":"Kontrakt"},P={"data-label":"Summasi"},R={"data-label":"Sanasi"},Y={__name:"StudentList",setup(W){const C=[{title:"Ism familiyasi",key:"name"},{title:"Telefoni",key:"phone"},{title:"Kontrakt",key:"total"},{title:"Boshqarish",align:"start",key:"actions",sortable:!1}],z=[{title:"To'lov summasi",key:"amount"},{title:"To'lov sanasi",key:"date"}],p=u(""),v=u([]),b=u([]),f=u(null),_=u(!1),h=u([]),T=async()=>{const{data:l}=await w.get("/group");b.value=l},B=async(l,s)=>{const n=prompt("Kontrakt summasi");if(!(isNaN(n)||n===""||n===null)&&confirm(`${l.name} ga ${n} pul o'tkazilsinmi?`)){const{data:d}=await w.post("/user/contract",{student:l._id,amount:parseInt(n),date:new Date().toLocaleString()});Object.assign(v.value[s],{total:l.total+parseInt(n),contract:[...l.contract,d]})}},N=l=>{_.value=!0,h.value=l},S=()=>{_.value=!1,h.value=[]},$=async()=>{const{data:l}=await w.get(`/user/contract/${f.value}`);v.value=l};return T(),(l,s)=>{const n=o("v-select"),d=o("v-col"),j=o("v-text-field"),x=o("v-row"),k=o("v-sheet"),y=o("v-icon"),g=o("v-btn"),V=o("v-data-table"),I=o("v-spacer"),U=o("v-card-title"),K=o("v-card-text"),L=o("v-card"),q=o("v-dialog"),D=o("v-container");return G(),O(D,{fluid:""},{default:t(()=>[e(x,null,{default:t(()=>[e(d,{cols:"12"},{default:t(()=>[e(k,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:t(()=>[e(x,{justify:"start",align:"center"},{default:t(()=>[e(d,{class:"py-1",cols:"12",sm:"4"},{default:t(()=>[e(n,{modelValue:f.value,"onUpdate:modelValue":[s[0]||(s[0]=a=>f.value=a),$],label:"Guruh","hide-details":"",density:"compact",items:b.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{class:"py-1",cols:"12",sm:"4"},{default:t(()=>[e(j,{label:"Qidirish",modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(k,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[i("div",Q,[e(V,{"items-per-page":"-1","items-per-page-text":"","no-data-text":"Hech narsa topilmadi",headers:C,search:p.value,items:v.value},{"item.actions":t(({index:a,item:r})=>[i("td",A,[i("div",E,[e(g,{variant:"flat",color:"primary",size:"30",onClick:H=>N(r.raw.contract)},{default:t(()=>[e(y,null,{default:t(()=>[m("mdi-calendar")]),_:1})]),_:2},1032,["onClick"]),e(g,{variant:"flat",class:"ml-1",color:"primary",size:"30",onClick:H=>B(r.raw,a)},{default:t(()=>[e(y,null,{default:t(()=>[m("mdi-plus-circle")]),_:1})]),_:2},1032,["onClick"])])])]),bottom:t(()=>[]),"item.name":t(({index:a,item:r})=>[i("td",F,c(a+1)+". "+c(r.raw.name),1)]),"item.phone":t(({item:a})=>[i("td",J,c(a.raw.phone),1)]),"item.total":t(({item:a})=>[i("td",M,c(a.raw.total),1)]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e(q,{"max-width":"450",modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=a=>_.value=a)},{default:t(()=>[e(L,null,{default:t(()=>[e(U,{class:"text-h6 d-flex justify-space-between align-center"},{default:t(()=>[m(" To'lovlar ro'yxati "),e(I),e(g,{size:"30",color:"primary",onClick:S},{default:t(()=>[e(y,{size:"small"},{default:t(()=>[m("mdi-close")]),_:1})]),_:1})]),_:1}),e(K,{class:"px-2"},{default:t(()=>[e(V,{"no-data-text":"Hech narsa topilmadi","items-per-page-text":"","items-per-page":"-1",headers:z,items:h.value},{"item.amount":t(({index:a,item:r})=>[i("td",P,c(a+1)+". "+c(r.raw.amount),1)]),bottom:t(()=>[]),"item.date":t(({item:a})=>[i("td",R,c(a.raw.date),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{Y as default};
