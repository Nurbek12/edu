import{a as y}from"./index-7376b9a9.js";import{r as u,a as o,o as w,c as V,w as t,b as a,d as s,f as m,t as r,h as L,i as S,F as T}from"./index-1d6c4b32.js";const q={class:"responsive-datatable"},F={"data-label":"Boshqarish"},$={class:"d-flex justify-end"},E={"data-label":"Ism familiyasi"},G={"data-label":"Telefoni"},H={"data-label":"Kontrakt"},O=["colspan"],M={__name:"StudentList",setup(Q){const B=[{title:"Ism familiyasi",key:"name"},{title:"Telefoni",key:"phone"},{title:"Kontrakt",key:"total"},{title:"Boshqarish",align:"start",key:"actions",sortable:!1}],_=u(""),p=u([]),b=u([]),g=u([]),v=u(null),K=async()=>{const{data:n}=await y.get("/group");g.value=n},N=async(n,l)=>{const i=prompt("Kontrakt summasi");if(!(isNaN(i)||i===""||i===null)&&confirm("Kontrakt Kiritilishiga rozimisiz?")){const{data:c}=await y.post("/user/contract",{student:n._id,amount:parseInt(i),date:new Date().toLocaleDateString()});Object.assign(p.value[l],{total:n.total+parseInt(i),contract:[...n.contract,c]})}},z=async()=>{const{data:n}=await y.get(`/user/contract/${v.value}`);p.value=n};return K(),(n,l)=>{const i=o("v-select"),c=o("v-col"),C=o("v-text-field"),x=o("v-row"),k=o("v-sheet"),f=o("v-icon"),I=o("v-btn"),U=o("v-chip"),j=o("v-data-table"),D=o("v-container");return w(),V(D,{fluid:""},{default:t(()=>[a(x,null,{default:t(()=>[a(c,{cols:"12"},{default:t(()=>[a(k,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:t(()=>[a(x,{justify:"start",align:"center"},{default:t(()=>[a(c,{class:"py-1",cols:"12",sm:"4"},{default:t(()=>[a(i,{modelValue:v.value,"onUpdate:modelValue":[l[0]||(l[0]=e=>v.value=e),z],label:"Guruh","hide-details":"",density:"compact",items:g.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(c,{class:"py-1",cols:"12",sm:"4"},{default:t(()=>[a(C,{label:"Qidirish",modelValue:_.value,"onUpdate:modelValue":l[1]||(l[1]=e=>_.value=e),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(c,{cols:"12"},{default:t(()=>[a(k,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:t(()=>[s("div",q,[a(j,{"items-per-page":"-1","items-per-page-text":"","no-data-text":"Hech narsa topilmadi",headers:B,search:_.value,items:p.value,"item-value":"_id","show-expand":"",expanded:b.value,"onUpdate:expanded":l[2]||(l[2]=e=>b.value=e)},{"item.actions":t(({index:e,item:d})=>[s("td",F,[s("div",$,[a(I,{variant:"flat",color:"primary",size:"30",onClick:h=>N(d.raw,e)},{default:t(()=>[a(f,null,{default:t(()=>[m("mdi-plus-circle")]),_:1})]),_:2},1032,["onClick"])])])]),bottom:t(()=>[]),"item.name":t(({index:e,item:d})=>[s("td",E,r(e+1)+". "+r(d.raw.name),1)]),"item.phone":t(({item:e})=>[s("td",G,r(e.raw.phone),1)]),"item.total":t(({item:e})=>[s("td",H,r(e.raw.total),1)]),"expanded-row":t(({columns:e,item:d})=>[s("tr",null,[s("td",{colspan:e.length},[(w(!0),L(T,null,S(d.raw.contract,h=>(w(),V(U,{color:"primary",variant:"elevated",label:"",class:"mx-1"},{default:t(()=>[a(f,null,{default:t(()=>[m("mdi-clock-outline")]),_:1}),m(" "+r(h.date)+", ",1),a(f,null,{default:t(()=>[m("mdi-currency-usd")]),_:1}),m(" "+r(h.amount),1)]),_:2},1024))),256))],8,O)])]),_:1},8,["search","items","expanded"])])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{M as default};
