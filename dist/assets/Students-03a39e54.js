import{r as u,l as M,m as W,a as i,o as X,c as Z,w as e,h as b,b as a,f,d,t as m,e as ee,n as ae}from"./index-2e243627.js";const le={class:"responsive-datatable"},te={"data-label":"Boshqarish"},oe={class:"d-flex justify-end"},se={"data-label":"Ismi"},ne={"data-label":"Guruhi"},ie={"data-label":"Login"},ue={"data-label":"Telefoni"},de={"data-label":"Boshlagan yili"},re={"data-label":"Holati"},me={"data-label":"Tugilgan sanasi"},ce={class:"text-h5"},_e={__name:"Students",setup(ve){const c=[o=>!!o||"Required"],P=[{title:"Ism familiyasi",key:"name",sortable:!1},{title:"Guruhi",key:"group",sortable:!1},{title:"Login",key:"login",sortable:!1},{title:"Telefoni",key:"phone",sortable:!1},{title:"Tugilgan sanasi",key:"birthdate",sortable:!1},{title:"Holati",key:"status",sortable:!1},{title:"Boshlagan yili",key:"start",sortable:!1},{title:"Boshqarish",align:"start",key:"actions",sortable:!1}],g=u("");u([]);const G=[2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035],v=u(!1),y=u(null),p=u(-1),h=u(null),V=u([]),s=u({name:"",birthdate:"",phone:"",login:"",password:"",group:null,start_year:null,role:"student"}),z={name:"",birthdate:"",phone:"",login:"",password:"",group:null,start_year:null,role:"student"},H=M(()=>p.value===-1?"Talaba yaratish":"Talabani o'zgartirish"),I=u(10),_=u([]),w=u(!0),U=u(0);u(""),W(v,o=>o||k());const L=async()=>{const{data:o}=await b.get("/group");V.value=o},N=async()=>{const{valid:o}=await y.value.validate();o&&$()},S=o=>{p.value=_.value.indexOf(o),h.value=o._id,s.value=Object.assign({},o),v.value=!0},k=()=>{v.value=!1,ae(()=>{var o;s.value=Object.assign({},z),h.value=null,p.value=-1,(o=y.value)==null||o.reset()})},$=async()=>{if(p.value>-1){const{data:o}=await b.put(`/user/${h.value}`,{...s.value,status:"aktiv"});o?(Object.assign(_.value[p.value],o),k()):s.value.login=""}else{const{data:o}=await b.post("/user",s.value);o?(_.value.push(o),k()):s.value.login=""}},D=o=>{var t;return(t=V.value.find(({_id:r})=>r===o))==null?void 0:t.name},Q=async({page:o,itemsPerPage:t,sortBy:r})=>{w.value=!0;const{data:n}=await b.get("/user/student/page",{params:{page:o,limit:t,search:g.value}});_.value=n.data,U.value=n.total,w.value=!1};return L(),(o,t)=>{const r=i("v-text-field"),n=i("v-col"),x=i("v-btn"),T=i("v-row"),B=i("v-sheet"),R=i("v-icon"),q=i("v-chip"),Y=i("v-data-table-server"),A=i("v-card-title"),C=i("v-select"),E=i("v-form"),j=i("v-container"),F=i("v-card-text"),J=i("v-card"),K=i("v-dialog");return X(),Z(j,{fluid:""},{default:e(()=>[a(T,null,{default:e(()=>[a(n,{cols:"12"},{default:e(()=>[a(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(T,{justify:"space-between",align:"center"},{default:e(()=>[a(n,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(r,{label:"Qidirish",modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=l=>g.value=l),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(n,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[a(x,{block:"",height:"42",color:"primary",onClick:t[1]||(t[1]=l=>v.value=!0),variant:"flat"},{default:e(()=>[f("Yangi Talaba")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[d("div",le,[a(Y,{"items-per-page":I.value,"onUpdate:itemsPerPage":t[2]||(t[2]=l=>I.value=l),search:g.value,headers:P,"items-length":U.value,items:_.value,loading:w.value,class:"elevation-1","items-per-page-text":"","item-value":"name","no-data-text":"Hech narsa topilmadi","onUpdate:options":Q},{"item.actions":e(({item:l})=>[d("td",te,[d("div",oe,[a(x,{variant:"flat",size:"30",color:"primary",onClick:O=>S(l.raw)},{default:e(()=>[a(R,null,{default:e(()=>[f("mdi-pencil")]),_:1})]),_:2},1032,["onClick"])])])]),"item.name":e(({index:l,item:O})=>[d("td",se,m(l+1)+". "+m(O.raw.name),1)]),"item.group":e(({item:l})=>[d("td",ne,[a(q,{label:"",color:"primary"},{default:e(()=>[f(m(D(l.raw.group)),1)]),_:2},1024)])]),"item.login":e(({item:l})=>[d("td",ie,m(l.raw.login),1)]),"item.phone":e(({item:l})=>[d("td",ue,m(l.raw.phone),1)]),"item.start":e(({item:l})=>[d("td",de,m(l.raw.start_year),1)]),"item.status":e(({item:l})=>[d("td",re,[a(q,{label:"",color:{aktiv:"blue",chetlashtirilgan:"red"}[l.raw.status]},{default:e(()=>[f(m(l.raw.status),1)]),_:2},1032,["color"])])]),"item.birthdate":e(({item:l})=>[d("td",me,m(l.raw.birthdate),1)]),_:1},8,["items-per-page","search","items-length","items","loading"])])]),_:1})]),_:1})]),_:1}),a(K,{modelValue:v.value,"onUpdate:modelValue":t[10]||(t[10]=l=>v.value=l),"max-width":"550px"},{default:e(()=>[a(J,null,{default:e(()=>[a(A,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[d("span",ce,m(ee(H)),1)]),_:1}),a(F,{class:"px-2 pt-0"},{default:e(()=>[a(j,null,{default:e(()=>[a(E,{ref_key:"form",ref:y},{default:e(()=>[a(T,null,{default:e(()=>[a(n,{cols:"12"},{default:e(()=>[a(r,{modelValue:s.value.name,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.name=l),label:"Ism familiya","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(C,{modelValue:s.value.group,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.group=l),label:"Guruhi",rules:c,"hide-details":"",items:V.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(C,{modelValue:s.value.start_year,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.start_year=l),label:"O'qishni boshlagan yili",rules:c,"hide-details":"",items:G,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(r,{modelValue:s.value.phone,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.phone=l),label:"Telefon raqami","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(r,{modelValue:s.value.birthdate,"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.birthdate=l),label:"Tug'ilgan sanasi","hide-details":"",type:"date",color:"primary",rules:c,variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(r,{modelValue:s.value.login,"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.login=l),label:"Login","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(r,{modelValue:s.value.password,"onUpdate:modelValue":t[9]||(t[9]=l=>s.value.password=l),label:"Parol","hide-details":"",rules:h.value?[]:c,color:"primary",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(x,{variant:"flat",color:"primary",block:"",onClick:N,height:"45"},{default:e(()=>[f(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{_e as default};
