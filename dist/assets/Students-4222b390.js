import{a as g}from"./index-7376b9a9.js";import{r as d,l as K,n as M,a as n,o as W,c as X,w as a,b as t,f as h,d as u,t as r,e as Z,p as ee}from"./index-856562a7.js";const ae={class:"responsive-datatable"},te={"data-label":"T/r"},le={"data-label":"Boshqarish"},oe={class:"d-flex justify-end"},se={"data-label":"Ism familiyasi"},ie={"data-label":"Guruhi"},ne={"data-label":"Login"},de={"data-label":"Paroli"},ue={"data-label":"Telefoni"},re={"data-label":"Telefoni"},me={"data-label":"Holati"},ce={"data-label":"Tugilgan sanasi"},ve={class:"text-h5"},ge={__name:"Students",setup(pe){const m=[o=>!!o||"Required"],j=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Ism familiyasi",key:"name"},{title:"Guruhi",key:"group"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Tugilgan sanasi",key:"birthdate"},{title:"Holati",key:"status"},{title:"Boshlagan yili",key:"start"},{title:"Boshqarish",align:"start",key:"actions",sortable:!1}],f=d("");d([]);const O=[2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035],v=d(!1),y=d(null),p=d(-1),b=d(-1),V=d([]),s=d({name:"",birthdate:"",phone:"",login:"",password:"",group:null,start_year:null,role:"student"}),z={name:"",birthdate:"",phone:"",login:"",password:"",group:null,start_year:null,role:"student"},G=K(()=>p.value===-1?"Talaba yaratish":"Talabani o'zgartirish"),I=d(10),_=d([]),w=d(!0),B=d(0);d(""),M(v,o=>o||k());const H=async()=>{const{data:o}=await g.get("/group");V.value=o},L=async()=>{const{valid:o}=await y.value.validate();o&&S()},N=o=>{p.value=_.value.indexOf(o),b.value=o._id,s.value=Object.assign({},o),v.value=!0},k=()=>{v.value=!1,ee(()=>{var o;s.value=Object.assign({},z),b.value=-1,p.value=-1,(o=y.value)==null||o.reset()})},S=async()=>{if(p.value>-1){const{data:o}=await g.put(`/user/${b.value}`,{...s.value,status:"aktiv"});o?(Object.assign(_.value[p.value],o),k()):s.value.login=""}else{const{data:o}=await g.post("/user",s.value);o?(_.value.push(o),k()):s.value.login=""}},$=async({page:o,itemsPerPage:l,sortBy:c})=>{w.value=!0;const{data:i}=await g.get("/user/student/page",{params:{page:o,limit:l,search:f.value}});_.value=i.data,B.value=i.total,w.value=!1};return H(),(o,l)=>{const c=n("v-text-field"),i=n("v-col"),x=n("v-btn"),T=n("v-row"),P=n("v-sheet"),D=n("v-icon"),U=n("v-select"),Q=n("v-chip"),R=n("v-data-table-server"),Y=n("v-card-title"),A=n("v-form"),q=n("v-container"),E=n("v-card-text"),F=n("v-card"),J=n("v-dialog");return W(),X(q,{fluid:""},{default:a(()=>[t(T,null,{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(P,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:a(()=>[t(T,{justify:"space-between",align:"center"},{default:a(()=>[t(i,{class:"py-1",cols:"12",sm:"4"},{default:a(()=>[t(c,{label:"Qidirish",modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(i,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:a(()=>[t(x,{block:"",height:"42",color:"primary",onClick:l[1]||(l[1]=e=>v.value=!0),variant:"flat"},{default:a(()=>[h("Yangi Talaba")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{cols:"12"},{default:a(()=>[t(P,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[u("div",ae,[t(R,{"items-per-page":I.value,"onUpdate:itemsPerPage":l[2]||(l[2]=e=>I.value=e),search:f.value,headers:j,"items-length":B.value,items:_.value,loading:w.value,class:"elevation-1","items-per-page-text":"","item-value":"name","no-data-text":"Hech narsa topilmadi","onUpdate:options":$},{"item.no":a(({index:e})=>[u("td",te,r(e+1)+".",1)]),"item.actions":a(({item:e})=>[u("td",le,[u("div",oe,[t(x,{variant:"flat",size:"30",color:"primary",onClick:C=>N(e.raw)},{default:a(()=>[t(D,null,{default:a(()=>[h("mdi-pencil")]),_:1})]),_:2},1032,["onClick"])])])]),"item.name":a(({item:e})=>[u("td",se,r(e.raw.name),1)]),"item.group":a(({item:e})=>[u("td",ie,[t(U,{items:V.value,readonly:"",chips:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:e.raw.group,"onUpdate:modelValue":C=>e.raw.group=C},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.login":a(({item:e})=>[u("td",ne,r(e.raw.login),1)]),"item.password":a(({item:e})=>[u("td",de,r(e.raw.password),1)]),"item.phone":a(({item:e})=>[u("td",ue,r(e.raw.phone),1)]),"item.start":a(({item:e})=>[u("td",re,r(e.raw.start_year),1)]),"item.status":a(({item:e})=>[u("td",me,[t(Q,{label:"",color:{aktiv:"blue",chetlashtirilgan:"red"}[e.raw.status]},{default:a(()=>[h(r(e.raw.status),1)]),_:2},1032,["color"])])]),"item.birthdate":a(({item:e})=>[u("td",ce,r(e.raw.birthdate),1)]),_:1},8,["items-per-page","search","items-length","items","loading"])])]),_:1})]),_:1})]),_:1}),t(J,{modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=e=>v.value=e),"max-width":"550px"},{default:a(()=>[t(F,null,{default:a(()=>[t(Y,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[u("span",ve,r(Z(G)),1)]),_:1}),t(E,{class:"px-2 pt-0"},{default:a(()=>[t(q,null,{default:a(()=>[t(A,{ref_key:"form",ref:y},{default:a(()=>[t(T,null,{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(c,{modelValue:s.value.name,"onUpdate:modelValue":l[3]||(l[3]=e=>s.value.name=e),label:"Ism familiya","hide-details":"",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6"},{default:a(()=>[t(U,{modelValue:s.value.group,"onUpdate:modelValue":l[4]||(l[4]=e=>s.value.group=e),label:"Guruhi",rules:m,"hide-details":"",items:V.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(i,{cols:"12",sm:"6"},{default:a(()=>[t(U,{modelValue:s.value.start_year,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value.start_year=e),label:"O'qishni boshlagan yili",rules:m,"hide-details":"",items:O,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6"},{default:a(()=>[t(c,{modelValue:s.value.phone,"onUpdate:modelValue":l[6]||(l[6]=e=>s.value.phone=e),label:"Telefon raqami","hide-details":"",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6"},{default:a(()=>[t(c,{modelValue:s.value.birthdate,"onUpdate:modelValue":l[7]||(l[7]=e=>s.value.birthdate=e),label:"Tug'ilgan sanasi","hide-details":"",type:"date",color:"primary",rules:m,variant:"outlined"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6"},{default:a(()=>[t(c,{modelValue:s.value.login,"onUpdate:modelValue":l[8]||(l[8]=e=>s.value.login=e),label:"Login","hide-details":"",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12",sm:"6"},{default:a(()=>[t(c,{modelValue:s.value.password,"onUpdate:modelValue":l[9]||(l[9]=e=>s.value.password=e),label:"Parol","hide-details":"",rules:m,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(i,{cols:"12"},{default:a(()=>[t(x,{variant:"flat",color:"primary",block:"",onClick:L,height:"45"},{default:a(()=>[h(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ge as default};
