import{r as d,l as K,m as M,a as i,o as W,c as X,w as a,h,b as t,f,d as u,t as r,e as Z,n as ee}from"./index-439559a6.js";const ae={class:"responsive-datatable"},te={"data-label":"T/r"},le={"data-label":"Boshqarish"},oe={class:"d-flex justify-end"},se={"data-label":"Ismi"},ne={"data-label":"Guruhi"},ie={"data-label":"Login"},de={"data-label":"Paroli"},ue={"data-label":"Telefoni"},re={"data-label":"Boshlagan yili"},me={"data-label":"Holati"},ce={"data-label":"Tugilgan sanasi"},ve={class:"text-h5"},ge={__name:"Students",setup(pe){const c=[o=>!!o||"Required"],j=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Ism familiyasi",key:"name"},{title:"Guruhi",key:"group"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Tugilgan sanasi",key:"birthdate"},{title:"Holati",key:"status"},{title:"Boshlagan yili",key:"start"},{title:"Boshqarish",align:"start",key:"actions",sortable:!1}],g=d("");d([]);const O=[2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035],v=d(!1),y=d(null),p=d(-1),b=d(-1),w=d([]),s=d({name:"",birthdate:"",phone:"",login:"",password:"",group:null,start_year:null,role:"student"}),G={name:"",birthdate:"",phone:"",login:"",password:"",group:null,start_year:null,role:"student"},z=K(()=>p.value===-1?"Talaba yaratish":"Talabani o'zgartirish"),I=d(10),_=d([]),V=d(!0),U=d(0);d(""),M(v,o=>o||k());const H=async()=>{const{data:o}=await h.get("/group");w.value=o},L=async()=>{const{valid:o}=await y.value.validate();o&&S()},N=o=>{p.value=_.value.indexOf(o),b.value=o._id,s.value=Object.assign({},o),v.value=!0},k=()=>{v.value=!1,ee(()=>{var o;s.value=Object.assign({},G),b.value=-1,p.value=-1,(o=y.value)==null||o.reset()})},S=async()=>{if(p.value>-1){const{data:o}=await h.put(`/user/${b.value}`,{...s.value,status:"aktiv"});o?(Object.assign(_.value[p.value],o),k()):s.value.login=""}else{const{data:o}=await h.post("/user",s.value);o?(_.value.push(o),k()):s.value.login=""}},$=o=>{var l;return(l=w.value.find(({_id:m})=>m===o))==null?void 0:l.name},D=async({page:o,itemsPerPage:l,sortBy:m})=>{V.value=!0;const{data:n}=await h.get("/user/student/page",{params:{page:o,limit:l,search:g.value}});_.value=n.data,U.value=n.total,V.value=!1};return H(),(o,l)=>{const m=i("v-text-field"),n=i("v-col"),x=i("v-btn"),T=i("v-row"),B=i("v-sheet"),Q=i("v-icon"),P=i("v-chip"),R=i("v-data-table-server"),Y=i("v-card-title"),q=i("v-select"),A=i("v-form"),C=i("v-container"),E=i("v-card-text"),F=i("v-card"),J=i("v-dialog");return W(),X(C,{fluid:""},{default:a(()=>[t(T,null,{default:a(()=>[t(n,{cols:"12"},{default:a(()=>[t(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:a(()=>[t(T,{justify:"space-between",align:"center"},{default:a(()=>[t(n,{class:"py-1",cols:"12",sm:"4"},{default:a(()=>[t(m,{label:"Qidirish",modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=e=>g.value=e),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(n,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:a(()=>[t(x,{block:"",height:"42",color:"primary",onClick:l[1]||(l[1]=e=>v.value=!0),variant:"flat"},{default:a(()=>[f("Yangi Talaba")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(n,{cols:"12"},{default:a(()=>[t(B,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[u("div",ae,[t(R,{"items-per-page":I.value,"onUpdate:itemsPerPage":l[2]||(l[2]=e=>I.value=e),search:g.value,headers:j,"items-length":U.value,items:_.value,loading:V.value,class:"elevation-1","items-per-page-text":"","item-value":"name","no-data-text":"Hech narsa topilmadi","onUpdate:options":D},{"item.no":a(({index:e})=>[u("td",te,r(e+1)+".",1)]),"item.actions":a(({item:e})=>[u("td",le,[u("div",oe,[t(x,{variant:"flat",size:"30",color:"primary",onClick:_e=>N(e.raw)},{default:a(()=>[t(Q,null,{default:a(()=>[f("mdi-pencil")]),_:1})]),_:2},1032,["onClick"])])])]),"item.name":a(({item:e})=>[u("td",se,r(e.raw.name),1)]),"item.group":a(({item:e})=>[u("td",ne,[t(P,{label:"",color:"primary"},{default:a(()=>[f(r($(e.raw.group)),1)]),_:2},1024)])]),"item.login":a(({item:e})=>[u("td",ie,r(e.raw.login),1)]),"item.password":a(({item:e})=>[u("td",de,r(e.raw.password),1)]),"item.phone":a(({item:e})=>[u("td",ue,r(e.raw.phone),1)]),"item.start":a(({item:e})=>[u("td",re,r(e.raw.start_year),1)]),"item.status":a(({item:e})=>[u("td",me,[t(P,{label:"",color:{aktiv:"blue",chetlashtirilgan:"red"}[e.raw.status]},{default:a(()=>[f(r(e.raw.status),1)]),_:2},1032,["color"])])]),"item.birthdate":a(({item:e})=>[u("td",ce,r(e.raw.birthdate),1)]),_:1},8,["items-per-page","search","items-length","items","loading"])])]),_:1})]),_:1})]),_:1}),t(J,{modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=e=>v.value=e),"max-width":"550px"},{default:a(()=>[t(F,null,{default:a(()=>[t(Y,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[u("span",ve,r(Z(z)),1)]),_:1}),t(E,{class:"px-2 pt-0"},{default:a(()=>[t(C,null,{default:a(()=>[t(A,{ref_key:"form",ref:y},{default:a(()=>[t(T,null,{default:a(()=>[t(n,{cols:"12"},{default:a(()=>[t(m,{modelValue:s.value.name,"onUpdate:modelValue":l[3]||(l[3]=e=>s.value.name=e),label:"Ism familiya","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:a(()=>[t(q,{modelValue:s.value.group,"onUpdate:modelValue":l[4]||(l[4]=e=>s.value.group=e),label:"Guruhi",rules:c,"hide-details":"",items:w.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:a(()=>[t(q,{modelValue:s.value.start_year,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value.start_year=e),label:"O'qishni boshlagan yili",rules:c,"hide-details":"",items:O,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:a(()=>[t(m,{modelValue:s.value.phone,"onUpdate:modelValue":l[6]||(l[6]=e=>s.value.phone=e),label:"Telefon raqami","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:a(()=>[t(m,{modelValue:s.value.birthdate,"onUpdate:modelValue":l[7]||(l[7]=e=>s.value.birthdate=e),label:"Tug'ilgan sanasi","hide-details":"",type:"date",color:"primary",rules:c,variant:"outlined"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:a(()=>[t(m,{modelValue:s.value.login,"onUpdate:modelValue":l[8]||(l[8]=e=>s.value.login=e),label:"Login","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:a(()=>[t(m,{modelValue:s.value.password,"onUpdate:modelValue":l[9]||(l[9]=e=>s.value.password=e),label:"Parol","hide-details":"",rules:c,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12"},{default:a(()=>[t(x,{variant:"flat",color:"primary",block:"",onClick:L,height:"45"},{default:a(()=>[f(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ge as default};
