import{a as b}from"./index-7376b9a9.js";import{r as u,l as M,m as D,a as n,o as W,c as X,w as a,b as e,f as y,d as i,t as m,e as Z,p as G}from"./index-6f11c559.js";const ee={class:"responsive-datatable"},ae={"data-label":"T/r"},le={"data-label":"Boshqarish"},te={class:"d-flex justify-end"},oe={"data-label":"Ism familiyasi"},se={"data-label":"Guruhi"},ne={"data-label":"Login"},ie={"data-label":"Paroli"},de={"data-label":"Telefoni"},ue={"data-label":"Tugilgan sanasi"},re=i("div",null,"Hech narsa topilmadi",-1),ce={class:"text-h5"},pe={__name:"Students",setup(me){const v=[t=>!!t||"Required"],L=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Ism familiyasi",key:"name"},{title:"Guruhi",key:"group"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Tugilgan sanasi",key:"birthdate"},{title:"Boshqarish",align:"end",key:"actions",sortable:!1}],w=u(""),c=u([]),_=u(!1),V=u(null),g=u(!1),r=u(-1),p=u(-1),k=u([]),s=u({name:"",birthdate:"",phone:"",login:"",password:"",group:null,role:"student"}),I={name:"",birthdate:"",phone:"",login:"",password:"",group:null,role:"student"},N=M(()=>r.value===-1?"Talaba yaratish":"Talabani o'zgartirish");D(_,t=>t||x()),D(g,t=>t||T());const S=async()=>{const[t,o]=await Promise.all([b.get("/user/student"),b.get("/group")]);c.value=t.data,k.value=o.data},H=async()=>{const{valid:t}=await V.value.validate();t&&A()},Y=t=>{r.value=c.value.indexOf(t),p.value=t._id,s.value=Object.assign({},t),_.value=!0},Q=t=>{r.value=c.value.indexOf(t),s.value=Object.assign({},t),p.value=t._id,g.value=!0},R=async()=>{const{data:t}=await b.delete(`/user/${p.value}`);t&&(c.value.splice(r.value,1),T())},x=()=>{_.value=!1,G(()=>{var t;s.value=Object.assign({},I),p.value=-1,r.value=-1,(t=V.value)==null||t.reset()})},T=()=>{g.value=!1,G(()=>{var t;s.value=Object.assign({},I),p.value=-1,r.value=-1,(t=V.value)==null||t.reset()})},A=async()=>{if(r.value>-1){const{data:t}=await b.put(`/user/${p.value}`,s.value);t?(Object.assign(c.value[r.value],t),x()):s.value.login=""}else{const{data:t}=await b.post("/user",s.value);t?(c.value.push(t),x()):s.value.login=""}};return S(),(t,o)=>{const f=n("v-text-field"),d=n("v-col"),h=n("v-btn"),U=n("v-row"),j=n("v-sheet"),q=n("v-select"),E=n("v-data-table"),O=n("v-card-title"),F=n("v-form"),z=n("v-container"),J=n("v-card-text"),B=n("v-card"),$=n("v-dialog"),P=n("v-spacer"),K=n("v-card-actions");return W(),X(z,{fluid:""},{default:a(()=>[e(U,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(j,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[e(U,{justify:"space-between"},{default:a(()=>[e(d,{cols:"12",sm:"4"},{default:a(()=>[e(f,{label:"Qidirish",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=l=>w.value=l),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"4",md:"3"},{default:a(()=>[e(h,{block:"",color:"primary",onClick:o[1]||(o[1]=l=>_.value=!0),variant:"tonal"},{default:a(()=>[y("Yangi Talaba")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(j,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[i("div",ee,[e(E,{headers:L,search:w.value,items:c.value},{"item.no":a(({index:l})=>[i("td",ae,m(l+1)+".",1)]),"item.actions":a(({item:l})=>[i("td",le,[i("div",te,[e(h,{icon:"mdi-pencil",variant:"text",size:"40",color:"primary",onClick:C=>Y(l.raw)},null,8,["onClick"]),e(h,{icon:"mdi-delete",variant:"text",size:"40",color:"primary",onClick:C=>Q(l.raw)},null,8,["onClick"])])])]),"item.name":a(({item:l})=>[i("td",oe,m(l.raw.name),1)]),"item.group":a(({item:l})=>[i("td",se,[e(q,{items:k.value,readonly:"",chips:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:l.raw.group,"onUpdate:modelValue":C=>l.raw.group=C},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.login":a(({item:l})=>[i("td",ne,m(l.raw.login),1)]),"item.password":a(({item:l})=>[i("td",ie,m(l.raw.password),1)]),"item.phone":a(({item:l})=>[i("td",de,m(l.raw.phone),1)]),"item.birthdate":a(({item:l})=>[i("td",ue,m(l.raw.birthdate),1)]),"no-data":a(()=>[re]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e($,{modelValue:_.value,"onUpdate:modelValue":o[8]||(o[8]=l=>_.value=l),"max-width":"550px"},{default:a(()=>[e(B,null,{default:a(()=>[e(O,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[i("span",ce,m(Z(N)),1)]),_:1}),e(J,{class:"px-2 pt-0"},{default:a(()=>[e(z,null,{default:a(()=>[e(F,{ref_key:"form",ref:V},{default:a(()=>[e(U,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(f,{modelValue:s.value.name,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.name=l),label:"Ism familiya","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(q,{modelValue:s.value.group,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.group=l),label:"Guruhi",rules:v,"hide-details":"",items:k.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.phone,"onUpdate:modelValue":o[4]||(o[4]=l=>s.value.phone=l),label:"Telefon raqami","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.birthdate,"onUpdate:modelValue":o[5]||(o[5]=l=>s.value.birthdate=l),label:"Tug'ilgan sanasi","hide-details":"",type:"date",color:"primary",rules:v,variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.login,"onUpdate:modelValue":o[6]||(o[6]=l=>s.value.login=l),label:"Login","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:s.value.password,"onUpdate:modelValue":o[7]||(o[7]=l=>s.value.password=l),label:"Parol","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(h,{variant:"tonal",color:"primary",block:"",onClick:H,height:"45"},{default:a(()=>[y(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e($,{modelValue:g.value,"onUpdate:modelValue":o[9]||(o[9]=l=>g.value=l),"max-width":"500px"},{default:a(()=>[e(B,null,{default:a(()=>[e(O,{class:"text-h6"},{default:a(()=>[y(" Ushbu ma'lumotni ochirmoqchimisiz ")]),_:1}),e(K,null,{default:a(()=>[e(P),e(h,{color:"blue-darken-1",variant:"text",onClick:T},{default:a(()=>[y(" Yo'q ")]),_:1}),e(h,{color:"blue-darken-1",variant:"text",onClick:R},{default:a(()=>[y(" Ha ")]),_:1}),e(P)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{pe as default};
