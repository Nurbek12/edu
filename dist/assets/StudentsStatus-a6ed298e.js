import{a as k}from"./index-7376b9a9.js";import{r,m as K,a as i,o as M,c as W,w as e,b as a,d as s,f as _,t as n,n as X}from"./index-1d6c4b32.js";const Y={class:"responsive-datatable"},Z={"data-label":"Boshqarish"},ee={class:"d-flex justify-end"},te={"data-label":"Ism familiyasi"},ae={"data-label":"Login"},le={"data-label":"Paroli"},se={"data-label":"Telefoni"},oe={"data-label":"Tugilgan sanasi"},ie={"data-label":"Holati"},ne={class:"responsive-datatable"},de={"data-label":"Boshqarish"},re={class:"d-flex justify-end"},ce={"data-label":"Ism familiyasi"},ue={"data-label":"Login"},_e={"data-label":"Paroli"},ve={"data-label":"Telefoni"},me={"data-label":"Tugilgan sanasi"},pe={"data-label":"Holati"},he=["colspan"],fe=s("span",{class:"text-h5"},"Talabani chetlatish",-1),ye={__name:"StudentsStatus",setup(be){const H=[l=>!!l||"Required"],V=[{title:"Ism familiyasi",key:"name"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Tugilgan sanasi",key:"birthdate"},{title:"Holati",key:"status"},{title:"Boshqarish",align:"start",key:"actions",sortable:!1}],f=r(""),m=r([]),p=r([]),v=r(!1),g=r(null),h=r(-1),b=r(-1),C=r([]),d=r({reason:"",status:"chetlashtirilgan",group:null}),O={reason:"",status:"chetlashtirilgan"},I=r([]);K(v,l=>l||T());const S=async()=>{const{data:l}=await k.get("/group");C.value=l},$=async()=>{const{valid:l}=await g.value.validate();l&&P()},L=(l,o)=>{h.value=m.value.indexOf(l),b.value=l._id,d.value=Object.assign({},{...l,status:o}),v.value=!0},N=(l,o)=>{h.value=p.value.indexOf(l),b.value=l._id,d.value=Object.assign({},{...l,status:o}),v.value=!0},T=()=>{v.value=!1,X(()=>{var l;d.value=Object.assign({},O),b.value=-1,h.value=-1,(l=g.value)==null||l.reset()})},P=async()=>{const{data:l}=await k.put(`/user/${b.value}`,d.value);d.value.status==="aktiv"?(p.value.splice(h.value,1),m.value.push(l)):(m.value.splice(h.value,1),p.value.push(l)),T()},Q=async()=>{const{data:l}=await k.get(`/user/student?group=${d.value.group}`);m.value=l==null?void 0:l.filter(o=>o.status==="aktiv"),p.value=l==null?void 0:l.filter(o=>o.status!=="aktiv")};return S(),(l,o)=>{const z=i("v-select"),c=i("v-col"),D=i("v-text-field"),w=i("v-row"),y=i("v-sheet"),j=i("v-icon"),x=i("v-btn"),B=i("v-chip"),U=i("v-data-table"),G=i("v-card-title"),R=i("v-textarea"),A=i("v-form"),q=i("v-container"),E=i("v-card-text"),F=i("v-card"),J=i("v-dialog");return M(),W(q,{fluid:""},{default:e(()=>[a(w,null,{default:e(()=>[a(c,{cols:"12"},{default:e(()=>[a(y,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(w,{justify:"start",align:"center"},{default:e(()=>[a(c,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(z,{modelValue:d.value.group,"onUpdate:modelValue":[o[0]||(o[0]=t=>d.value.group=t),Q],label:"Guruh","hide-details":"",density:"compact",items:C.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(c,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(D,{label:"Qidirish",modelValue:f.value,"onUpdate:modelValue":o[1]||(o[1]=t=>f.value=t),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(c,{cols:"12"},{default:e(()=>[a(y,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[s("div",Y,[a(U,{"items-per-page":"-1","items-per-page-text":"","no-data-text":"Hech narsa topilmadi",headers:V,search:f.value,items:m.value},{"item.actions":e(({item:t})=>[s("td",Z,[s("div",ee,[a(x,{variant:"flat",color:"primary",onClick:u=>L(t.raw,"chetlashtirilgan")},{default:e(()=>[a(j,null,{default:e(()=>[_("mdi-hand-back-left")]),_:1}),_(" Chetlatish ")]),_:2},1032,["onClick"])])])]),bottom:e(()=>[]),"item.name":e(({index:t,item:u})=>[s("td",te,n(t+1)+". "+n(u.raw.name),1)]),"item.login":e(({item:t})=>[s("td",ae,n(t.raw.login),1)]),"item.password":e(({item:t})=>[s("td",le,n(t.raw.password),1)]),"item.phone":e(({item:t})=>[s("td",se,n(t.raw.phone),1)]),"item.birthdate":e(({item:t})=>[s("td",oe,n(t.raw.birthdate),1)]),"item.status":e(({item:t})=>[s("td",ie,[a(B,{label:"",color:{aktiv:"blue",chetlashtirilgan:"red"}[t.raw.status]},{default:e(()=>[_(n(t.raw.status),1)]),_:2},1032,["color"])])]),_:1},8,["search","items"])])]),_:1})]),_:1}),a(c,{cols:"12"},{default:e(()=>[a(y,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[s("div",ne,[a(U,{"items-per-page":"-1","items-per-page-text":"","no-data-text":"Hech narsa topilmadi",headers:V,search:f.value,items:p.value,"item-value":"_id","show-expand":"",expanded:I.value,"onUpdate:expanded":o[2]||(o[2]=t=>I.value=t)},{bottom:e(()=>[]),"item.actions":e(({item:t})=>[s("td",de,[s("div",re,[a(x,{variant:"flat",color:"primary",onClick:u=>N(t.raw,"aktiv")},{default:e(()=>[a(j,null,{default:e(()=>[_("mdi-restore-alert")]),_:1}),_(" Qaytarish ")]),_:2},1032,["onClick"])])])]),"item.name":e(({index:t,item:u})=>[s("td",ce,n(t+1)+". "+n(u.raw.name),1)]),"item.login":e(({item:t})=>[s("td",ue,n(t.raw.login),1)]),"item.password":e(({item:t})=>[s("td",_e,n(t.raw.password),1)]),"item.phone":e(({item:t})=>[s("td",ve,n(t.raw.phone),1)]),"item.birthdate":e(({item:t})=>[s("td",me,n(t.raw.birthdate),1)]),"item.status":e(({item:t})=>[s("td",pe,[a(B,{label:"",color:{aktiv:"blue",chetlashtirilgan:"red"}[t.raw.status]},{default:e(()=>[_(n(t.raw.status),1)]),_:2},1032,["color"])])]),"expanded-row":e(({columns:t,item:u})=>[s("tr",null,[s("td",{colspan:t.length}," Chetlatish Sababi: "+n(u.raw.reason),9,he)])]),_:1},8,["search","items","expanded"])])]),_:1})]),_:1})]),_:1}),a(J,{modelValue:v.value,"onUpdate:modelValue":o[4]||(o[4]=t=>v.value=t),"max-width":"550px"},{default:e(()=>[a(F,null,{default:e(()=>[a(G,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[fe]),_:1}),a(E,{class:"px-2 pt-0"},{default:e(()=>[a(q,null,{default:e(()=>[a(A,{ref_key:"form",ref:g},{default:e(()=>[a(w,null,{default:e(()=>[a(c,{cols:"12"},{default:e(()=>[a(R,{modelValue:d.value.reason,"onUpdate:modelValue":o[3]||(o[3]=t=>d.value.reason=t),label:"Chetlatish sababi","hide-details":"",rules:H,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(c,{cols:"12"},{default:e(()=>[a(x,{variant:"flat",color:"primary",block:"",onClick:$,height:"45"},{default:e(()=>[_(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ye as default};
