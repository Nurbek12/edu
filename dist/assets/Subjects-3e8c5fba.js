import{a as p}from"./index-7376b9a9.js";import{r as d,l as E,n as G,a as l,o as J,c as K,w as e,b as a,f as h,d as _,t as g,e as L,p as M}from"./index-28b05177.js";const P={class:"responsive-datatable"},W={"data-label":"T/r"},X={"data-label":"Fan nomi"},Z={"data-label":"Boshqarish"},ee={class:"d-flex justify-end align-center gap-4"},ae={class:"text-h5"},se={__name:"Subjects",setup(te){const C=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Fan Nomi",key:"name"},{title:"Boshqarish",key:"actions",sortable:!1}],z=[t=>!!t||"Required"],b=d(""),y=d(null),n=d([]),u=d(!1),i=d(-1),v=d(-1),c=d({name:""}),I={name:""},O=E(()=>i.value===-1?"Fan Yaratish":"Fanni O'zgartirish");G(u,t=>t||m());const F=async()=>{const{data:t}=await p.get("/subject/");n.value=t},q=async()=>{const{valid:t}=await y.value.validate();t&&$()},B=t=>{i.value=n.value.indexOf(t),v.value=t._id,c.value=Object.assign({},t),u.value=!0},N=t=>{i.value=n.value.indexOf(t),c.value=Object.assign({},t),v.value=t._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?T():m()},T=async()=>{const{data:t}=await p.delete(`/subject/${v.value}`);t&&(n.value.splice(i.value,1),m())},m=()=>{u.value=!1,M(()=>{var t;c.value=Object.assign({},I),v.value=-1,i.value=-1,(t=y.value)==null||t.reset()})},$=async()=>{if(i.value>-1){const{data:t}=await p.put(`/subject/${v.value}`,c.value);Object.assign(n.value[i.value],t)}else{const{data:t}=await p.post("/subject",c.value);n.value.push(t)}m()};return F(),(t,s)=>{const w=l("v-text-field"),r=l("v-col"),f=l("v-btn"),x=l("v-row"),k=l("v-sheet"),U=l("v-spacer"),V=l("v-icon"),S=l("v-data-table"),D=l("v-card-title"),H=l("v-form"),j=l("v-container"),Q=l("v-card-text"),R=l("v-card"),Y=l("v-dialog");return J(),K(j,{fluid:""},{default:e(()=>[a(x,null,{default:e(()=>[a(r,{cols:"12"},{default:e(()=>[a(k,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(x,{justify:"space-between",align:"center"},{default:e(()=>[a(r,{cols:"12",class:"py-1",sm:"4"},{default:e(()=>[a(w,{label:"Qidirish",modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=o=>b.value=o),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(r,{cols:"12",class:"py-1",sm:"4"},{default:e(()=>[a(f,{block:"",color:"primary",onClick:s[1]||(s[1]=o=>u.value=!0),variant:"flat",height:"42"},{default:e(()=>[h("Fan yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(r,{cols:"12"},{default:e(()=>[a(k,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[_("div",P,[a(S,{"items-per-page-text":"","no-data-text":"Hech narsa topilmadi",headers:C,density:"comfortable",search:b.value,items:n.value},{"item.no":e(({index:o})=>[_("td",W,g(o+1)+".",1)]),"item.name":e(({item:o})=>[_("td",X,g(o.raw.name),1)]),"item.actions":e(({item:o})=>[_("td",Z,[a(U),_("div",ee,[a(f,{size:"30",elevation:"0",color:"primary",onClick:A=>B(o.raw)},{default:e(()=>[a(V,{size:"small"},{default:e(()=>[h("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(f,{size:"30",elevation:"0",color:"primary",class:"ml-1",onClick:A=>N(o.raw)},{default:e(()=>[a(V,{size:"small"},{default:e(()=>[h("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),a(Y,{modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=o=>u.value=o),"max-width":"550px"},{default:e(()=>[a(R,null,{default:e(()=>[a(D,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[_("span",ae,g(L(O)),1)]),_:1}),a(Q,{class:"px-2 pt-0"},{default:e(()=>[a(j,null,{default:e(()=>[a(H,{ref_key:"form",ref:y},{default:e(()=>[a(x,null,{default:e(()=>[a(r,{cols:"12"},{default:e(()=>[a(w,{modelValue:c.value.name,"onUpdate:modelValue":s[2]||(s[2]=o=>c.value.name=o),label:"Fan Nomi","hide-details":"",color:"primary",rules:z,variant:"outlined"},null,8,["modelValue"])]),_:1}),a(r,{cols:"12"},{default:e(()=>[a(f,{variant:"flat",color:"primary",block:"",onClick:q,height:"45"},{default:e(()=>[h(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{se as default};
