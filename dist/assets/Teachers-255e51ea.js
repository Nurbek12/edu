import{r as d,l as ee,m as ae,a as i,o as g,c as C,w as e,h,b as a,f as b,d as u,t as p,i as F,j as L,F as N,e as le,n as te}from"./index-868e85fe.js";const se={class:"responsive-datatable"},oe={"data-label":"Boshqarish"},ie={class:"d-flex justify-end align-center"},ne={"data-label":"Ism familiyasi"},ue={"data-label":"Login"},de={"data-label":"Telefoni"},re={"data-label":"Fanlar"},ce={style:{display:"flex",gap:"5px"}},me={"data-label":"Guruhlar"},ve={style:{display:"flex",gap:"5px"}},pe={class:"text-h5"},he={__name:"Teachers",setup(_e){const G=[{title:"Ism familiyasi",key:"name"},{title:"Login",key:"login",sortable:!1},{title:"Telefoni",key:"phone",sortable:!1},{title:"Guruhlar",key:"group",sortable:!1},{title:"Fanlar",key:"subjects",sortable:!1},{title:"Boshqarish",key:"actions",sortable:!1}],y=[l=>!!l||"Required"],k=d(null),x=d(""),r=d([]),j=d([]),O=d([]),_=d(!1),c=d(-1),f=d(null),o=d({name:"",phone:"",login:"",password:"",role:"teacher",accessgroup:[],accesssubjects:[]}),P={name:"",phone:"",login:"",password:"",role:"teacher",accessgroup:[],accesssubjects:[]},S=ee(()=>c.value===-1?"O'qituvchi yaratish":"O'qituvchi o'zgartirish");ae(_,l=>l||V());const D=async()=>{const l=await Promise.all([h.get("/user/teacher"),h.get("/group"),h.get("/subject")]);r.value=l[0].data,j.value=l[1].data,O.value=l[2].data},E=async()=>{const{valid:l}=await k.value.validate();l&&Y()},H=l=>{c.value=r.value.indexOf(l),f.value=l._id,o.value=Object.assign({},l),_.value=!0},Q=l=>{c.value=r.value.indexOf(l),o.value=Object.assign({},l),f.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?R():V()},R=async()=>{const{data:l}=await h.delete(`/user/${f.value}`);l&&(r.value.splice(c.value,1),V())},V=()=>{_.value=!1,te(()=>{var l;o.value=Object.assign({},P),f.value=null,c.value=-1,(l=k.value)==null||l.reset()})},Y=async()=>{if(c.value>-1){const{data:l}=await h.put(`/user/${f.value}`,o.value);Object.assign(r.value[c.value],l)}else{const{data:l}=await h.post("/user",o.value);r.value.push(l)}V()},A=l=>l.map(s=>j.value.find(({_id:m})=>m===s).name);return D(),(l,s)=>{const m=i("v-text-field"),n=i("v-col"),w=i("v-btn"),I=i("v-row"),U=i("v-sheet"),B=i("v-icon"),z=i("v-chip"),J=i("v-data-table"),K=i("v-card-title"),T=i("v-select"),M=i("v-form"),$=i("v-container"),W=i("v-card-text"),X=i("v-card"),Z=i("v-dialog");return g(),C($,{fluid:""},{default:e(()=>[a(I,null,{default:e(()=>[a(n,{cols:"12"},{default:e(()=>[a(U,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(I,{justify:"space-between"},{default:e(()=>[a(n,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(m,{label:"Qidirish",modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=t=>x.value=t),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(n,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[a(w,{block:"",height:"42",color:"primary",onClick:s[1]||(s[1]=t=>_.value=!0),variant:"flat"},{default:e(()=>[b("Yangi O'qituvchi")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(U,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[u("div",se,[a(J,{"no-data-text":"Hech narsa topilmadi","items-per-page-text":"",headers:G,search:x.value,items:r.value},{"item.actions":e(({item:t})=>[u("td",oe,[u("div",ie,[a(w,{variant:"flat",size:"30",color:"primary",onClick:v=>H(t.raw)},{default:e(()=>[a(B,null,{default:e(()=>[b("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(w,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:v=>Q(t.raw)},{default:e(()=>[a(B,null,{default:e(()=>[b("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"item.name":e(({index:t,item:v})=>[u("td",ne,p(t+1)+". "+p(v.raw.name),1)]),"item.login":e(({item:t})=>[u("td",ue,p(t.raw.login),1)]),"item.phone":e(({item:t})=>[u("td",de,p(t.raw.phone),1)]),"item.subjects":e(({item:t})=>[u("td",re,[u("div",ce,[(g(!0),F(N,null,L(t.raw.accesssubjects,(v,q)=>(g(),C(z,{label:"",color:"primary",size:"small",key:q},{default:e(()=>[b(p(v),1)]),_:2},1024))),128))])])]),"item.group":e(({item:t})=>[u("td",me,[u("div",ve,[(g(!0),F(N,null,L(A(t.raw.accessgroup),(v,q)=>(g(),C(z,{label:"",color:"primary",size:"small",key:q},{default:e(()=>[b(p(v),1)]),_:2},1024))),128))])])]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),a(Z,{modelValue:_.value,"onUpdate:modelValue":s[8]||(s[8]=t=>_.value=t),"max-width":"550px"},{default:e(()=>[a(X,null,{default:e(()=>[a(K,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[u("span",pe,p(le(S)),1)]),_:1}),a(W,{class:"px-2 pt-0"},{default:e(()=>[a($,null,{default:e(()=>[a(M,{ref_key:"form",ref:k},{default:e(()=>[a(I,null,{default:e(()=>[a(n,{cols:"12"},{default:e(()=>[a(m,{modelValue:o.value.name,"onUpdate:modelValue":s[2]||(s[2]=t=>o.value.name=t),label:"Ism familiya","hide-details":"",rules:y,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(m,{modelValue:o.value.phone,"onUpdate:modelValue":s[3]||(s[3]=t=>o.value.phone=t),label:"Telefon raqami","hide-details":"",rules:y,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(T,{modelValue:o.value.accessgroup,"onUpdate:modelValue":s[4]||(s[4]=t=>o.value.accessgroup=t),label:"Biriktirilgan guruhlar","hide-details":"",multiple:"",items:j.value,chips:"",color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(T,{modelValue:o.value.accesssubjects,"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.accesssubjects=t),label:"Biriktirilgan fanlar","hide-details":"",multiple:"",items:O.value,chips:"",color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(m,{modelValue:o.value.login,"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.login=t),label:"Login","hide-details":"",rules:y,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",sm:"6"},{default:e(()=>[a(m,{modelValue:o.value.password,"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.password=t),label:"Parol","hide-details":"",rules:f.value?[]:y,color:"primary",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12"},{default:e(()=>[a(w,{variant:"flat",color:"primary",block:"",onClick:E,height:"45"},{default:e(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{he as default};
