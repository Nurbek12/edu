import{a as f}from"./index-7376b9a9.js";import{r as u,l as A,m as E,a as i,o as F,c as J,w as e,b as a,f as b,d as n,t as v,e as K,n as M}from"./index-1d6c4b32.js";const W={class:"responsive-datatable"},X={"data-label":"T/r"},Z={"data-label":"Boshqarish"},ee={class:"d-flex justify-end align-center"},ae={"data-label":"Ism familiyasi"},le={"data-label":"Login"},te={"data-label":"Paroli"},oe={"data-label":"Telefoni"},se={"data-label":"Guruhlar"},ie=n("div",null,"Hech narsa topilmadi",-1),ne={class:"text-h5"},ce={__name:"Teachers",setup(de){const T=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Ism familiyasi",key:"name"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Guruhlar",key:"group"},{title:"Boshqarish",key:"actions",sortable:!1}],h=[t=>!!t||"Required"],w=u(null),V=u(""),r=u([]),k=u([]),m=u(!1),c=u(-1),_=u(-1),s=u({name:"",phone:"",login:"",password:"",role:"teacher",accessgroup:[]}),j={name:"",phone:"",login:"",password:"",role:"teacher",accessgroup:[]},B=A(()=>c.value===-1?"O'qituvchi yaratish":"O'qituvchi o'zgartirish");E(m,t=>t||g());const z=async()=>{const t=await Promise.all([f.get("/user/teacher"),f.get("/group")]);r.value=t[0].data,k.value=t[1].data},$=async()=>{const{valid:t}=await w.value.validate();t&&G()},P=t=>{c.value=r.value.indexOf(t),_.value=t._id,s.value=Object.assign({},t),m.value=!0},L=t=>{c.value=r.value.indexOf(t),s.value=Object.assign({},t),_.value=t._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?N():g()},N=async()=>{const{data:t}=await f.delete(`/user/${_.value}`);t&&(r.value.splice(c.value,1),g())},g=()=>{m.value=!1,M(()=>{var t;s.value=Object.assign({},j),_.value=-1,c.value=-1,(t=w.value)==null||t.reset()})},G=async()=>{if(c.value>-1){const{data:t}=await f.put(`/user/${_.value}`,s.value);Object.assign(r.value[c.value],t)}else{const{data:t}=await f.post("/user",s.value);r.value.push(t)}g()};return z(),(t,o)=>{const p=i("v-text-field"),d=i("v-col"),y=i("v-btn"),x=i("v-row"),U=i("v-sheet"),q=i("v-icon"),C=i("v-select"),S=i("v-data-table"),D=i("v-card-title"),H=i("v-form"),O=i("v-container"),Q=i("v-card-text"),R=i("v-card"),Y=i("v-dialog");return F(),J(O,{fluid:""},{default:e(()=>[a(x,null,{default:e(()=>[a(d,{cols:"12"},{default:e(()=>[a(U,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(x,{justify:"space-between"},{default:e(()=>[a(d,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(p,{label:"Qidirish",modelValue:V.value,"onUpdate:modelValue":o[0]||(o[0]=l=>V.value=l),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(d,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[a(y,{block:"",height:"42",color:"primary",onClick:o[1]||(o[1]=l=>m.value=!0),variant:"flat"},{default:e(()=>[b("Yangi O'qituvchi")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(U,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[n("div",W,[a(S,{"items-per-page-text":"",headers:T,search:V.value,items:r.value},{"item.no":e(({index:l})=>[n("td",X,v(l+1)+".",1)]),"item.actions":e(({item:l})=>[n("td",Z,[n("div",ee,[a(y,{variant:"flat",size:"30",color:"primary",onClick:I=>P(l.raw)},{default:e(()=>[a(q,null,{default:e(()=>[b("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(y,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:I=>L(l.raw)},{default:e(()=>[a(q,null,{default:e(()=>[b("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"item.name":e(({item:l})=>[n("td",ae,v(l.raw.name),1)]),"item.login":e(({item:l})=>[n("td",le,v(l.raw.login),1)]),"item.password":e(({item:l})=>[n("td",te,v(l.raw.password),1)]),"item.phone":e(({item:l})=>[n("td",oe,v(l.raw.phone),1)]),"item.group":e(({item:l})=>[n("td",se,[a(C,{items:k.value,readonly:"",chips:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:l.raw.accessgroup,"onUpdate:modelValue":I=>l.raw.accessgroup=I},null,8,["items","modelValue","onUpdate:modelValue"])])]),"no-data":e(()=>[ie]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),a(Y,{modelValue:m.value,"onUpdate:modelValue":o[7]||(o[7]=l=>m.value=l),"max-width":"550px"},{default:e(()=>[a(R,null,{default:e(()=>[a(D,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[n("span",ne,v(K(B)),1)]),_:1}),a(Q,{class:"px-2 pt-0"},{default:e(()=>[a(O,null,{default:e(()=>[a(H,{ref_key:"form",ref:w},{default:e(()=>[a(x,null,{default:e(()=>[a(d,{cols:"12"},{default:e(()=>[a(p,{modelValue:s.value.name,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.name=l),label:"Ism familiya","hide-details":"",rules:h,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(p,{modelValue:s.value.phone,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.phone=l),label:"Telefon raqami","hide-details":"",rules:h,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(C,{modelValue:s.value.accessgroup,"onUpdate:modelValue":o[4]||(o[4]=l=>s.value.accessgroup=l),label:"Biriktirilgan guruhlar","hide-details":"",multiple:"",items:k.value,chips:"",color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12",sm:"6"},{default:e(()=>[a(p,{modelValue:s.value.login,"onUpdate:modelValue":o[5]||(o[5]=l=>s.value.login=l),label:"Login","hide-details":"",rules:h,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",sm:"6"},{default:e(()=>[a(p,{modelValue:s.value.password,"onUpdate:modelValue":o[6]||(o[6]=l=>s.value.password=l),label:"Parol","hide-details":"",rules:h,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(y,{variant:"flat",color:"primary",block:"",onClick:$,height:"45"},{default:e(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{ce as default};
