import{a as p}from"./index-7376b9a9.js";import{r as u,l as M,n as W,a as i,o as I,c as B,w as e,b as a,f as g,d as n,t as m,h as X,i as Z,F as ee,e as ae,p as le}from"./index-856562a7.js";const te={class:"responsive-datatable"},oe={"data-label":"T/r"},se={"data-label":"Boshqarish"},ie={class:"d-flex justify-end align-center"},ne={"data-label":"Ism familiyasi"},de={"data-label":"Login"},ue={"data-label":"Paroli"},re={"data-label":"Telefoni"},ce={"data-label":"Telefoni"},me={style:{display:"flex",gap:"5px"}},ve={"data-label":"Guruhlar"},pe=n("div",null,"Hech narsa topilmadi",-1),_e={class:"text-h5"},be={__name:"Teachers",setup(fe){const z=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Ism familiyasi",key:"name"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Guruhlar",key:"group"},{title:"Fanlar",key:"subjects"},{title:"Boshqarish",key:"actions",sortable:!1}],b=[t=>!!t||"Required"],w=u(null),k=u(""),r=u([]),x=u([]),T=u([]),v=u(!1),c=u(-1),_=u(-1),s=u({name:"",phone:"",login:"",password:"",role:"teacher",accessgroup:[],accesssubjects:[]}),$={name:"",phone:"",login:"",password:"",role:"teacher",accessgroup:[],accesssubjects:[]},L=M(()=>c.value===-1?"O'qituvchi yaratish":"O'qituvchi o'zgartirish");W(v,t=>t||y());const P=async()=>{const t=await Promise.all([p.get("/user/teacher"),p.get("/group"),p.get("/subject")]);r.value=t[0].data,console.log(r.value),x.value=t[1].data,T.value=t[2].data},F=async()=>{const{valid:t}=await w.value.validate();t&&D()},N=t=>{c.value=r.value.indexOf(t),_.value=t._id,s.value=Object.assign({},t),v.value=!0},G=t=>{c.value=r.value.indexOf(t),s.value=Object.assign({},t),_.value=t._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?S():y()},S=async()=>{const{data:t}=await p.delete(`/user/${_.value}`);t&&(r.value.splice(c.value,1),y())},y=()=>{v.value=!1,le(()=>{var t;s.value=Object.assign({},$),_.value=-1,c.value=-1,(t=w.value)==null||t.reset()})},D=async()=>{if(c.value>-1){const{data:t}=await p.put(`/user/${_.value}`,s.value);Object.assign(r.value[c.value],t)}else{const{data:t}=await p.post("/user",s.value);r.value.push(t)}y()};return P(),(t,o)=>{const f=i("v-text-field"),d=i("v-col"),V=i("v-btn"),j=i("v-row"),q=i("v-sheet"),C=i("v-icon"),E=i("v-chip"),U=i("v-select"),H=i("v-data-table"),Q=i("v-card-title"),R=i("v-form"),O=i("v-container"),Y=i("v-card-text"),A=i("v-card"),J=i("v-dialog");return I(),B(O,{fluid:""},{default:e(()=>[a(j,null,{default:e(()=>[a(d,{cols:"12"},{default:e(()=>[a(q,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:e(()=>[a(j,{justify:"space-between"},{default:e(()=>[a(d,{class:"py-1",cols:"12",sm:"4"},{default:e(()=>[a(f,{label:"Qidirish",modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=l=>k.value=l),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(d,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:e(()=>[a(V,{block:"",height:"42",color:"primary",onClick:o[1]||(o[1]=l=>v.value=!0),variant:"flat"},{default:e(()=>[g("Yangi O'qituvchi")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(q,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[n("div",te,[a(H,{"items-per-page-text":"",headers:z,search:k.value,items:r.value},{"item.no":e(({index:l})=>[n("td",oe,m(l+1)+".",1)]),"item.actions":e(({item:l})=>[n("td",se,[n("div",ie,[a(V,{variant:"flat",size:"30",color:"primary",onClick:h=>N(l.raw)},{default:e(()=>[a(C,null,{default:e(()=>[g("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),a(V,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:h=>G(l.raw)},{default:e(()=>[a(C,null,{default:e(()=>[g("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"item.name":e(({item:l})=>[n("td",ne,m(l.raw.name),1)]),"item.login":e(({item:l})=>[n("td",de,m(l.raw.login),1)]),"item.password":e(({item:l})=>[n("td",ue,m(l.raw.password),1)]),"item.phone":e(({item:l})=>[n("td",re,m(l.raw.phone),1)]),"item.subjects":e(({item:l})=>[n("td",ce,[n("div",me,[(I(!0),X(ee,null,Z(l.raw.accesssubjects,(h,K)=>(I(),B(E,{label:"",color:"primary",size:"small",key:K},{default:e(()=>[g(m(h),1)]),_:2},1024))),128))])])]),"item.group":e(({item:l})=>[n("td",ve,[a(U,{items:x.value,readonly:"",chips:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:l.raw.accessgroup,"onUpdate:modelValue":h=>l.raw.accessgroup=h},null,8,["items","modelValue","onUpdate:modelValue"])])]),"no-data":e(()=>[pe]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),a(J,{modelValue:v.value,"onUpdate:modelValue":o[8]||(o[8]=l=>v.value=l),"max-width":"550px"},{default:e(()=>[a(A,null,{default:e(()=>[a(Q,{class:"mt-2 ml-2 mb-0"},{default:e(()=>[n("span",_e,m(ae(L)),1)]),_:1}),a(Y,{class:"px-2 pt-0"},{default:e(()=>[a(O,null,{default:e(()=>[a(R,{ref_key:"form",ref:w},{default:e(()=>[a(j,null,{default:e(()=>[a(d,{cols:"12"},{default:e(()=>[a(f,{modelValue:s.value.name,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.name=l),label:"Ism familiya","hide-details":"",rules:b,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(f,{modelValue:s.value.phone,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.phone=l),label:"Telefon raqami","hide-details":"",rules:b,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(U,{modelValue:s.value.accessgroup,"onUpdate:modelValue":o[4]||(o[4]=l=>s.value.accessgroup=l),label:"Biriktirilgan guruhlar","hide-details":"",multiple:"",items:x.value,chips:"",color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(U,{modelValue:s.value.accesssubjects,"onUpdate:modelValue":o[5]||(o[5]=l=>s.value.accesssubjects=l),label:"Biriktirilgan fanlar","hide-details":"",multiple:"",items:T.value,chips:"",color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12",sm:"6"},{default:e(()=>[a(f,{modelValue:s.value.login,"onUpdate:modelValue":o[6]||(o[6]=l=>s.value.login=l),label:"Login","hide-details":"",rules:b,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",sm:"6"},{default:e(()=>[a(f,{modelValue:s.value.password,"onUpdate:modelValue":o[7]||(o[7]=l=>s.value.password=l),label:"Parol","hide-details":"",rules:b,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:e(()=>[a(V,{variant:"flat",color:"primary",block:"",onClick:F,height:"45"},{default:e(()=>[g(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{be as default};
