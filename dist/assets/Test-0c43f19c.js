import{a as h}from"./index-7376b9a9.js";import{r as i,l as xe,m as R,a as o,o as C,c as N,w as a,b as e,f as b,d as _,t as m,e as ye,h as M,i as W,F as X,j as Ve,p as Q}from"./index-6f11c559.js";const be={"data-label":"T/r"},he={"data-label":"Test Nomi"},ke={"data-label":"Fan"},ge={"data-label":"Boshqarish"},we={class:"d-flex justify-end"},Ce=_("div",null,"Hech narsa topilmadi",-1),Ue={class:"text-h5"},Te={class:"text-h5"},je={class:"text-subtitle-2"},Be={__name:"Test",setup(Oe){const Z=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test Nomi",key:"name"},{title:"Fan",key:"science"},{title:"Boshqarish",key:"actions",sortable:!1}],d=[l=>!!l||"Required"],B=i(null),U=i(null),q=i(""),k=i([]),g=i(!1),T=i(!1),j=i(!1),f=i(-1),x=i(-1),E=i([]),u=i([]),w=i(null),n=i({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),p=i({name:"",science:null}),D={name:"",science:null},ee=xe(()=>f.value===-1?"Test Yaratish":"Testni O'zgartirish");R(g,l=>l||L()),R(j,l=>l||F()),R(T,l=>l||de());const ae=async()=>{const[l,s]=await Promise.all([h.get("/science"),h.get("/test")]);k.value=s.data,E.value=l.data},te=async()=>{const{valid:l}=await B.value.validate();l&&re()},le=async()=>{const{valid:l}=await U.value.validate();l&&ve()},se=l=>{f.value=k.value.indexOf(l),x.value=l._id,p.value=Object.assign({},l),g.value=!0},oe=async l=>{if(!l.questions){const{data:s}=await h.get(`/test/id/${l._id}`);l.questions=s.questions}f.value=k.value.indexOf(l),x.value=l._id,u.value=l.questions,T.value=!0},ne=(l,s)=>{w.value=s,n.value=Object.assign({},l)},ie=l=>{f.value=k.value.indexOf(l),p.value=Object.assign({},l),x.value=l._id,j.value=!0},ue=async()=>{const{data:l}=await h.delete(`/test/${x.value}`);l&&(k.value.splice(f.value,1),F())},L=()=>{g.value=!1,Q(()=>{var l,s;p.value=Object.assign({},D),x.value=-1,f.value=-1,(l=B.value)==null||l.reset(),(s=U.value)==null||s.reset()})},F=()=>{j.value=!1,Q(()=>{var l,s;p.value=Object.assign({},D),x.value=-1,f.value=-1,(l=B.value)==null||l.reset(),(s=U.value)==null||s.reset()})},de=()=>{T.value=!1,Q(()=>{p.value=Object.assign({},D),x.value=-1,u.value=[],f.value=-1,w.value=null,n.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]})})},re=async()=>{if(f.value>-1){const{data:l}=await h.put(`/test/${x.value}`,p.value);Object.assign(k.value[f.value],l)}else{const{data:l}=await h.post("/test",{questions:u.value,...p.value});console.log(l),k.value.push(l)}L()},ce=()=>{u.value.push({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),Q(()=>{document.querySelector(".test-scroll").scrollTop=document.querySelector(".test-scroll").scrollHeight})},P=async l=>{u.value[l]._id&&await h.delete(`/test/question/${u.value[l]._id}`),u.value.splice(l,1)},ve=async()=>{var l;if(w.value!==null){delete n.value._id;const{data:s}=await h.put(`/test/question/${u.value[w.value]._id}`,n.value);Object.assign(u.value[w.value],s)}else{const{data:s}=await h.post("/test/question",{test:x.value,...n.value});u.value.push(s)}w.value=null,n.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),(l=U.value)==null||l.reset()};return ae(),(l,s)=>{const y=o("v-text-field"),r=o("v-col"),c=o("v-btn"),O=o("v-row"),Y=o("v-sheet"),me=o("v-data-table"),S=o("v-card-title"),pe=o("v-select"),G=o("v-textarea"),I=o("v-card-text"),z=o("v-card"),J=o("v-form"),H=o("v-container"),A=o("v-dialog"),$=o("v-banner-text"),_e=o("v-banner"),K=o("v-spacer"),fe=o("v-card-actions");return C(),N(H,{fluid:""},{default:a(()=>[e(O,null,{default:a(()=>[e(r,{cols:"12"},{default:a(()=>[e(Y,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[e(O,{justify:"space-between"},{default:a(()=>[e(r,{cols:"12",sm:"4"},{default:a(()=>[e(y,{label:"Qidirish",modelValue:q.value,"onUpdate:modelValue":s[0]||(s[0]=t=>q.value=t),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(r,{cols:"12",sm:"4",md:"3"},{default:a(()=>[e(c,{block:"",color:"primary",onClick:s[1]||(s[1]=t=>g.value=!0),variant:"tonal"},{default:a(()=>[b("Test yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(Y,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[e(me,{headers:Z,search:q.value,items:k.value},{"item.no":a(({index:t})=>[_("td",be,m(t+1)+".",1)]),"item.name":a(({item:t})=>[_("td",he,m(t.raw.name),1)]),"item.science":a(({item:t})=>[_("td",ke,m(t.raw.science),1)]),"item.actions":a(({item:t})=>[_("td",ge,[_("div",we,[e(c,{icon:"mdi-pencil",variant:"text",size:"40",color:"primary",onClick:V=>se(t.raw)},null,8,["onClick"]),e(c,{icon:"mdi-sitemap",variant:"text",size:"40",onClick:V=>oe(t.raw),color:"primary"},null,8,["onClick"]),e(c,{icon:"mdi-delete",variant:"text",size:"40",color:"primary",onClick:V=>ie(t.raw)},null,8,["onClick"])])])]),"no-data":a(()=>[Ce]),_:1},8,["search","items"])]),_:1})]),_:1})]),_:1}),e(A,{modelValue:g.value,"onUpdate:modelValue":s[4]||(s[4]=t=>g.value=t),"max-width":"550px"},{default:a(()=>[e(z,{class:"test-scroll"},{default:a(()=>[e(S,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[_("span",Ue,m(ye(ee)),1)]),_:1}),e(I,{class:"px-2 pt-0"},{default:a(()=>[e(H,null,{default:a(()=>[e(J,{ref_key:"form",ref:B},{default:a(()=>[e(O,null,{default:a(()=>[e(r,{cols:"12"},{default:a(()=>[e(y,{modelValue:p.value.name,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value.name=t),label:"Test Nomi","hide-details":"",rules:d,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(pe,{modelValue:p.value.science,"onUpdate:modelValue":s[3]||(s[3]=t=>p.value.science=t),label:"Fan",rules:d,"hide-details":"",items:E.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(r,{cols:"12",class:"px-3"},{default:a(()=>[e(O,null,{default:a(()=>[(C(!0),M(X,null,W(u.value,(t,V)=>(C(),N(r,{cols:"12"},{default:a(()=>[e(z,{variant:"outlined",class:"pa-2"},{default:a(()=>[e(G,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",variant:"outlined",rows:"3",rules:d,modelValue:t.text,"onUpdate:modelValue":v=>t.text=v},{"prepend-inner":a(()=>[_("div",null,m(V+1)+".",1)]),"append-inner":a(()=>[_("div",null,[e(c,{size:"x-small",variant:"text",icon:"mdi-close",color:"red",onClick:v=>P(V)},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(I,{class:"pa-0"},{default:a(()=>[e(y,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",density:"compact",rules:d,label:"A variant (to'gri javob)",modelValue:t.variants[0].text,"onUpdate:modelValue":v=>t.variants[0].text=v},null,8,["modelValue","onUpdate:modelValue"]),e(y,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:d,density:"compact",label:"B variant",modelValue:t.variants[1].text,"onUpdate:modelValue":v=>t.variants[1].text=v},null,8,["modelValue","onUpdate:modelValue"]),e(y,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:d,density:"compact",label:"C variant",modelValue:t.variants[2].text,"onUpdate:modelValue":v=>t.variants[2].text=v},null,8,["modelValue","onUpdate:modelValue"]),e(y,{variant:"outlined",color:"primary",class:"my-2",rules:d,"hide-details":"",density:"compact",label:"D variant",modelValue:t.variants[3].text,"onUpdate:modelValue":v=>t.variants[3].text=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),x.value===-1?(C(),N(r,{key:0,cols:"12"},{default:a(()=>[e(c,{variant:"tonal",color:"primary",block:"",onClick:ce,height:"45"},{default:a(()=>[b(" Savol Qo'shish ")]),_:1})]),_:1})):Ve("",!0)]),_:1})]),_:1}),e(r,{cols:"12"},{default:a(()=>[e(c,{variant:"tonal",color:"primary",block:"",onClick:te,height:"45"},{default:a(()=>[b(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(A,{modelValue:T.value,"onUpdate:modelValue":s[10]||(s[10]=t=>T.value=t),"max-width":"550px"},{default:a(()=>[e(z,{class:"test-scroll"},{default:a(()=>[e(S,{class:"mt-2 ml-2 mb-0"},{default:a(()=>{var t;return[_("span",Te,"Testlar ("+m((t=u.value)==null?void 0:t.length)+")",1)]}),_:1}),e(I,{class:"px-2 pt-0"},{default:a(()=>[e(H,null,{default:a(()=>[e(J,{ref_key:"form1",ref:U},{default:a(()=>[e(O,null,{default:a(()=>[e(r,{cols:"12"},{default:a(()=>[e(z,{variant:"tonal",class:"pa-2"},{default:a(()=>[e(G,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",rules:d,variant:"outlined",rows:"3",modelValue:n.value.text,"onUpdate:modelValue":s[5]||(s[5]=t=>n.value.text=t)},{"append-inner":a(()=>[e(c,{size:"small",variant:"text",onClick:le,icon:"mdi-text-box-plus",color:"green"})]),_:1},8,["modelValue"]),e(I,{class:"pa-0"},{default:a(()=>[e(y,{variant:"outlined",color:"primary",class:"my-2",rules:d,"hide-details":"",modelValue:n.value.variants[0].text,"onUpdate:modelValue":s[6]||(s[6]=t=>n.value.variants[0].text=t),density:"compact",label:"A variant (to'gri javob)"},null,8,["modelValue"]),e(y,{variant:"outlined",color:"primary",class:"my-2",rules:d,"hide-details":"",modelValue:n.value.variants[1].text,"onUpdate:modelValue":s[7]||(s[7]=t=>n.value.variants[1].text=t),density:"compact",label:"B variant"},null,8,["modelValue"]),e(y,{variant:"outlined",color:"primary",class:"my-2",rules:d,"hide-details":"",modelValue:n.value.variants[2].text,"onUpdate:modelValue":s[8]||(s[8]=t=>n.value.variants[2].text=t),density:"compact",label:"C variant"},null,8,["modelValue"]),e(y,{variant:"outlined",color:"primary",class:"my-2",rules:d,"hide-details":"",modelValue:n.value.variants[3].text,"onUpdate:modelValue":s[9]||(s[9]=t=>n.value.variants[3].text=t),density:"compact",label:"D variant"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{cols:"12"},{default:a(()=>[(C(!0),M(X,null,W(u.value,(t,V)=>(C(),N(_e,{lines:"three",class:"my-1",key:V},{actions:a(()=>[e(c,{icon:"mdi-pencil",variant:"text",size:"40",onClick:v=>ne(t,V),color:"primary"},null,8,["onClick"]),e(c,{icon:"mdi-delete",variant:"text",size:"40",onClick:v=>P(V),color:"primary"},null,8,["onClick"])]),default:a(()=>[e($,null,{default:a(()=>[_("span",je,m(V+1)+". "+m(t.text),1)]),_:2},1024),e($,{class:"text-caption"},{default:a(()=>[b("a) "+m(t.variants[0].text),1)]),_:2},1024),e($,{class:"text-caption"},{default:a(()=>[b("b) "+m(t.variants[1].text),1)]),_:2},1024),e($,{class:"text-caption"},{default:a(()=>[b("c) "+m(t.variants[2].text),1)]),_:2},1024),e($,{class:"text-caption"},{default:a(()=>[b("d) "+m(t.variants[3].text),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(A,{modelValue:j.value,"onUpdate:modelValue":s[11]||(s[11]=t=>j.value=t),"max-width":"500px"},{default:a(()=>[e(z,null,{default:a(()=>[e(S,{class:"text-h6"},{default:a(()=>[b(" Bu ma'lumotni uchirmoqchimisiz? ")]),_:1}),e(fe,null,{default:a(()=>[e(K),e(c,{color:"blue-darken-1",variant:"text",onClick:F},{default:a(()=>[b(" Bekor qilish ")]),_:1}),e(c,{color:"blue-darken-1",variant:"text",onClick:ue},{default:a(()=>[b(" Ha ")]),_:1}),e(K)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{Be as default};
