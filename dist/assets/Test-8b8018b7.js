import{a as h}from"./index-7376b9a9.js";import{r as u,l as _e,m as G,a as o,o as U,c as N,w as a,b as e,f as d,d as _,t as m,e as pe,h as J,i as K,F as M,j as fe,n as S}from"./index-e60ab6e1.js";const xe={class:"responsive-datatable"},ye={"data-label":"T/r"},Ve={"data-label":"Test Nomi"},be={"data-label":"Fan"},he={"data-label":"Boshqarish"},ke={class:"d-flex justify-end"},ge=_("div",null,"Hech narsa topilmadi",-1),we={class:"text-h5"},Ce={class:"text-h5"},Ue={class:"text-subtitle-2"},Oe={__name:"Test",setup(Te){const W=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test Nomi",key:"name"},{title:"Fan",key:"science"},{title:"Boshqarish",key:"actions",sortable:!1}],r=[l=>!!l||"Required"],Q=u(null),O=u(null),q=u(""),k=u([]),g=u(!1),T=u(!1),V=u(-1),b=u(-1),D=u([]),i=u([]),w=u(null),n=u({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),p=u({name:"",science:null}),A={name:"",science:null},X=_e(()=>V.value===-1?"Test Yaratish":"Testni O'zgartirish");G(g,l=>l||$()),G(T,l=>l||ie());const Z=async()=>{const[l,s]=await Promise.all([h.get("/subject"),h.get("/test")]);k.value=s.data,D.value=l.data},ee=async()=>{const{valid:l}=await Q.value.validate();l&&ue()},ae=async()=>{const{valid:l}=await O.value.validate();l&&re()},te=l=>{V.value=k.value.indexOf(l),b.value=l._id,p.value=Object.assign({},l),g.value=!0},le=async l=>{if(!l.questions){const{data:s}=await h.get(`/test/id/${l._id}`);l.questions=s.questions}V.value=k.value.indexOf(l),b.value=l._id,i.value=l.questions,T.value=!0},se=(l,s)=>{w.value=s,n.value=Object.assign({},l)},oe=l=>{V.value=k.value.indexOf(l),p.value=Object.assign({},l),b.value=l._id,confirm("Ushbu malumotni o'chirmoqchimisiz?")?ne():$()},ne=async()=>{const{data:l}=await h.delete(`/test/${b.value}`);l&&(k.value.splice(V.value,1),$())},$=()=>{g.value=!1,S(()=>{var l,s;p.value=Object.assign({},A),b.value=-1,V.value=-1,(l=Q.value)==null||l.reset(),(s=O.value)==null||s.reset()})},ie=()=>{T.value=!1,S(()=>{p.value=Object.assign({},A),b.value=-1,i.value=[],V.value=-1,w.value=null,n.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]})})},ue=async()=>{if(V.value>-1){const{data:l}=await h.put(`/test/${b.value}`,p.value);Object.assign(k.value[V.value],l)}else{const{data:l}=await h.post("/test",{questions:i.value,...p.value});console.log(l),k.value.push(l)}$()},de=()=>{i.value.push({text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),S(()=>{document.querySelector(".test-scroll").scrollTop=document.querySelector(".test-scroll").scrollHeight})},H=async l=>{confirm("Ushbu malumotni o'chirmoqchimisiz?")&&(i.value[l]._id&&await h.delete(`/test/question/${i.value[l]._id}`),i.value.splice(l,1))},re=async()=>{var l;if(w.value!==null){delete n.value._id;const{data:s}=await h.put(`/test/question/${i.value[w.value]._id}`,n.value);Object.assign(i.value[w.value],s)}else{const{data:s}=await h.post("/test/question",{test:b.value,...n.value});i.value.push(s)}w.value=null,n.value=Object.assign({},{text:"",variants:[{text:"",value:1},{text:"",value:0},{text:"",value:0},{text:"",value:0}]}),(l=O.value)==null||l.reset()};return Z(),(l,s)=>{const f=o("v-text-field"),c=o("v-col"),x=o("v-btn"),j=o("v-row"),R=o("v-sheet"),C=o("v-icon"),ce=o("v-data-table"),E=o("v-card-title"),ve=o("v-select"),L=o("v-textarea"),B=o("v-card-text"),I=o("v-card"),P=o("v-form"),F=o("v-container"),Y=o("v-dialog"),z=o("v-banner-text"),me=o("v-banner");return U(),N(F,{fluid:""},{default:a(()=>[e(j,null,{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[e(R,{elevation:"1",color:"surface",width:"100%",class:"pa-2 py-4",rounded:""},{default:a(()=>[e(j,{justify:"space-between"},{default:a(()=>[e(c,{class:"py-1",cols:"12",sm:"4"},{default:a(()=>[e(f,{label:"Qidirish",modelValue:q.value,"onUpdate:modelValue":s[0]||(s[0]=t=>q.value=t),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{class:"py-1",cols:"12",sm:"4",md:"3"},{default:a(()=>[e(x,{block:"",height:"42",color:"primary",onClick:s[1]||(s[1]=t=>g.value=!0),variant:"flat"},{default:a(()=>[d("Test yaratish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(R,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[_("div",xe,[e(ce,{headers:W,search:q.value,items:k.value},{"item.no":a(({index:t})=>[_("td",ye,m(t+1)+".",1)]),"item.name":a(({item:t})=>[_("td",Ve,m(t.raw.name),1)]),"item.science":a(({item:t})=>[_("td",be,m(t.raw.science),1)]),"item.actions":a(({item:t})=>[_("td",he,[_("div",ke,[e(x,{variant:"flat",size:"30",color:"primary",onClick:y=>te(t.raw)},{default:a(()=>[e(C,null,{default:a(()=>[d("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(x,{variant:"flat",class:"ml-1",size:"30",onClick:y=>le(t.raw),color:"primary"},{default:a(()=>[e(C,null,{default:a(()=>[d("mdi-sitemap")]),_:1})]),_:2},1032,["onClick"]),e(x,{variant:"flat",class:"ml-1",size:"30",color:"primary",onClick:y=>oe(t.raw)},{default:a(()=>[e(C,null,{default:a(()=>[d("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]),"no-data":a(()=>[ge]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e(Y,{modelValue:g.value,"onUpdate:modelValue":s[4]||(s[4]=t=>g.value=t),"max-width":"550px"},{default:a(()=>[e(I,{class:"test-scroll"},{default:a(()=>[e(E,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[_("span",we,m(pe(X)),1)]),_:1}),e(B,{class:"px-2 pt-0"},{default:a(()=>[e(F,null,{default:a(()=>[e(P,{ref_key:"form",ref:Q},{default:a(()=>[e(j,null,{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[e(f,{modelValue:p.value.name,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value.name=t),label:"Test Nomi","hide-details":"",rules:r,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(ve,{modelValue:p.value.science,"onUpdate:modelValue":s[3]||(s[3]=t=>p.value.science=t),label:"Fan",rules:r,"hide-details":"",items:D.value,color:"primary","item-title":"name","item-value":"name",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),b.value===-1?(U(),N(c,{key:0,cols:"12",class:"px-3"},{default:a(()=>[e(j,null,{default:a(()=>[(U(!0),J(M,null,K(i.value,(t,y)=>(U(),N(c,{cols:"12"},{default:a(()=>[e(I,{variant:"outlined",class:"pa-2"},{default:a(()=>[e(L,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",variant:"outlined",rows:"3",rules:r,modelValue:t.text,"onUpdate:modelValue":v=>t.text=v},{"prepend-inner":a(()=>[_("div",null,m(y+1)+".",1)]),"append-inner":a(()=>[_("div",null,[e(x,{size:"x-small",variant:"text",icon:"mdi-close",color:"red",onClick:v=>H(y)},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(B,{class:"pa-0"},{default:a(()=>[e(f,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",density:"compact",rules:r,label:"A variant (to'gri javob)",modelValue:t.variants[0].text,"onUpdate:modelValue":v=>t.variants[0].text=v},null,8,["modelValue","onUpdate:modelValue"]),e(f,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:r,density:"compact",label:"B variant",modelValue:t.variants[1].text,"onUpdate:modelValue":v=>t.variants[1].text=v},null,8,["modelValue","onUpdate:modelValue"]),e(f,{variant:"outlined",color:"primary",class:"my-2","hide-details":"",rules:r,density:"compact",label:"C variant",modelValue:t.variants[2].text,"onUpdate:modelValue":v=>t.variants[2].text=v},null,8,["modelValue","onUpdate:modelValue"]),e(f,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",density:"compact",label:"D variant",modelValue:t.variants[3].text,"onUpdate:modelValue":v=>t.variants[3].text=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),e(c,{cols:"12"},{default:a(()=>[e(x,{variant:"flat",color:"primary",block:"",onClick:de,height:"45"},{default:a(()=>[d(" Savol Qo'shish ")]),_:1})]),_:1})]),_:1})]),_:1})):fe("",!0),e(c,{cols:"12"},{default:a(()=>[e(x,{variant:"flat",color:"primary",block:"",onClick:ee,height:"45"},{default:a(()=>[d(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:T.value,"onUpdate:modelValue":s[10]||(s[10]=t=>T.value=t),"max-width":"550px"},{default:a(()=>[e(I,{class:"test-scroll"},{default:a(()=>[e(E,{class:"mt-2 ml-2 mb-0"},{default:a(()=>{var t;return[_("span",Ce,"Testlar ("+m((t=i.value)==null?void 0:t.length)+")",1)]}),_:1}),e(B,{class:"px-2 pt-0"},{default:a(()=>[e(F,null,{default:a(()=>[e(P,{ref_key:"form1",ref:O},{default:a(()=>[e(j,null,{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[e(I,{variant:"tonal",class:"pa-2"},{default:a(()=>[e(L,{density:"compact",color:"primary","hide-details":"",label:"Test savoli","no-resize":"",rules:r,variant:"outlined",rows:"3",modelValue:n.value.text,"onUpdate:modelValue":s[5]||(s[5]=t=>n.value.text=t)},{"append-inner":a(()=>[e(x,{variant:"flat",onClick:ae,color:"primary",size:"30"},{default:a(()=>[e(C,null,{default:a(()=>[d("mdi-plus")]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,{class:"pa-0"},{default:a(()=>[e(f,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:n.value.variants[0].text,"onUpdate:modelValue":s[6]||(s[6]=t=>n.value.variants[0].text=t),density:"compact",label:"A variant (to'gri javob)"},null,8,["modelValue"]),e(f,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:n.value.variants[1].text,"onUpdate:modelValue":s[7]||(s[7]=t=>n.value.variants[1].text=t),density:"compact",label:"B variant"},null,8,["modelValue"]),e(f,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:n.value.variants[2].text,"onUpdate:modelValue":s[8]||(s[8]=t=>n.value.variants[2].text=t),density:"compact",label:"C variant"},null,8,["modelValue"]),e(f,{variant:"outlined",color:"primary",class:"my-2",rules:r,"hide-details":"",modelValue:n.value.variants[3].text,"onUpdate:modelValue":s[9]||(s[9]=t=>n.value.variants[3].text=t),density:"compact",label:"D variant"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,{cols:"12"},{default:a(()=>[(U(!0),J(M,null,K(i.value,(t,y)=>(U(),N(me,{lines:"three",class:"my-1",key:y},{actions:a(()=>[e(x,{variant:"flat",size:"30",onClick:v=>se(t,y),color:"primary"},{default:a(()=>[e(C,null,{default:a(()=>[d("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(x,{variant:"flat",class:"ml-1",size:"30",onClick:v=>H(y),color:"primary"},{default:a(()=>[e(C,null,{default:a(()=>[d("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),default:a(()=>[e(z,null,{default:a(()=>[_("span",Ue,m(y+1)+". "+m(t.text),1)]),_:2},1024),e(z,{class:"text-caption"},{default:a(()=>[d("a) "+m(t.variants[0].text),1)]),_:2},1024),e(z,{class:"text-caption"},{default:a(()=>[d("b) "+m(t.variants[1].text),1)]),_:2},1024),e(z,{class:"text-caption"},{default:a(()=>[d("c) "+m(t.variants[2].text),1)]),_:2},1024),e(z,{class:"text-caption"},{default:a(()=>[d("d) "+m(t.variants[3].text),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{Oe as default};
